# MIUI/澎湃OS 小窗显示问题修复说明

## 问题描述

应用在部分 Android 系统（特别是小米 MIUI 或澎湃 OS）的小窗模式下，顶部界面可能会因为获取了错误的屏幕安全边距（Safe Area）而显示不全或被裁切。

## 解决方案

为了解决这个问题，我们对应用的主入口文件 `lib/main.dart` 进行了修改。

具体的改动是在 `MaterialApp` widget 中增加了一个 `builder` 属性。这个 `builder` 会在应用界面渲染前执行以下操作：

1.  **获取当前的 `MediaQueryData`**：包含了屏幕尺寸、边距等信息。
2.  **检查顶部安全边距 (`padding.top`)**：判断该值是否在一个合理的范围内。
3.  **修正异常值**：如果边距值异常（例如过大或为负数），则强制将其设置为一个合理的默认值（如 `24.0`）。
4.  **应用新的 `MediaQueryData`**：将修正后的 `MediaQuery` 应用到子组件树，确保整个应用都使用正确的边距。

通过这种方式，可以有效避免因系统返回异常数据导致的布局问题，提升应用在特殊场景下的兼容性和用户体验。
