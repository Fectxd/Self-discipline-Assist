"use strict";(self.homePageWebpackChunks=self.homePageWebpackChunks||[]).push([["libs_social-data-service_dist_service_SocialService_js","msnews/publishers-service-client"],{6817:function(e,t,i){i.d(t,{ll:function(){return Z},l:function(){return Y},Ae:function(){return ee}});var n=i(77246);function o(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return function(e){if(!(0,n.S)())return null;const t=window.location.hash.substring(1).split("&");for(let i=0;i<t.length;i++){const n=t[i].split("=");if(n[0].toLowerCase()==e.toLowerCase())return decodeURIComponent(n[1])}return null}(e)||function(e){if(!(0,n.S)())return null;const t=window.location.search.substring(1).split("&");for(let i=0;i<t.length;i++){const n=t[i].split("=");if(n[0].toLowerCase()==e.toLowerCase())return decodeURIComponent(n[1])}return null}(e)||t}var r=i(98313),s=i(88294),a=i(98216);const c=new class{constructor(){this.onAppError=void 0}log(e){const t={...e,message:`Community API Request Failed - Error Code: ${e.message}`};if(this.onAppError)try{this.onAppError(t)}catch(e){s.v.logError(e)}else a.YT.sendAppErrorEvent(t)}setOnAppError(e){this.onAppError=e}};var l=i(65022);l.tb_,l.vpF,l.bxt,l.$$G;const d=l.VKJ,u=l.eyV,m=l.T0U,p=l.p_3,y=l.G_w,g=l.oCh,v=l.oFo,f=l.c0M,h=l.aNj,w=l.aJi,P=(l._oM,l.q8y),S=l.LsK,b=l.Sd6;async function A(){return new Promise((e,t)=>{if(window.AzureStorage)return e(window.AzureStorage);!function(e,t,i){const n=document,o="script";if(!n.getElementById(t)){const r=n.getElementsByTagName(o)[0],s=n.createElement(o);s.id=t,s.src=e,s.onload=i,r.parentNode.insertBefore(s,r)}}("https://assets.msn.com/labs/views/CommentWidget/js/azure-storage.blob.min.js","azure-storage-blob-jssdk",()=>window.AzureStorage?e(window.AzureStorage):t())})}var T,k,R=i(93468),M=i(48622),_=i(17254),C=i(12870),I=i(5044),N=i(19548),U=i(15589),E=i(49084),D=i(76166),$=i(89980),B=i(17720),O=i(27261),G=i(19993),F=i(57759),H=i(74326);!function(e){e[e.None=0]="None",e[e.Draft=1]="Draft",e[e.UnderReview=2]="UnderReview",e[e.Published=3]="Published",e[e.Rejected=4]="Rejected",e[e.Unpublished=5]="Unpublished"}(T||(T={})),function(e){e[e.None=0]="None",e[e.Appealing=1]="Appealing",e[e.AppealFailed=2]="AppealFailed",e[e.AppealRejected=3]="AppealRejected"}(k||(k={}));var x,W,q=i(69023),j=i(88312);!function(e){e[e.NoProfile=0]="NoProfile",e[e.RewardsUser=1]="RewardsUser",e[e.MuidUser=2]="MuidUser"}(x||(x={})),function(e){e[e.Tipping=1]="Tipping",e[e.Subscription=2]="Subscription",e[e.BackupPaymentSubscription=3]="BackupPaymentSubscription"}(W||(W={}));var L=i(72725);const K=e=>e.getFullYear()+"-"+`0${e.getMonth()+1}`.substr(-2)+"-"+`0${e.getDate()}`.substr(-2);function J(){return"sharedWidgets"===_.T3.AppType&&function(){if(_.T3.WidgetAttributes){const{propertyBag:e={}}=_.T3.WidgetAttributes,{hostSite:t}=e;return t&&"bing"===t.toLowerCase()}return!1}()}var V=i(72993),z=i(86948),Q=i(97852);const X="ddd-debugid";class Y{static get useCache(){return B.vv.get("__SocialServiceUseCacheKey__",()=>!0)}static set useCache(e){B.vv.set("__SocialServiceUseCacheKey__",e)}static get domain(){return B.vv.get("__SocialServiceDomainKey__",()=>L.v.externalUrls.api)}static set domain(e){B.vv.set("__SocialServiceDomainKey__",e)}static get msphDomain(){return B.vv.get("__SocialServiceMsphDomainKey__",()=>L.v.externalUrls.msphApi)}static set msphDomain(e){B.vv.set("__SocialServiceMsphDomainKey__",e)}static get additionalHeaders(){return B.vv.get("__SocialServiceAdditionalHeadersKey__")}static set additionalHeaders(e){B.vv.set("__SocialServiceAdditionalHeadersKey__",e)}static get additionalParameters(){return B.vv.get("__SocialServiceAdditionalParametersKey__")}static set additionalParameters(e){B.vv.set("__SocialServiceAdditionalParametersKey__",e)}static get contentAllowBlockListMap(){return B.vv.get("__SocialServiceContentAllowBlockListMapKey__",()=>({}))}static set contentAllowBlockListMap(e){B.vv.set("__SocialServiceContentAllowBlockListMapKey__",e)}static get shouldUseAbortableFetch(){return B.vv.get("__SocialServiceShouldUseAbortableFetchKey__",()=>!1)}static set shouldUseAbortableFetch(e){B.vv.set("__SocialServiceShouldUseAbortableFetchKey__",e)}static get abortableFetchTimeout(){return B.vv.get("__SocialServiceAbortableFetchTimeoutKey__",()=>500)}static set abortableFetchTimeout(e){B.vv.set("__SocialServiceAbortableFetchTimeoutKey__",e)}static get cachedResponses(){return B.vv.get("__SocialServiceCachedResponsesKey__",()=>({}))}static set cachedResponses(e){B.vv.set("__SocialServiceCachedResponsesKey__",e)}static get rewardsInfoObservers(){return B.vv.get("__SocialServiceRewardsInfoObserversKey__",()=>[])}static set rewardsInfoObservers(e){B.vv.set("__SocialServiceRewardsInfoObserversKey__",e)}static get msaAccessToken(){return B.vv.get("__SocialServiceMsaAccessTokenKey__")}static set msaAccessToken(e){B.vv.set("__SocialServiceMsaAccessTokenKey__",e)}static get muid(){return B.vv.get("__SocialServiceMuidKey__")}static set muid(e){B.vv.set("__SocialServiceMuidKey__",e)}static get socialServiceOCID(){return B.vv.get("__SocialServiceSocialServiceOCIDKey__",()=>"social-peregrine")}static set socialServiceOCID(e){B.vv.set("__SocialServiceSocialServiceOCIDKey__",e)}static get endpoints(){return B.vv.get("__SocialServiceEndpointsKey__",()=>({contents:Y.domain.concat("urls/"),providerContents:Y.domain.concat("contents"),comments:Y.domain.concat("comments/"),posts:Y.domain.concat("posts/"),users:Y.domain.concat("users/"),follows:Y.domain.concat("follows/"),marketsettings:Y.domain.concat("marketsettings"),imageSearch:Y.domain.concat("Image"),creationIdeas:Y.domain.concat("creationideas/user"),systags:"https://api.msn.com/graph/systags",typingUpdates:`${(0,_.rA)().AssetsUrl}/labs/api/`,publisherFeed:"https://api.msn.com/news/feed/pages/publisherfeed",paymentOptions:`${(0,_.rA)().AssetsUrl}/xpay/subscription/paywall_nosign`,providerFullPage:`${(0,_.rA)().AssetsUrl}/service/news/feed/pages/providerfullpage`,creatorHubFullPage:`${(0,_.rA)().AssetsUrl}/service/news/feed/pages/creatorfullpage`,msphPost:Y.msphDomain.concat("/contents/posts"),msphAccount:Y.msphDomain.concat("/account/community"),msphInsights:Y.msphDomain.concat("/Insights/Content/brief"),image:_.T3.IsChinaCompliance?"https://api.msn.cn":"https://api.msn.com/Finance/Image",hubble:"https://hubble.officeapps.live.com/mediasvc/api/media/aggregate"}))}static set endpoints(e){B.vv.set("__SocialServiceEndpointsKey__",e)}static getMsaAccessToken(){return Y.msaAccessToken||o("msaAccessToken")}static getMuid(){const e=Y.muid||o("muid");return e?"m-"+e:null}static get isWinWidgetsAppType(){return"winWidgets"===_.T3.AppType||"windowsNewsPlus"===_.T3.AppType}static get isApiModerationVertical(){var e;return null===(e=L.v.moderationSourceOverrideVerticals)||void 0===e?void 0:e.includes(_.T3.AppType)}static get ocid(){var e;return this.isWinWidgetsAppType?"sidebar"===(null===C.Rb||void 0===C.Rb||null===(e=C.Rb.ClientSettings)||void 0===e?void 0:e.pagetype)?"shoreline":"winp2":o("ocid")||(0,I.En)()||G.WR.getOneServiceOCID(_.T3.TrackInfo,"")}static setAdditionalHeaders(e){Y.additionalHeaders=e}static setAdditionalParameters(e){Y.additionalParameters=e}static setDomain(e,t){this.domain=e,this.msphDomain=t,this.endpoints={...this.endpoints,contents:Y.domain.concat("urls/"),providerContents:Y.domain.concat("contents"),comments:Y.domain.concat("comments/"),posts:Y.domain.concat("posts/"),users:Y.domain.concat("users/"),follows:Y.domain.concat("follows/"),creationIdeas:Y.domain.concat("creationideas/user"),msphPost:Y.msphDomain.concat("/contents/posts"),msphAccount:Y.msphDomain.concat("/account/community"),msphInsights:Y.msphDomain.concat("/Insights/Content/brief")}}static configureAbortableFetch(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:500;Y.shouldUseAbortableFetch=e,Y.abortableFetchTimeout=t}static setMsaAccessToken(e){Y.msaAccessToken=e}static setMuid(e){Y.muid=e}static setSocialServiceOCID(e){this.socialServiceOCID=e}static async fetchMe(e){const t=await Y.getUserById("me",e);return(0,r.GF)(t.id),t}static async getUserById(e){let t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];return Y.GET(Y.endpoints.users+e,{version:"1.1",profile:"social",verify:t,market:_.T3.CurrentMarket}).then(e=>V.G.convertUser(e||null))}static async createUser(e){const t={notUseAvatar:e||!1,market:_.T3.CurrentMarket};return Y.POST(Y.endpoints.users+"me",t,{profile:"social"}).then(e=>V.G.convertUser(e||null)).catch(e=>e.json().then(e=>{throw e}))}static async updateUsername(e){const t={requestType:"UpdateName",changes:{PrimaryName:e}};return Y.POST(Y.endpoints.users+"me/userrequests",t).then(e=>V.G.convertUpdateUserNameResponse(e||null)).catch(e=>e.json().then(e=>{throw e}))}static async getUserProfile(e){let t={followers:void 0,following:void 0,comments:void 0};try{const i=await Y.GET(Y.endpoints.users+e,{version:"1.1",profile:"social",market:_.T3.CurrentMarket});t={...t,...V.G.convertUser(i||null)}}catch(e){return t}return Promise.all([Y.getFollowersByUserId(e).then(e=>{t.followers=e}),Y.getFollowingsByUserId(e).then(e=>{t.following=e}),Y.getCommentsByUserId(e).then(e=>{t.comments=e})]).then(e=>t).catch(t=>{s.v.logError("Error getting user profile: "+t.statusText),a.YT.sendAppErrorEvent({...l.tdA,message:`error getting user profile data ${e} ${JSON.stringify(t)}`})})}static async getUserContents(e,t,i,n){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const r={market:t,query:i,$top:o.top||20,$skip:o.skip||0,$orderby:o.orderBy||"Time",...n&&{productType:"premium"}};return Y.GET(Y.endpoints.users+e+"/contents",r)}static async updateUserSettings(e,t,i){const n={};return n[e]={isPrivateProfile:t,enableDisplayNameMasking:i},Y.PUT(Y.endpoints.users+e+"/settings",n,{})}static async deleteMyData(e){const t={...e,profile:"social"};return Y.DELETE(Y.endpoints.users+"me/",t)}static async getCreationIdeas(){const e={market:_.T3.CurrentMarket};return Y.GET(Y.endpoints.creationIdeas,e).then(e=>{var t;if(e&&(null===(t=e.Result)||void 0===t?void 0:t.length)>0)return e.Result.map(e=>V.G.convertTopics(e))}).catch(async e=>{var t;t={reason:"get creation ideas failed",err:(null==e?void 0:e.message)??e},c.log({...b,message:"get_creation_ideas",pb:{...b.pb,url:Y.endpoints.creationIdeas,method:"GET",customMessage:JSON.stringify(t)}})})}static async getPostListByUserId(e){const t={requestsource:"community",handler:"list",top:arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,skip:arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,status:arguments.length>3&&void 0!==arguments[3]?arguments[3]:T.None};return Y.GET(Y.endpoints.msphPost,t).then(e=>e).catch(async t=>{const i=e=>{c.log({...u,message:"list",pb:{...u.pb,url:Y.endpoints.msphPost,method:"GET",customMessage:JSON.stringify(e)}})};if(400===t.status)try{const e=await t.json();4!==JSON.parse(e.Message).errorCode&&i({reason:"unexpected_error_code",data:e.Message})}catch(t){i({reason:"invalid_response",error:(null==t?void 0:t.message)??t})}else i({reason:"get posts failed",userId:e,err:(null==t?void 0:t.message)??t});return{searchMatchedTotal:0,documents:[]}})}static async getPostDetail(e){const t={requestsource:"community",handler:"load_detail",itemId:e};return Y.GET(Y.endpoints.msphPost,t).then(e=>e).catch(async t=>{const i=e=>{c.log({...m,message:"load_detail",pb:{...m.pb,url:Y.endpoints.msphPost,method:"GET",customMessage:JSON.stringify(e)}})};if(400===t.status)try{const e=await t.json();4!==JSON.parse(e.Message).errorCode&&i({reason:"unexpected_error_code",data:e.Message})}catch(t){i({reason:"invalid_response",error:(null==t?void 0:t.message)??t})}else i({reason:"get post failed",postId:e,err:(null==t?void 0:t.message)??t})})}static async submitPost(e,t){const i={requestsource:"community",handler:"save_publish",type:t},n=e=>{c.log({...d,message:i.handler,pb:{...d.pb,url:Y.endpoints.msphPost,method:"POST",customMessage:JSON.stringify(e)}})};try{const t=await Y.POST(Y.endpoints.msphPost,e,i);return 2===t.status||(n({reason:"invalid_status",resp:t}),!1)}catch(e){return n({reason:"failed",err:(null==e?void 0:e.message)??e}),!1}}static async savePost(e,t){const i={requestsource:"community",handler:"save_draft",type:t},n=e=>{c.log({...v,message:"save_draft",pb:{...v.pb,url:Y.endpoints.msphPost,method:"POST",customMessage:JSON.stringify(e)}})};try{const t=await Y.POST(Y.endpoints.msphPost,e,i);return 1===t.status?t.id:void n({reason:"invalid_status",resp:t})}catch(e){return void n({reason:"save post failed",err:(null==e?void 0:e.message)??e})}}static async publishPost(e,t){const i={requestsource:"community",handler:"publish",itemId:e,type:t},n=e=>{c.log({...y,message:"publish",pb:{...y.pb,url:Y.endpoints.msphPost,method:"PUT",customMessage:JSON.stringify(e)}})};try{const t=await Y.PUT(Y.endpoints.msphPost,{},i);return 2===t.status||(n({reason:"invalid_status",postId:e,resp:t}),!1)}catch(t){return n({reason:"publish failed",postId:e,err:(null==t?void 0:t.message)??t}),!1}}static async unpublishPost(e,t){const i={requestsource:"community",handler:"unpublish",itemId:e,type:t};return Y.PUT(Y.endpoints.msphPost,{},i).then(e=>!0).catch(e=>{var t;return t={reason:"unpublish failed",err:(null==e?void 0:e.message)??e},c.log({...p,message:"unpublish",pb:{...p.pb,url:Y.endpoints.msphPost,method:"PUT",customMessage:JSON.stringify(t)}}),!1})}static async deletePost(e,t){const i={requestsource:"community",handler:"delete",itemId:e,type:t};return Y.DELETE(Y.endpoints.msphPost,i).then(()=>!0).catch(t=>{var i;return i={reason:"delete post failed",postId:e,err:(null==t?void 0:t.message)??t},c.log({...g,message:"delete",pb:{...g.pb,url:Y.endpoints.msphPost,method:"POST",customMessage:JSON.stringify(i)}}),!1})}static async appealPost(e,t,i){const n={requestsource:"community",handler:"appeal",itemId:e,type:t};return Y.POST(Y.endpoints.msphPost,i,n).then(()=>!0).catch(t=>{var i;return i={reason:"submit appeal failed",postId:e,err:(null==t?void 0:t.message)??t},c.log({...f,message:"appeal",pb:{...f.pb,url:Y.endpoints.msphPost,method:"POST",customMessage:JSON.stringify(i)}}),!1})}static async createMsphAccount(){const e={requestsource:"community"},t={market:_.T3.CurrentMarket};try{return await Y.POST(Y.endpoints.msphAccount,t,e),"pending"}catch(e){const t=e=>{c.log({...h,message:"create_account",pb:{...h.pb,url:Y.endpoints.msphAccount,method:"POST",customMessage:JSON.stringify(e)}})};if(400===e.status)try{const i=await e.json();switch(JSON.parse(i.Message).errorCode){case 38:return"invalid_market";case 844:return"not_poster_user";case 845:return"pending";case 36:return"not_community_user";case 846:return"invalid_name";case 847:return"invalid_avatar";default:return t({reason:"unexpected_error_code",data:i.Message}),"error"}}catch(e){return t({reason:"invalid_response",error:(null==e?void 0:e.message)??e}),"error"}return t({reason:"failed",status:e.status}),"error"}}static async queryMsphAccount(){const e={requestsource:"community"};try{return 2===(await Y.GET(Y.endpoints.msphAccount,e)).accountStatus?"active":"pending"}catch(e){const t=e=>{c.log({...h,message:"query_account",pb:{...h.pb,url:Y.endpoints.msphAccount,method:"GET",customMessage:JSON.stringify(e)}})};if(400===e.status)try{const i=await e.json(),n=JSON.parse(i.Message);return 844===n.errorCode?"not_poster_user":848===n.errorCode?"not_msph_user":13===n.errorCode?"is_aad_user":1===n.errorCode?"not_msph_user":(t({reason:"unexpected_error_code",data:i.Message}),"error")}catch(e){return t({reason:"invalid_response",error:(null==e?void 0:e.message)??e}),"error"}return t({reason:"failed",status:e.status}),"error"}}static async getInsightsBrief(e,t){const i={requestsource:"community",startDate:K(new Date(e)),endDate:K(new Date(t))};return Y.GET(Y.endpoints.msphInsights,i).catch(async e=>{const t=e=>{c.log({...w,message:"get_analytics",pb:{...w.pb,url:Y.endpoints.msphInsights,method:"GET",customMessage:JSON.stringify(e)}})};if(400===e.status)try{const i=await e.json();1!==JSON.parse(i.Message).errorCode&&t({reason:"unexpected_error_code",data:i.Message})}catch(e){t({reason:"invalid_response",error:(null==e?void 0:e.message)??e})}else t({reason:"get analysis data failed",err:(null==e?void 0:e.message)??e})})}static async uploadPostImage(e){const t=`${Math.random().toString(36).slice(2)}.jpg`,i=new URL(this.endpoints.image);i.search=N._3.keyValueArrayToQueryString([...N._3.getParams(_.T3.ContentServiceUrlBase.search),...G.WR.getOneServiceParamsWithoutAuth(_.T3.UserId,"",!1),{key:"path",value:"community"},{key:"name",value:t}]);const n=await G.WR.getBaseRequestData("POST");n.body=e,n.headers["Content-Type"]="image/jpeg";try{const e=await fetch(i.href,n);return(await e.json()).url}catch(e){return(e=>{c.log({...P,message:"upload_image",pb:{...P.pb,url:this.endpoints.image,method:"POST",customMessage:JSON.stringify(e)}})})({reason:"failed",error:(null==e?void 0:e.message)??e}),null}}static extractDomainFromUrl(e){try{return new URL(e).hostname}catch(e){return""}}static async fetchImageFromHubble(e){try{const t=await Y.POST(Y.endpoints.hubble,e);if("Unsuccessful"===t.Status)return null;const i=t.ProviderResults.map(e=>e.Result.PartGroups.map(e=>{var t,i;const n=e.Provider,o=e.ImageParts.find(e=>"Image"===e.ImageCategory);if(!o)return null;let r=o;"BingSearch"===n?r=e.ImageParts.find(e=>"SmallThumbnail"===e.ImageCategory)||o:"StockImagesSearch"===n?r=e.ImageParts.find(e=>"XLargeThumbnail"===e.ImageCategory)||o:"Getty"===n&&(r=e.ImageParts.find(e=>"MediumThumbnail"===e.ImageCategory)||o);const s=(null===(t=e.TextParts.find(e=>"Title"===e.TextCategory))||void 0===t?void 0:t.Text)||"";return{source:o.SourceUrl,thumbnail:r.SourceUrl,width:o.Width,height:o.Height,title:s,credit:"BingSearch"===n?this.extractDomainFromUrl((null===(i=e.TextParts.find(e=>"SourceLink"===e.TextCategory))||void 0===i?void 0:i.Text)||o.SourceUrl):n}})).flat().filter(Boolean);return{imgs:Array.from(new Set(i))}}catch(e){return(e=>{c.log({...S,pb:{...S.pb,url:this.endpoints.hubble,method:"POST",customMessage:JSON.stringify(e)}})})({reason:"failed",error:(null==e?void 0:e.message)??e}),null}}static async fetchImageFromBing(e){try{const t=await Y.GET(Y.endpoints.imageSearch,{...e,imageApiType:"1"});return{imgs:t.subResponse.value.map(e=>({source:e.contentUrl,thumbnail:e.thumbnailUrl,width:e.width,height:e.height,title:e.name,credit:this.extractDomainFromUrl(e.hostPageUrl||e.contentUrl)}))}}catch(e){return(e=>{c.log({...P,message:"search_image",pb:{...P.pb,url:this.endpoints.imageSearch,method:"GET",customMessage:JSON.stringify(e)}})})({reason:"failed",error:(null==e?void 0:e.message)??e}),null}}static async ImageCreatorCreate(e){try{const t={prompt:e,imageApiType:"2",mkt:(0,_.rA)().CurrentMarket,setLang:(0,_.rA)().CurrentMarket},i=await Y.GET(Y.endpoints.imageSearch,t);return{prompt:i.subResponse.prompt,readyInMs:i.subResponse.readyInMs+Date.now()+1e3,retrieveId:i.subResponse.webSearchUrl.split("/").pop()}}catch(e){return(e=>{c.log({...P,message:"ImageCreatorCreate",pb:{...P.pb,url:this.endpoints.imageSearch,method:"GET",customMessage:JSON.stringify(e)}})})({reason:"failed",error:(null==e?void 0:e.message)??e}),null}}static async ImageCreatorRetrieve(e,t){try{var i;const n={imageApiType:"3",retrieveId:t,q:e},o=await Y.GET(Y.endpoints.imageSearch,n);return{imgs:(null===(i=o.subResponse.images)||void 0===i?void 0:i.map(t=>({source:t.thumbnailUrl,thumbnail:t.thumbnailUrl,width:1024,height:1024,title:e,credit:"Image Creator"})))||[]}}catch(e){const t=e=>{c.log({...P,message:"ImageCreatorRetrieve",pb:{...P.pb,url:this.endpoints.imageSearch,method:"GET",customMessage:JSON.stringify(e)}})};return 404===e.status||t({reason:"failed",error:(null==e?void 0:e.message)??e}),null}}static async getFollowersByUserId(e){const t={$top:arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,$skip:arguments.length>2&&void 0!==arguments[2]?arguments[2]:0};return Y.GET(Y.endpoints.users+e+"/followers",t).then(e=>V.G.convertUserList(e))}static async getFollowingsByUserId(e){const t={subType:"default",$top:arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,$skip:arguments.length>2&&void 0!==arguments[2]?arguments[2]:0};return Y.GET(Y.endpoints.users+e+"/followings",t).then(e=>V.G.convertUserList(e))}static async followUser(e,t){if(t){const t=new q.PublisherServiceClient(this.fetchSocial),i=await t.getUserMutedPublishers(),n=i&&i.find(t=>t.profileId===e);n&&t.publisherUserAction(n.id,q.y.Mute,"DELETE")}return Y.POST(Y.endpoints.follows,{targetId:e},{})}static async unfollowUser(e){return Y.DELETE(Y.endpoints.follows,{targetId:e})}static async fetchUserCommunitySettings(){var e;const t={};Y.getMsaAccessToken()&&(t.UserTicketType="2",t.UserAuthToken=Y.getMsaAccessToken(),t.SiteName="api.msn.com"),Y.getMuid()&&(t.muid=Y.getMuid());const i=await M.d.getPdpUserPreference(!1,t,Y.getMuid());return(null==i||null===(e=i.value)||void 0===e?void 0:e.length)>0&&i.value[0].communitySettings||null}static async appealMe(){return Y.POST(Y.endpoints.users+"me/appeals",{})}static async appealMyPicture(){return Y.POST(Y.endpoints.users+"me/pictureAppeals",{})}static async reportUser(e,t,i,n){const o="ProfilePicture"==t?"PictureAbusereports":"NameAbusereports",{reportMessage:r,intellectualPropertyDetails:a}=n||{},c={ReportType:i.charAt(0).toUpperCase()+i.slice(1),ReportMessage:r||"",IntellectualPropertyDetails:a};try{return Y.POST(Y.endpoints.users+e+"/"+o,c,{version:"1.1"})}catch(e){s.v.logError(e)}}static async getUserActivities(e,t){const i={$top:e||50,$skip:t||0,version:"1.1"},n=await Y.GET(Y.endpoints.users+"me/activities",i);return V.G.convertUserActivities(n)}static async getUserStrikeActivities(){const e=await Y.GET(Y.endpoints.users+"me/activities",{onlyStrikeHistory:!0,version:"1.1"});return V.G.convertUserStrikeActivities(e)}static async updateUserActivityStatus(e){const t={id:e,read:!(arguments.length>1&&void 0!==arguments[1])||arguments[1]};return Y.POST(Y.endpoints.users+"me/activities",t,{version:"1.1"})}static async getUserNotifications(){const e=await Y.GET(`${Y.endpoints.users}me/activities`,{onlynotification:!0,read:!1,$top:5,$skip:0,version:"1.1"});return V.G.convertUserActivities(e)}static async getProviderFullPageData(e,t){let i=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"CommunityProfileId",n=arguments.length>3?arguments[3]:void 0;const o={market:_.T3.CurrentMarket,ocid:"Peregrine",query:t};o[i]=e,null!=n&&n.length&&(o.cardids=n.join(","));try{const t=await Y.GET(Y.endpoints.providerFullPage,o);return t&&0!==t.sections.length||a.YT.sendAppErrorEvent({...l.ugc,message:`feed data is empty for publisher ${e}`,pb:{...l.ugc.pb,debugId:null==t?void 0:t.debugId}}),t}catch{a.YT.sendAppErrorEvent({...l.ugc,message:`feed data is empty for publisher ${e}`})}}static async getCreatorHubFullPageData(){const e=window.location.hash.substring(1).toLowerCase(),t={market:_.T3.CurrentMarket,ocid:"Peregrine",query:"discover"==e.toLowerCase()?"":`msn_${e}`};return Y.GET(Y.endpoints.creatorHubFullPage,t)}static getProviderContents(e,t,i,n){let o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};const r={providerId:e,market:t,apiKey:_.T3.OneServiceApiKey,$top:o.top||20,$skip:o.skip||0,$orderby:o.orderBy||"Time desc",...i&&{contentType:i},...n&&{partnerTag:n}};return Y.GET(Y.endpoints.providerContents,r)}static async getPublisherFeed(e,t){const i={contentType:"article,video,slideshow,webcontent",market:t,apikey:_.T3.OneServiceApiKey,ocid:"Peregrine"};try{const t=await Y.GET(Y.endpoints.publisherFeed,i);return t&&0!==t.sections.length||a.YT.sendAppErrorEvent({...l.ugc,message:`feed data is empty for publisher ${e}`}),V.G.convertPublisherFeed(t)}catch{a.YT.sendAppErrorEvent({...l.ugc,message:`feed data is empty for publisher ${e}`})}}static async getTopCommentedContent(e,t){const i=_.T3.CurrentMarket,n={queryType:"TopCommented",timePeriod:e,$top:t,market:i},o=(await Y.GET(Y.endpoints.contents,n)).items,r=o.map(e=>e.cmsId),s={};return await Promise.all(r.map(async e=>{const t=await fetch(`${(0,_.rA)().AssetsUrl}/content/view/v2/Detail/${i}/${e}`,{method:"GET"});s[e]=await t.json()})),V.G.convertTopCommentedToPublisherCarouselData(o,s)}static observeRewardsInfo(e){this.rewardsInfoObservers.push(e);const t=this.rewardsInfoObservers.length-1;return()=>this.rewardsInfoObservers[t]=void 0}static async notifyRewardsInfoObservers(){this.getRewardsInfo()}static async getRewardsInfo(e){const t={version:"2",scope:e,ocid:"Peregrine"};let i;try{var n,o,r;const s=await this.makeOneServiceRequest("news/users/me/rewards","GET",t),a=s.userType===x.RewardsUser,c=null===(n=s.tokens)||void 0===n||null===(n=n.find(e=>e.tokenType===W.Tipping))||void 0===n?void 0:n.token,l=null===(o=s.tokens)||void 0===o||null===(o=o.find(e=>e.tokenType===W.Subscription))||void 0===o?void 0:o.token,d=!!c,u=!a&&s.eligibleFreeTipping,m=d||u,p=!!l,y=!a&&s.eligibleFreeSubscription.includes(e),g=p||y,v=s.eligibleBackupPayment&&(null===(r=s.tokens)||void 0===r||null===(r=r.find(e=>e.tokenType===W.BackupPaymentSubscription))||void 0===r?void 0:r.token);i={...s,isRewardsUser:a,freeTippingOfferToken:c,freeSubscriptionOfferToken:l,backupPaymentToken:v,isFreeTippingEligibleRewardsUser:d,isFreeTippingEligibleNonRewardsUser:u,isFreeTippingEligibleUser:m,isFreeSubscriptionEligibleRewardsUser:p,isFreeSubscriptionEligibleNonRewardsUser:y,isFreeSubscriptionEligibleUser:g}}catch(e){i={isRewardsUser:!1}}return this.rewardsInfoObservers.forEach(e=>{e&&e(i)}),i}static async createRewardsUser(e){const t={market:_.T3.CurrentMarket,source:e,ocid:"Peregrine"};try{const e=await this.makeOneServiceRequest("news/users/me/rewards","POST",t);return this.notifyRewardsInfoObservers(),{isUserCreated:!0,message:e.Message||""}}catch(e){try{var i;const t="User already exists.";if((null==e?void 0:e.Message)===t||(null===(i=await(null==e?void 0:e.json()))||void 0===i?void 0:i.Message)===t)return{isUserCreated:!0,message:t}}catch(e){}return{isUserCreated:!1,message:e.message||e.Message||""}}}static async getXpaySubscriptionPaymentOptions(e){if(!["vid-ksdbkre0pxrdbnxqmr5xbyu056sdgdim5cna8urvbu45yi3x7jqs"].includes(e)||"en-us"!=_.T3.CurrentMarket)return[];const t=_.T3&&_.T3.CurrentMarket&&_.T3.CurrentMarket.split("-");return Y.GET(Y.endpoints.paymentOptions,{publisherIdFromMsn:e,market:t[1]}).then(e=>{var t;return(null==e||null===(t=e.paymentOptionGroups[0])||void 0===t?void 0:t.paymentOptions)||[]}).catch(e=>(console.error("error occured while trying to get subscription payment options: ",e),[]))}static async getXPayTokenInfo(){return _.T3.Environment===U.O.int?Y.GET(L.v.externalUrls.ppeApi+"xpaytoken"):Y.GET(Y.domain+"xpaytoken")}static async getMarketSettings(){return Y.GET(Y.endpoints.marketsettings,{market:_.T3.CurrentMarket}).then(e=>V.G.convertMarketSettings(e||null))}static async getContentById(e){let{cmsId:t,market:i,url:n,contentUpdatedDateTime:o}=e;const r=t&&this.isURL(t)?t:null,s="gem"===C.Rb.ClientSettings.pagetype&&t.startsWith("gm-")?new URL(window.location.href).searchParams.get(Q.vj):null,a={cmsid:t,cmsUpdate:s||o,market:i,version:"1.1"};return n&&(a.url=n),r&&(delete a.cmsid,a.url=r),a.url&&a.url.includes("localhost.msn.com:8080")&&(a.url=a.url.replace("https://localhost.msn.com:8080/","https://www.msn.com/")),i||delete a.market,Y.GET(Y.endpoints.contents,a).then(e=>V.G.convertContent(e||null))}static async getAllowAndBlockList(e,t){return Y.contentAllowBlockListMap[t]||(Y.contentAllowBlockListMap[t]=Y.getContentById({cmsId:e,market:t})),Y.contentAllowBlockListMap[t]}static isURL(e){return!(!e||!e.includes("."))&&/^(?:(?:(?:https?|ftp):)?\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,})))(?::\d{2,5})?(?:[/?#]\S*)?$/i.test(e)}static async getCommentById(e){return Y.GET(Y.endpoints.comments+e).then(e=>V.G.convertComment(e||null))}static async getCommentsByContentId(e,t){const i={contentId:e,$top:t.top||50,$skip:t.skip||0,$orderby:t.orderBy||t.sortType||"Rating"};return Y.GET(Y.endpoints.comments,i).then(e=>{let t="On";try{t=e.links.find(e=>"Content"==e.type).item.commentStatus||t}catch(e){s.v.logError("Invalid content data in comments response.")}try{const i=V.G.convertCommentList(e||null);return i.commentStatus=t,i}catch(e){return s.v.logError("Invalid comment list data in comments response."),{commentStatus:"Off",list:[]}}})}static async getCommentsByParentId(e,t){const i={parentId:e,$top:t.top||10,$skip:t.skip||0,$orderby:t.orderBy||"Time"};return Y.GET(Y.endpoints.comments,i).then(e=>V.G.convertCommentList(e||null))}static async getCommentsByAnchorCommentId(e,t){const i={anchorId:e,$top:t.top||10,$skip:t.skip||0,$orderby:t.orderBy||"Time"};return Y.GET(Y.endpoints.comments,i).then(e=>V.G.convertCommentList(e||null))}static async getCommentsByUserId(e){const t={userId:e,$top:arguments.length>1&&void 0!==arguments[1]?arguments[1]:10,$skip:arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,$orderby:arguments.length>3&&void 0!==arguments[3]?arguments[3]:"Time"};return Y.GET(Y.endpoints.comments,t).then(e=>V.G.convertCommentList(e||null)).catch(t=>{a.YT.sendAppErrorEvent({...l.Ghz,message:`Error getting user comments ${e} ${JSON.stringify(t)}`})})}static async postComment(e,t,i){var n,o,r;let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:void 0,c=arguments.length>5&&void 0!==arguments[5]?arguments[5]:void 0,l=arguments.length>6&&void 0!==arguments[6]?arguments[6]:void 0,d=arguments.length>7&&void 0!==arguments[7]?arguments[7]:void 0;const u={ContentId:e,Body:i,parentId:a&&a!=e?a:void 0,mentionReply:arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0},m=(null===C.Rb||void 0===C.Rb||null===(n=C.Rb.ClientSettings)||void 0===n?void 0:n.ocid)||"OCIDNA",p=(null===C.Rb||void 0===C.Rb||null===(o=C.Rb.ClientSettings)||void 0===o?void 0:o.pagetype)||"PageTypeNA",y=[m,(null===C.Rb||void 0===C.Rb||null===(r=C.Rb.ClientSettings)||void 0===r?void 0:r.verticalKey)||"VerticalNA",p,d||"overlay"].filter(e=>""!==e).join("-");let g={};return c&&(g.version=c),l&&(g.url=l),y&&(g.ocid=y),Y.additionalParameters&&(g={...g,...Y.additionalParameters}),new Promise((e,t)=>{Y.POST(Y.endpoints.comments,u,g).then(t=>{e(V.G.convertComment(t||null))},e=>{e.json().then(e=>{t(e)}).catch(i=>{s.v.logError("Error getting comment info: "+e.statusText),t()})})})}static async deleteComment(e){return Y.DELETE(Y.endpoints.comments+e,{})}static async appealComment(e){return Y.POST(Y.endpoints.comments+e+"/appeals",{})}static async reportComment(e,t,i){const{reportMessage:n,intellectualPropertyDetails:o}=i||{},r={ReportType:t,ReportMessage:n||"",IntellectualPropertyDetails:o};try{return Y.POST(Y.endpoints.comments+e+"/abusereports",r,{version:"1.1"})}catch(e){s.v.logError(e)}}static async reportPoll(e,t,i){const n={ReportType:t,id:e};null!=i&&i.length&&(n.Description=i);try{return Y.POST(Y.endpoints.posts+e+"/abusereports",n,{version:"1.1"})}catch(e){s.v.logError(e)}}static async uploadCopyrightFile(e){const t=await Y.GET(Y.endpoints.users+"me/UploadSasToken",{type:"ContentReport"}),i=await A(),n=`https://${t.accountUrl.split("?")[0]}`,o=i.Blob.createBlobServiceWithSas(n,t.sasString);return new Promise((i,n)=>{o.createBlockBlobFromBrowserFile(t.container,t.blobName,e,async(e,o,r)=>e?n(e):i(t.id))})}static prepareHubString(e){return e.replace(/-/g,"_")}static async getSignalRConnectionInfo(e){const t=this.prepareHubString(e);return Y.POST(Y.endpoints.typingUpdates+"RealtimeTypingNegotiate",{},{hub:t})}static async broadcastCommentNotification(e,t,i){const n=this.prepareHubString(e),o={type:"comment-notification",data:{commentId:t,commentParentId:i}};return Y.POST(Y.endpoints.typingUpdates+"RealtimeTypingBroadcast",o,{hub:n}).then(e=>{},e=>{})}static async broadcastTypingNotification(e,t,i,n){const o=this.prepareHubString(e),r={type:"typing-notification",data:{id:t,name:i,profileImageUrl:n}};return Y.POST(Y.endpoints.typingUpdates+"RealtimeTypingBroadcast",r,{hub:o}).then(e=>{},e=>{})}static async broadcastViewNotification(e,t){const i=this.prepareHubString(e),n={type:"view-notification",data:{viewing:t}};return Y.POST(Y.endpoints.typingUpdates+"RealtimeTypingBroadcast",n,{hub:i}).then(e=>{},e=>{})}static setCommentPaneVisited(){te.getItem(r.dm)||te.setItem(r.dm,"true")}static getCommentPaneVisited(){return Boolean(te.getItem(r.dm))}static async sendReaction(e){let{actionPosition:t,id:i,item:n,localStorageSave:o,reactionType:r,socialEndorsementTypes:s,url:a}=e;try{let e={};a&&(e.url=a),Y.additionalParameters&&(e={...e,...Y.additionalParameters}),t&&(e.communitymetadata=`lineage:${t}`);const c={};r?c.subType=r:s&&(c.subType="socialEndorsement",c.subTypeData=s);const l=encodeURIComponent(i),d=Y.endpoints[n]+l+"/reactions",u=await Y.POST(d,c,e);return r&&ie(l,r,!1,o),s&&ne(l,s),V.G.convertRatingToRateValue(u||null)}catch(e){(0,R.vV)(l.M6r,"Send reaction failed in SocialService","See exception message in the property bag",{itemType:n,itemId:i,reactionType:r,endorsementTypes:s,message:null==e?void 0:e.message,stack:null==e?void 0:e.stack})}}static async sendResetReaction(e){let{id:t,item:i,localStorageSave:n,url:o}=e;try{let e={};return o&&(e={...e,url:o}),Y.additionalParameters&&(e={...e,...Y.additionalParameters}),ie(t,null,!0,n),Y.DELETE(Y.endpoints[i]+t+"/reactions",e)}catch(e){(0,R.vV)(l.M6r,"Delete reaction failed in SocialService","See exception message in the property bag",{itemType:i,itemId:t,message:null==e?void 0:e.message,stack:null==e?void 0:e.stack})}}static async saveContentEndorsements(e,t,i){return ne(e,t,i)}static async getFriendRatings(e,t){return Y.GET(Y.endpoints[e]+t+"/reactions",{friends:!0,$top:2})}static async getRating(e,t){return Y.GET(Y.endpoints[e]+t+"/reactions",{}).then(e=>V.G.convertRatingToRateValue(e||null))}static async getRatingBreakdown(e,t,i){return Y.GET(Y.endpoints[e]+t+"/reactions",{others:!0}).then(e=>V.G.convertReactionsResponseToReactionBreakdownData(e||null,i))}static async sendContentStarRating(e,t,i,n){const o={subType:i,surveyId:n};Y.POST(Y.endpoints.contents+e+"_"+t+"/starratings",o,{})}static async sendResetContentStarRating(e,t,i){const n={surveyId:i};Y.DELETE(Y.endpoints.contents+e+"_"+t+"/starratings",n)}static async getContentStarRating(e,t,i){const n={surveyId:i};return Y.GET(Y.endpoints.contents+e+"_"+t+"/starratings",n).then(e=>V.G.convertRatingToRateValue(e||null))}static async getContentStarRatingAverage(e,t){const i=await this.getStarRatingContentById(e,t);let n=0,o=0;for(const e in Object.keys(i.reactionCounts))switch(n+=i.reactionCounts[e],e){case j.sM.angry:o+=1*i.reactionCounts[e];break;case j.sM.like:o+=2*i.reactionCounts[e];break;case j.sM.love:o+=3*i.reactionCounts[e];break;case j.sM.sad:o+=4*i.reactionCounts[e];break;case j.sM.surprised:o+=5*i.reactionCounts[e]}return i&&{contentId:i.id,averageStarRating:o/n}}static async getStarRatingContentById(e,t){return Y.getContentById({cmsId:`${(0,_.rA)().AssetsUrl}/labs/star-rating/${t}/${e}/rating`,market:t})}static async getPostsByTopicId(e,t,i,n,o,r){const s={topicId:e,postType:t||"",market:i||_.T3.CurrentMarket||"en-us",top:o||5,skip:r||0,orderBy:n||"Time"},a=N._3.getQueryParameterByName("isPpe",(0,O.$N)())?L.v.externalUrls.ppeApi.concat("posts/"):Y.endpoints.posts;return Y.GET(a,s).then(e=>V.G.convertPostList(e||null)).catch(e=>[])}static async getPostById(e){const t={postId:e},i="true"===N._3.getQueryParameterByName("isPpe",(0,O.$N)())?L.v.externalUrls.ppeApi.concat("posts/"):Y.endpoints.posts;return Y.GET(i,t).then(e=>V.G.convertPost(e||null)).catch(e=>null)}static async SendGetRequest(e){try{var t;const i=await this.fetchSocial(e,{method:"GET"}),n=await i.json();return n.debugId=null===(t=i.headers)||void 0===t?void 0:t.get(X),n}catch{return{}}}static async GET(e,t){const i={method:"GET",queryParams:t=t||{},body:void 0};return this.xhr(e,i)}static async POST(e,t,i){const n={method:arguments.length>3&&void 0!==arguments[3]?arguments[3]:"POST",queryParams:i=i||{},body:t};return this.xhr(e,n)}static async PUT(e,t,i){return Y.POST(e,t,i,"PUT")}static async DELETE(e,t){const i={method:"DELETE",queryParams:t=t||{},body:void 0};return this.xhr(e,i)}static async xhr(e){var t;let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{method:void 0,queryParams:void 0,body:void 0},n="GET"!==i.method?{"Content-Type":"application/json"}:{};const o="POST"===(null===(t=i.method)||void 0===t?void 0:t.toUpperCase())&&e.startsWith(Y.endpoints.comments);n={...await G.WR.getOneServiceHeaders(!1,void 0,void 0,void 0,o?(0,E.lp)():void 0),...n},Y.additionalHeaders&&(n={...n,...Y.additionalHeaders}),Y.getMsaAccessToken()&&(n.UserTicketType="2",n.UserAuthToken=Y.getMsaAccessToken(),n.SiteName="api.msn.com"),Y.getMuid()&&(n.muid=Y.getMuid());const r=G.WR.getCommonParams2(this.socialServiceOCID),s=function(){if(_.T3.WidgetAttributes){const{propertyBag:e={}}=_.T3.WidgetAttributes,{social:t}=e;return t}return null}();s&&(s.ocid&&(r.find(e=>"ocid"==e.key).value=s.ocid),s.apiKey&&(r.find(e=>"apikey"==e.key).value=s.apiKey)),r.forEach(t=>{"user"===t.key&&e.startsWith(Y.endpoints.posts)||t.value&&!Object.prototype.hasOwnProperty.call(i.queryParams,t.key)&&(i.queryParams[t.key]=t.value)}),i.queryParams.wrapodata="false",J()?i.queryParams.source=(null==s?void 0:s.source)||"BingImage":e.startsWith(Y.domain)&&this.isApiModerationVertical?i.queryParams.source=`${_.T3.AppType}-community`:"gem"===C.Rb.ClientSettings.pagetype&&(i.queryParams.source="gem-community");const a=(c=i.queryParams)&&Object.keys(c).length>0?"?"+Object.keys(c).map(function(e){return`${e}=${encodeURIComponent(c[e])}`}).join("&"):"";var c;const l={method:i.method||"GET",headers:n,credentials:e.match("xpay/subscription/paywall_nosign")||o?"same-origin":"include"};i.body&&(l.body=JSON.stringify(i.body));return(Y.useCache?Y.fetchCachedResponse(e+a,l):Y.fetchSocial(e+a,l)).then(t=>{if(!(t.status>=200&&t.status<300))throw this.onRequestError(e,i,t),t;if(204==t.status)return{};try{return t.clone().json().then(e=>{var i;return e.value&&(e=e.value[0]),e.debugId=null===(i=t.headers)||void 0===i?void 0:i.get(X),e.status=t.status,e})}catch(n){throw this.onRequestError(e,i,t),{message:"Error in parsing API response in SocialService xhr method",status:t.status,statusText:"INVALID_RESPONSE"}}})}static fetchCachedResponse(e,t){if(t&&"GET"==t.method&&e in Y.cachedResponses)return Y.cachedResponses[e];t&&"GET"!=t.method&&Y.clearCache();const i=Y.fetchSocial(e,t);return t&&"GET"==t.method&&(Y.cachedResponses[e]=i,setTimeout(()=>{e in Y.cachedResponses&&delete Y.cachedResponses[e]},2500)),i}static async fetchSocial(e,t){return(0,F.w)(()=>(0,D.hv)(e,Y.shouldUseAbortableFetch?Y.abortableFetchTimeout:0,t),"CommunityServiceRequest-URL: "+e)}static clearCache(){Y.cachedResponses={}}static onRequestError(e,t,i){const n=this.getAppErrorFromUrl(e);try{i.clone().json().then(o=>{o.value&&(o=o.value[0]),c.log({...n,message:`${t.method}-${i.status}-${o.code||""}${o.subCodes&&o.subCodes.length>0?"-"+o.subCodes[0]:""}`,pb:{...n.pb,url:e,method:t.method,responseStatus:i.status,responseBody:o}})})}catch(o){c.log({...n,message:`${t.method}-${i.status}`,pb:{...n.pb,url:e,method:t.method,responseStatus:i.status}})}}static getAppErrorFromUrl(e){return e.startsWith(Y.endpoints.contents)?e.includes("reactions")?l.h3O:e.includes("starratings")?l.jjJ:l.vpF:e.startsWith(Y.endpoints.comments)?e.includes("reactions")?l.Z1s:e.includes("abusereports")?l.aKE:e.includes("appeals")?l.NPP:l.$$G:e.startsWith(Y.endpoints.posts)?e.includes("abusereports")?l.tWP:l.Y2P:e.startsWith(Y.endpoints.users)?l.bxt:e.startsWith(Y.endpoints.follows)?l.t$8:e.startsWith(Y.endpoints.typingUpdates)?e.includes("RealtimeTypingNegotiate")?l.p2F:l._Rq:e.startsWith(Y.endpoints.marketsettings)?l._F6:l.tb_}static async makeOneServiceRequest(e,t,i,n){const o=(0,H.nI)(e),r=(0,z.Fo)()?G.WR.getOneServiceParamsWithAuth(_.T3.UserId,"",!1):G.WR.getOneServiceParamsWithoutAuth(_.T3.UserId,"",!1),s={};[...r,...Object.keys(i).map(e=>({key:e,value:i[e]})),...[...o.searchParams.keys()].map(e=>({key:e,value:o.searchParams.get(e)}))].forEach(e=>{s[e.key]=e.value});const a=o.origin+o.pathname;return"GET"===t?this.GET(a,s):this.POST(a,n,s)}}var Z;!function(e){e.contents="contents",e.comments="comments",e.users="users"}(Z||(Z={}));const ee=async e=>{const t=(0,O.iA)().toLowerCase().indexOf(L.v.selectPpeParameter)>-1;if(_.T3.Environment!==U.O.int||t?_.T3.Environment===U.O.prod&&t&&console.warn("PPE environment must not be enabled in PROD environment for Subscription SDK to work"):console.warn("PPE environment will be used for xpay token JWT in INT environment for Subscription SDK to work"),te.supported){const t=_.T3.Environment===U.O.int?"int":"prod",i=`community_xpay_token_${e}_${t}`,n=`community_xpay_token_expires_${e}_${t}`,o=te.getItem(i);if(o){const e=te.getItem(n);if(e&&new Date(parseInt(e)).valueOf()-Date.now()>1e4)return o}const r=await Y.getXPayTokenInfo();return te.setItem(i,r.accessToken),te.setItem(n,(Date.now()+1e3*r.expiresIn).toString()),r.accessToken}return(await Y.getXPayTokenInfo()).accessToken},te=(0,$.Lg)(),ie=async(e,t,i,n)=>{if(n)n(e,i?null:t);else if(te.supported){let n;if((0,z.Fo)()&&(n=(0,r.$K)(),!n)){const e=await Y.fetchMe(!1);n=e.id}const o=(0,r.ac)(n,e),s=(0,r.Tw)(n);if(i){te.removeItem(o);const t=te.getItem(s);let i=t?t.split(","):[];i=i.filter(t=>t!=e),i.length&&te.setItem(s,i.join(","))}else if(t){const i=te.getItem(s);let a=i?i.split(","):[];a.length>200&&(a=a.filter((e,t)=>!(t<100)||(te.removeItem((0,r.ac)(n,e)),!1))),a.includes(e)||a.push(e),te.setItem(o,t),te.setItem(s,a.join(","))}}},ne=async(e,t,i)=>{if(i)i(e,t.length>0?t:null);else if(te.supported)try{let i;if((0,z.Fo)()&&(i=(0,r.$K)(),!i)){i=(await Y.fetchMe(!1)).id}const n=(0,r.Z7)(i,e);if(0===t.length)te.removeItem(n);else{const e=t.filter(e=>null!=e&&void 0!==e);if(e.length>0){const t=e.map(e=>e.toLowerCase()).join(",");te.setItem(n,t)}else te.removeItem(n)}}catch(i){s.v.logError&&s.v.logError(`Failed to save endorsements to localStorage: ${null==i?void 0:i.message}`),(0,R.vV)(l.cPt,"Failed to save endorsements to localStorage","See exception message in the property bag",{itemId:e,endorsementTypes:t,message:null==i?void 0:i.message,stack:null==i?void 0:i.stack})}};!async function(){if(te.supported){const e=te.getItem(r.Z);if(e){let t;if((0,z.Fo)()){const e=await Y.fetchMe(!1);t=e.id}e.split(",").forEach(e=>{const i=te.getItem(`${r.YA}${e}`);i&&(te.removeItem(`${r.YA}${e}`),te.setItem((0,r.ac)(t,e),i))}),te.removeItem(r.Z),te.setItem((0,r.Tw)(t),e)}}}(),(0,O.iA)().toLowerCase().indexOf(L.v.selectPpeParameter)>-1&&Y.setDomain(L.v.externalUrls.ppeApi,L.v.externalUrls.msphPpeApi),_.T3.IsChinaCompliance&&Y.setDomain(L.v.externalUrls.cnApi,L.v.externalUrls.msphCnApi)},33322:function(e,t,i){i.d(t,{tQ:function(){return s}});var n=i(9964);function o(e){const t=window.location.search.substring(1).split("&"),i=[];for(let n=0;n<t.length;n++){const o=t[n].split("=");o[0].toLowerCase()==e.toLowerCase()&&i.push(o[1])}return i.length>0?i.map(e=>decodeURIComponent(e||"")).join(","):null}function r(e){return e&&Object.keys(e).length>0?"?"+Object.keys(e).map(function(t){return e[t].split(",").map(e=>e?`${t}=${encodeURIComponent(e)}`:t).join("&")}).join("&"):""}function s(e,t,i){const s={};["fdhead","item","rt","theme","ocid","env","oneservice_enable_ppe"].map(e=>{const t=o(e);null!==t&&(s[e]=t)});const a=r(s),c=void 0!==n.env.JEST_WORKER_ID?"/en-ca/":"/en-us/";t&&e.indexOf(c)>0&&(e=e.replace(c,`/${t}/`));const l=[e];return a&&-1!=e.indexOf("?")?l.push(`&${a.substring(1)}`):a&&l.push(a),l.push(i?`#comments&commentId=${i}`:""),l.join("")}},57863:function(e,t,i){i.d(t,{al:function(){return d},XN:function(){return c},No:function(){return l}});var n=i(28868),o=i(1350);function r(e,t){if(function(e){try{return(null==e?void 0:e.needHeader)??!1}catch(e){a(`Failed to get feed needHeader Failed with exception : ${e}`)}}(e))try{const e=JSON.parse(t),i=JSON.parse((null==e?void 0:e.header)??null),n=(null==i?void 0:i["ddd-activityid"])??null;n&&async function(e){const t=window.localStorage.getItem(s);if(void 0!==t&&""!==t&&null!==t){const i=t.split(",");return void(i.length<10&&!i.includes(e)&&window.localStorage.setItem(s,`${t},${e}`))}window.localStorage.setItem(s,e)}(n)}catch(e){a(`Failed to get feed needHeader Failed with exception : ${e}`)}}const s="activityIds";function a(e){(0,n.RH)()&&function(e){new Promise((t,i)=>{!function(e,t){(0,n.lA)("logEvent",e,t)}(e,e=>{t(e)})})}({appId:o.H7,type:"Debug",name:"HP_WEBVIEW_SERVER_LOG",data:{message:e}})}function c(e){return new Promise((t,i)=>{!function(e,t){(0,n.lA)("getHttp",e,t)}(e,i=>{t(i),r(e,i)})})}function l(e){return new Promise((t,i)=>{!function(e,t){(0,n.lA)("postHttp",e,t)}(e,e=>{t(e)})})}function d(e){return new Promise((t,i)=>{!function(e,t){(0,n.lA)("deleteHttp",e,t)}(e,e=>{t(e)})})}},69023:function(e,t,i){var n;i.d(t,{y:function(){return n},PublisherServiceClient:function(){return v}}),function(e){e.More="More",e.Mute="Mute",e.Read="Read"}(n||(n={}));var o=i(85889),r=i(12870),s=i(17254),a=i(74326),c=i(19993),l=i(57759),d=i(56639),u=i(28868),m=i(64405),p=i(57863),y=i(29252),g=i(86948);class v{constructor(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];this.fetchImpl=e,this.addPageInfoToOcid=t,this.followedPublishersEndpoint="v1/News/Users/Me/PreferredProviders",this.followedSourcesEndpoint="msn/sources",this.publishersServiceEndpoint="Msn/Providers",this.actionsServiceEndpoint="Graph/Actions",this.followActionSourceEndpoint="community/follows",this.ocid="feeds"}getOcid(){return this.ocid}async getUserMutedPublishers(){const e=await this.getUserActions(n.Mute);if(!e||!e.value)return null;if(!e.value.length)return[];const t=e.value.reduce((e,t)=>(e[t.targetId]=t,e),{}),i=await this.getPublisherDetails(Object.keys(t));if(!i||!i.value||!i.value.length)return null;return i.value.map(e=>{const i={createdDateTime:t[e.id].createdDateTime};return{...e,...i}})}async getUserFollowedPublishers(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;const t=await this.getRequestInit(),i=[...await this.getCommonParams(),{key:"$top",value:`${e}`}],n=(0,a.nI)(this.followedPublishersEndpoint);this.appendQs(i,n),(0,o.Iv)()||(0,y.P7)(n);const r=await this.sendRequest(decodeURIComponent(n.href),t,"getFollowedPublishers");return null==r?void 0:r.value}async getUserFollowedSources(){var e,t;let i=arguments.length>0&&void 0!==arguments[0]?arguments[0]:100;const n=await this.getRequestInit(),r=[...await this.getCommonParams(),{key:"$top",value:`${i}`},{key:"queryType",value:"MyFeed"}],s=(0,a.nI)(this.followedSourcesEndpoint);let c;this.appendQs(r,s),(0,o.Iv)()||(0,y.P7)(s);try{c=await this.sendRequest(decodeURIComponent(s.href),n,"getFollowedSources")}catch(e){throw new Error(`{url: ${s.href}}`)}return(null===(e=c)||void 0===e||null===(e=e.value)||void 0===e?void 0:e.length)>0?null===(t=c)||void 0===t||null===(t=t.value[0])||void 0===t?void 0:t.subCards.map(e=>{var t;const i=e.intAttributes&&1==e.intAttributes.disableProfile;return{...e,profileId:i?null:e.profileId,displayName:e.name,logos:[{imageLink:{href:null===(t=e.image)||void 0===t?void 0:t.url}}]}}):[]}async publisherUserAction(e,t,i){if(!e||!t)return null;const n=await this.getRequestInit();n.method=i;let o=await this.getCommonParams();"POST"===i?n.body=JSON.stringify({actionType:t,targetId:e,targetType:"SourceProvider"}):"DELETE"===i&&(o=[...o,{key:"$filter",value:`actionType eq '${t}' and targetId eq '${e}'`}]);const r=(0,a.nI)(this.actionsServiceEndpoint);this.appendQs(o,r);const s=await this.sendRequest(decodeURIComponent(r.href),n,`deleteUserAction ${t}`,!0,!0);if(s.status>=400){const i=`OneService returned error response. Status: ${s.status} for actionType: ${t}, targetId: ${e}`;throw new Error(i)}return s}async updateSourceFollowState(e,t,i){if(!e)return null;const n=await this.getRequestInit();let o=await this.getCommonParams();o=[...o],t?(n.method="POST",n.body=JSON.stringify({targetId:e})):(n.method="DELETE",o=[...o,{key:"targetId",value:e}]),i&&r.Rb.CurrentFlightSet.has("prg-followdata-t")&&o.push({key:"communitymetadata",value:`itemid:${(null==i?void 0:i.contentId)||"undefined"},lineage:${(null==i?void 0:i.actionPosition)||`${s.T3.AppType}>PublisherServiceClient>UndefinedLineage`}`});const c=(0,a.nI)(this.followActionSourceEndpoint);this.appendQs(o,c);const l=t?"follow":"unfollow";try{return await this.sendRequest(decodeURIComponent(c.href),n,`updateSourceFollowState ${l}`,!0,!0)}catch(t){throw new Error(`OneService returned error response. Community follow service  for targetId: ${e}, action: ${l}`)}}async updatePublisherReadTime(e,t,i){if(!e)return null;const o=await this.getRequestInit(),r=await this.getCommonParams(),s=n.Read;o.method="POST",o.body=JSON.stringify({actionType:s,targetType:i,targetId:e,updatedDateTime:t});const c=(0,a.nI)(this.actionsServiceEndpoint);this.appendQs(r,c);try{return await this.sendRequest(decodeURIComponent(c.href),o,`updateSourceReadTime ${s}`,!0,!0)}catch(t){throw new Error(`OneService returned error response for actionType: ${s}, targetId: ${e}`)}}async getUserPublishersReadTimes(){try{const e=await this.generatePublisherStatusRequest(void 0,n.Read);return null==e?void 0:e.value}catch(e){throw new Error("OneService returned error response for fetching followed sources read times.")}}async getUserPublisherStatus(e,t){var i;return!(null===(i=(await this.generatePublisherStatusRequest(e,t)).value)||void 0===i||!i.length)}async generatePublisherStatusRequest(e,t){const i=await this.getRequestInit();i.method="GET";const n=e?`and targetId eq '${e}'`:"";let r=await this.getCommonParams();r=[...r,{key:"$filter",value:`actionType eq '${t}' ${n} `}];const s=(0,a.nI)(this.actionsServiceEndpoint);return this.appendQs(r,s),(0,o.Iv)()||(0,y.P7)(s),await this.sendRequest(decodeURIComponent(s.href),i,`getUserPublisherStatus ${t}`)}async getUserActions(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:100;const i=await this.getRequestInit(),n=[...await this.getCommonParams(),{key:"$filter",value:`actionType eq '${e}' and deleted eq false and targetType eq 'SourceProvider'`},{key:"$top",value:`${t}`}],r=(0,a.nI)(this.actionsServiceEndpoint);return this.appendQs(n,r),(0,o.Iv)()||(0,y.P7)(r),await this.sendRequest(decodeURIComponent(r.href),i,`getUserActions ${e}`)}async getPublisherFromProfileIds(e){const t=await this.getRequestInit(),i=(0,a.nI)(this.followedSourcesEndpoint),n=[...c.WR.getOneServiceParamsWithoutAuth(null,this.ocid,this.addPageInfoToOcid),{key:"ids",value:e.join(",")}];return this.appendQs(n,i),await this.sendRequest(decodeURIComponent(i.href),t,"getSourcesFromProfileIds")}async getPublisherDetails(e){const t=await this.getRequestInit(),i=(0,a.nI)(this.publishersServiceEndpoint),n=[...c.WR.getOneServiceParamsWithoutAuth(null,this.ocid,this.addPageInfoToOcid),{key:"ids",value:e.join(",")}];return this.appendQs(n,i),await this.sendRequest(decodeURIComponent(i.href),t,"getPublisherDetails")}async getCommonParams(){var e;"winWidgets"===s.T3.AppType&&("startfeed"===(null===(e=s.T3.CurrentRequestTargetScope)||void 0===e?void 0:e.pageType)&&"ruby"===s.T3.UxMode?(this.ocid="rubyprong2",this.addPageInfoToOcid=!1):(this.ocid="winp2",this.addPageInfoToOcid=!1));if("windowsShell"===s.T3.AppType&&(this.ocid="windows-windowsshellhp-feeds",this.addPageInfoToOcid=!1),(0,o._v)()&&(this.addPageInfoToOcid=!1,this.ocid="emmx-mmx-feeds"),(0,o.Iv)())return this.getSapphireQueryParams();this.forcedApiKey&&(this.addPageInfoToOcid=!1),(0,o.tl)()&&(this.ocid="swiftkey-umf",this.addPageInfoToOcid=!1),(0,o.V8)()&&(this.ocid="bing-dhp-mobile",this.addPageInfoToOcid=!1),"bingHomepage"===s.T3.AppType&&(this.ocid="bing-widgetfeed-Peregrine",this.addPageInfoToOcid=!1);const t=await this.isUserSignedIn()?c.WR.getOneServiceParamsWithAuth(s.T3.UserId||s.T3.ActivityId,this.ocid,this.addPageInfoToOcid):c.WR.getOneServiceParamsWithoutAuth(s.T3.UserId||s.T3.ActivityId,this.ocid,this.addPageInfoToOcid);if(this.forcedApiKey){t.find(e=>"apikey"==e.key).value=this.forcedApiKey}return t}getSapphireQueryParams(){const e=c.WR.getOneServiceNonDynamicParamsWithoutAuth(this.ocid,this.addPageInfoToOcid,s.T3.UserId||s.T3.ActivityId),t=(0,d.cE)();return t&&(e.push({key:s.T3.OneServiceContentMarketQspKey,value:t.market}),s.T3.ShouldUseFdheadQsp&&e.push({key:"fdhead",value:t.features}),e.push({key:"activityId",value:t.activityId}),t.latitude&&t.longitude&&e.push({key:"location",value:`${t.latitude}|${t.longitude}`})),e}async getRequestInit(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;return null==e&&(e={method:"GET"}),e.credentials="include",e.headers=(0,u.RH)()?await(0,m.U)():await c.WR.getOneServiceHeaders(),e}async isUserSignedIn(){const e=(0,r.Th)().UserIsSignedIn;if(void 0!==e)return e;return 2===await(0,g.XK)()}async sendRequest(e,t,i,n,r){return(0,o.Iv)()?await this.sapphireRequest(decodeURIComponent(e),t):await this.networkRequest(decodeURIComponent(e),t,i,n,r)}async sapphireRequest(e,t){const i={url:e,headers:t.headers,body:t.body,refresh:!0,needHeader:!0,needCookie:!0};let n;switch(t.method){case"POST":n=await(0,p.No)(i);break;case"DELETE":n=await(0,p.al)(i);break;default:n=await(0,p.XN)(i)}return JSON.parse(n||"{}")}async networkRequest(e,t,i,n,o){return(0,l.w)(async()=>{const i=await this.fetchImpl(e,t);if(!i.ok)throw Error(i.statusText);return n&&(0,y.r8)(),o?i:i.json()},i)}appendQs(e,t){e.forEach(e=>{e.value&&t.searchParams.set(e.key,e.value)})}setForcedApiKey(e){this.forcedApiKey=e}}},72725:function(e,t,i){i.d(t,{c:function(){return a},v:function(){return s}});var n=i(17254),o=i(9964);let r=n.T3.NavTargetUrlWithLocale;void 0!==o.env.JEST_WORKER_ID&&(n.T3.CurrentMarket||(r=r.replace("undefined","en-ca")));const s={selectPpeParameter:"oneservice_enable_ppe",renderWithMockData:"render_with_mock_data",externalUrls:{api:`${(0,n.rA)().AssetsUrl}/service/community/`,cnApi:`${(0,n.rA)().AssetsUrl}/service/community/`,ppeApi:"https://ppe-api.msn.com/community/",msphApi:"https://api.msn.com/ugc",msphCnApi:"https://api.msn.cn/ugc",msphPpeApi:"https://sf-int.oneservice-test.msn.com/ugc",hubbleApi:"https://hubble.officeapps.live.com",hubblePpeApi:"https://hubble.officeapps.live-int.com",guidelinePage:`${r}/community/guideline`,guidelinePageEmbed:`${r}/community/embed/guidelinepage`,profilePage:`${r}/community/profile/`,bingProfilePage:"https://www.bing.com/profile/community",channelPage:`${r}/community/channel/`,privacySettings:`${r}/settings`,activityPage:`${r}/community/activity`,statusPage:`${r}/community/activity?profileStatus=true`,newPost:`${r}/community/post/new`,profileSettings:"https://account.microsoft.com/profile",feedbackForm:"https://forms.office.com/Pages/ResponsePage.aspx?id=v4j5cvGGr0GRqy180BHbR-V3gf69zQlBm1dJVuXA8mtURVI4UlFHMDRIR0VCWDFWNUQyQU5HVzJJQi4u",moderationEmail:"Appealsprocessor@microsoft.com",bingImageDetailPage:"https://www.bing.com/images/search"},userStateType:{existingUser:"existingUser",anonymous:"anonymous",newUser:"newUser"},userAccountType:{msa:"PersonalMicrosoftAccount",aad:"AzureActiveDirectory"},userNameStatusType:{normal:"Normal",notAllow:"NotAllow",inReview:"InReview",unknown:"Unknown"},userAvatarStatusType:{normal:"Normal",notAllow:"NotAllow",inReview:"InReview",unknown:"Unknown"},userStatusStorageKeys:{edgeLoginStatus:"CommunityUserEdgeLoginStatus"},accountModerationStatus:{normal:"Normal",warning:"Warning",firstStrike:"FirstStrike",secondStrike:"SecondStrike",permanentBan:"PermanentBan",ban:"Ban"},accountModerationStatusStringKeyMap:{restricted:"AccountStatusRestricted",atRisk:"AccountStatusAtRisk",warned:"AccountStatusWarned",FirstStrike:"AccountStatusActivitiesFirstStrike",SecondStrike:"AccountStatusActivitiesSecondStrike",Ban:"AccountStatusActivitiesThirdStrike",Warning:"AccountStatusActivitiesWarning"},activityModerationErrorTypeHeaderStringKeyMap:{Takedown:"ProfileActivityModerationErrorTakedownHeader",Ban:"ProfileActivityModerationErrorPermanentBanHeader",NotAllowName:"ProfileActivityModerationErrorNotAllowNameHeader",NotAllowPicture:"ProfileActivityModerationErrorNotAllowPictureHeader",ApproveUserAppeal:"ProfileActivityModerationErrorApproveUserAppealHeader",ApproveCommentAppeal:"ProfileActivityModerationErrorApproveCommentAppealHeader",ApproveProfilePicAppeal:"ProfileActivityModerationErrorApproveProfilePicAppealHeader",RejectUserAppeal:"ProfileActivityModerationErrorRejectUserAppealHeader",RejectCommentAppeal:"ProfileActivityModerationErrorRejectCommentAppealHeader",RejectProfilePicAppeal:"ProfileActivityModerationErrorRejectProfilePicAppealHeader",Warning:"ProfileActivityModerationErrorWarningHeader",FirstStrike:"ProfileActivityModerationErrorStrikeHeader",SecondStrike:"ProfileActivityModerationErrorStrikeHeader"},activityModerationErrorTypeExpiredHeaderStringKeyMap:{Warning:"ProfileActivityModerationErrorWarningExpiredHeader",FirstStrike:"ProfileActivityModerationErrorStrikeExpiredHeader",SecondStrike:"ProfileActivityModerationErrorStrikeExpiredHeader"},userAgeGroup:{missing:"Undefined",under18:"Under18",above18:"Above18"},userSubType:{default:"Default",publisher:"Publisher",creator:"Creator",poster:"Poster"},activityType:{follow:"Follow",reply:"Reply",reaction:"Reaction",badge:"Achievement",moderation:"Moderation",commentDeleteAlert:"CommentDeleteAlert",profileBannedAlert:"ProfileBannedAlert",profileErrorAlert:"ProfileErrorAlert"},moderationErrorType:{takedown:"Takedown",ban:"Ban",notAllowName:"NotAllowName",notAllowPicture:"NotAllowPicture",approveUserAppeal:"ApproveUserAppeal",rejectUserAppeal:"RejectUserAppeal",approveProfilePicAppeal:"ApproveProfilePicAppeal",rejectProfilePicAppeal:"RejectProfilePicAppeal",approveCommentAppeal:"ApproveCommentAppeal",rejectCommentAppeal:"RejectCommentAppeal",warning:"Warning",firstStrike:"FirstStrike",secondStrike:"SecondStrike"},moderationTakedownReasonStringKeyMap:{"bullying-harassment":"ProfileActivityModerationTakedownReasonBullying",spam:"ProfileActivityModerationTakedownReasonSpam",violence:"ProfileActivityModerationTakedownReasonViolence",profanity:"ProfileActivityModerationTakedownReasonProfanity",abuse:"ProfileActivityModerationTakedownReasonAbuse","child-related":"ProfileActivityModerationTakedownReasonAbuse","misinformation-covid":"ProfileActivityModerationTakedownReasonMisinformation","misinformation-qanon":"ProfileActivityModerationTakedownReasonMisinformation",copyright:"ProfileActivityModerationTakedownReasonCopyright",danger:"ProfileActivityModerationTakedownReasonDanger","public-threats":"ProfileActivityModerationTakedownReasonPublicThreats",illegal:"ProfileActivityModerationTakedownReasonIllegal",terrorism:"ProfileActivityModerationTakedownReasonTerrorism",privacy:"ProfileActivityModerationTakedownReasonPrivacy",inappropriate:"ProfileActivityModerationTakedownReasonInappropriate","off-topic":"ProfileActivityModerationTakedownReasonOffTopic",impersonation:"ProfileActivityModerationTakedownReasonImpersonation","bullying-and-harassment":"ProfileActivityModerationTakedownReasonBullying","hate-speech":"ProfileActivityModerationTakedownReasonHateSpeech",suicide:"ProfileActivityModerationTakedownReasonSuicide","misinformation-us-2020":"ProfileActivityModerationTakedownReasonMisinformation","misinformation-brazil-election":"ProfileActivityModerationTakedownReasonMisinformation","misinformation-school-shooting":"ProfileActivityModerationTakedownReasonMisinformation","misinformation-russia-ukraine":"ProfileActivityModerationTakedownReasonMisinformation",trademark:"ProfileActivityModerationTakedownReasonTrademark"},moderationTakedownReasonGuidelinesListItems:{GuidelinesHarassmentPart:["GuidelinesPageGuidelinesTabAvoidPartText","GuidelinesPageGuidelinesTabAvoidPartHarassment","GuidelinesPageGuidelinesTabAvoidPartBullying"],GuidelinesRespectPart:["GuidelinesPageGuidelinesTabRespectPartText","GuidelinesPageGuidelinesTabRespectPartImpersonate","GuidelinesPageGuidelinesTabRespectPartRespectOthers","GuidelinesPageGuidelinesTabRespectPartNotShareContent"],GuidelinesAbusivePart:["GuidelinesPageGuidelinesTabReportPartText","GuidelinesPageGuidelinesTabReportPartViolent","GuidelinesPageGuidelinesTabReportPartIllegalAct","GuidelinesPageGuidelinesTabReportPartRiskTo","GuidelinesPageGuidelinesTabReportPartAbusiveText","GuidelinesPageGuidelinesTabReportPartHateSpeech"],GuidelinesDoNotPostPart:["GuidelinesPageGuidelinesTabFinalPartText","GuidelinesPageGuidelinesTabFinalPartCopywrited","GuidelinesPageGuidelinesTabFinalPartSpam"]},moderationTakedownReasonGuidelinesGroupings:{GuidelinesHarassmentPart:["ProfileActivityModerationTakedownReasonBullying"],GuidelinesRespectPart:["ProfileActivityModerationTakedownReasonMisinformation","ProfileActivityModerationTakedownReasonPrivacy","ProfileActivityModerationTakedownReasonImpersonation"],GuidelinesAbusivePart:["ProfileActivityModerationTakedownReasonViolence","ProfileActivityModerationTakedownReasonAbuse","ProfileActivityModerationTakedownReasonDanger","ProfileActivityModerationTakedownReasonPublicThreats","ProfileActivityModerationTakedownReasonChildRelated","ProfileActivityModerationTakedownReasonTerrorism","ProfileActivityModerationTakedownReasonHateSpeech","ProfileActivityModerationTakedownReasonSuicide","ProfileActivityModerationTakedownReasonIllegal","ProfileActivityModerationTakedownReasonProfanity"],GuidelinesDoNotPostPart:["ProfileActivityModerationTakedownReasonSpam","ProfileActivityModerationTakedownReasonCopyright","ProfileActivityModerationTakedownReasonTrademark"]},activityModerationErrorTypeStringKeyMap:{Takedown:"ProfileActivityModerationErrorTakedown",Ban:"ProfileActivityModerationErrorPermanentBan",NotAllowName:"ProfileActivityModerationErrorNotAllowName",NotAllowPicture:"ProfileActivityModerationErrorNotAllowPicture",ApproveUserAppeal:"ProfileActivityModerationErrorApproveUserAppeal",ApproveCommentAppeal:"ProfileActivityModerationErrorApproveCommentAppeal",ApproveProfilePicAppeal:"ProfileActivityModerationErrorApproveProfilePicAppeal",RejectUserAppeal:"ProfileActivityModerationErrorRejectUserAppeal",RejectCommentAppeal:"ProfileActivityModerationErrorRejectCommentAppeal",RejectProfilePicAppeal:"ProfileActivityModerationErrorRejectProfilePicAppeal",Warning:"ProfileActivityModerationErrorWarning",FirstStrike:"ProfileActivityModerationErrorFirstStrike",SecondStrike:"ProfileActivityModerationErrorSecondStrike"},visibleStatusType:{Normal:"Normal",DeletedByUser:"DeletedByUser",DeletedByAI:"DeletedByAI",DeletedByHI:"DeletedByHI",InReview:"InReview"},visibleStatusMap:{DeletedByUser:"VisibleStatusDeletedByUser",DeletedByAI:"VisibleStatusDeletedByAI",DeletedByHI:"VisibleStatusDeletedByHI",InReview:"VisibleStatusInReview",Default:"VisibleStatusOther"},reactionOrder:["like","love","surprised","thinking","sad","angry"],binaryReactionOrder:["upvote","downvote"],profileReportItemMap:{UserName:"ReportUserName",ProfilePicture:"ReportProfilePicture"},profilePageEmptyStates:{NoUser:"NoUser",NotSocialUser:"NotSocialUser"},reactionIconMap:{like:"EmojiLike",love:"EmojiHeart",thinking:"EmojiThinking",surprised:"EmojiSurprised",sad:"EmojiSad",angry:"EmojiAngry"},reactions:{like:"like",love:"love",thinking:"thinking",surprised:"surprised",sad:"sad",angry:"angry"},responsiveLevels:{L0:"cwtl-0",L1:"cwtl-1",L2:"cwtl-2",MobilePopup:"cwt-mobile-popup",articleOneBlock:"cwt-article-one-block"},newCommentErrorCodeMap:{400:"NewPostDeniedMsg",403:"NewPostSessionExpiredMsg",500:"NewPostWentWrongMsg",bodyTooLong:"NewPostTooLongMsg",other:"NewPostWentWrongMsg",0:"NewPostWentWrongMsg",1:"NewPostSessionExpiredMsg",4:"NewPostDeniedMsg",6:"NewPostWentWrongMsg",7:"NewPostWentWrongMsg",8:"NewPostWentWrongMsg",9:"NewPostWentWrongMsg",10:"NewPostWentWrongMsg",11:"NewPostWentWrongMsg",12:"NewPostTooManyCommentsMsg",20:"NewPostTooLongMsg",21:"NewPostMentionMsg",22:"NewPostWentWrongMsg",23:"NewPostWentWrongMsg",24:"NewPostDeniedMsg",25:"NewPostWentWrongMsg",26:"NewPostWentWrongMsg",27:"NewPostWentWrongMsg",28:"NewPostDeniedMsg",29:"NewPostDeniedMsg",30:"NewPostDeniedMsg",31:"NewPostDeniedMsg",32:{0:"NewPostDeniedMsg",1:"NewPostDeniedMsg",2:"NewPostDeniedMsg",3:"NewPostDeniedMsg",4:"NewPostDeniedMsg",5:"NewPostDeniedMsg",6:"NewPostDeniedMsg",7:"NewPostDeniedMsg",8:"NewPostDeniedMsg",9:"NewPostDeniedMsg",10:"NewPostDeniedMsg",11:"NewPostDeniedMsg",12:"NewPostDeniedMsg",13:"NewPostDeniedMsg",14:"NewPostDeniedMsg",15:"NewPostDeniedMsg",16:"NewPostDeniedMsg",17:"NewPostDeniedMsg",18:"NewPostDeniedMsg",19:"NewPostDeniedMsg",20:"NewPostDeniedMsg",21:"NewPostDeniedMsg",22:"NewPostDeniedMsg",23:"NewPostDeniedMsg",24:"NewPostDeniedMsg",25:"NewPostDeniedMsg",26:"NewPostDeniedMsg",27:"NewPostDeniedMsg",28:"NewPostDeniedMsg",29:"NewPostDeniedMsg",30:"NewPostDeniedMsg"}},newCommentErrorCodeMapDeletedByAiVersion1_1:{0:"NewCommentDeletedByAIReasonSpam",1:"NewCommentDeletedByAIReasonProfanity",2:"NewCommentDeletedByAIReasonAbuse",3:"NewCommentDeletedByAIReasonPrivacy",4:"",5:"",6:"",7:"NewCommentDeletedByAIReasonViolence",8:"",9:"NewCommentDeletedByAIReasonIllegal",10:"NewCommentDeletedByAIReasonTerrorismOrViolentExtremism",11:"NewCommentDeletedByAIReasonTerrorismOrViolentExtremism",12:"NewCommentDeletedByAIReasonCopyright",13:"",14:"",15:"",16:"NewCommentDeletedByAIReasonTrademark",17:"",18:"",19:"",20:"",21:"",22:"",23:"",24:"",25:"NewCommentDeletedByAIReasonMisinformation",26:"NewCommentDeletedByAIReasonHateSpeech",27:"NewCommentDeletedByAIReasonBullyingAndHarassment",28:"NewCommentDeletedByAIReasonSuicideAndSelfHarm",29:"",30:"",31:"",32:"NewCommentDeletedByAIReasonMisinformation",33:"",34:"",35:"NewCommentDeletedByAIReasonImpersonation"},commentsStatusType:{zero:0,minimal:1,expanded:2,notDetermined:3},theme:{default:{name:"default",disabledComponents:[]},superappBase:{name:"superapp",disabledComponents:[]},windowsBase:{name:"windows",disabledComponents:[]},superappEmbed:{name:"superapp-embed",modalComponents:["reactionbreakdowncomment","reactionbreakdowncontent","onboardingpage","onboardingthirdpartypage","onboardingunderagepage","reportmenu","profilereportmenu","copyrightform","trademarkform"],disabledComponents:["profilepage","guidelinepage","articlepage","multiloginpage","reactionbreakdowncomment","reactionbreakdowncontent","onboardingpage","onboardingthirdpartypage","onboardingunderagepage","reportmenu","profilereportmenu","copyrightform","trademarkform"]},superappFullpage:{name:"superapp-fullpage",modalComponents:["reactionbreakdowncomment","reactionbreakdowncontent","onboardingpage","onboardingthirdpartypage","onboardingunderagepage","reportmenu","profilereportmenu","copyrightform","trademarkform"],disabledComponents:["profilepage","guidelinepage","articlepage","multiloginpage","onboardingthirdpartypage"]},genericPopup:{name:"feed-popup",disabledComponents:[]}},profileVisitedLocalStorageKey:"self-profile-visited",profileMaskNameCoachMarkLocalStorageKey:"profile-mask-name-coach-mark",entryPointInfo:{article:"article",articleHeader:"articleHeader",articleRightRail:"articleRightRail",publisherProfile:"publisherProfile"},supportSourceForTelemetryInfo:{tipPromotionInArticle:"SocialTipPromotionInArticle",tipPromotion:"SocialTipPromotion",tipSelection:"SocialTipSelection"},moderationSourceOverrideVerticals:["finance","sports","weather"],staticPollStrings:{question:"Static_Poll_Question",answerInformative:"Static_Poll_Answer_Informative",answerInspiring:"Static_Poll_Answer_Inspiring",answerHelpful:"Static_Poll_Answer_Helpful",answerEntertaining:"Static_Poll_Answer_Entertaining"},entrypointContentType:{poll:"poll",commentPeek:"commentPeek",sentimentPicker:"sentimentPicker",post:"post",commentBox:"commentBox"},endorsementTypeMap:{0:"unknown",1:"insightful",2:"helpful",3:"relatable",4:"impressive",5:"important",6:"funny"}};function a(e){if("number"==typeof e)return e>=0&&e<=6?s.endorsementTypeMap[e]:void 0;if("string"==typeof e){const t=e.toLowerCase();return Object.values(s.endorsementTypeMap).includes(t)?t:void 0}}},72993:function(e,t,i){i.d(t,{G:function(){return f}});var n=i(17254),o=i(89980),r=i(67387),s=i(72725),a=i(33322),c=i(27261),l=i(98313);function d(e){return"User"===e.type}function u(e){return"Achievement"===e.type}function m(e){return"Reaction"===e.type}function p(e){return"Content"===e.type}function y(e){return"Comment"===e.type}function g(e){return"ModerationRecord"===e.type}const v=e=>null!=e;class f{static convertContent(e){var t;if(!e)return null;const i=s.v.binaryReactionOrder,n={};i.map(t=>{e&&(e.reactionSummary?n[t]=(e.reactionSummary.subReactionSummaries.find(e=>e.type.toLowerCase()==t)||{totalCount:0}).totalCount:n[t]=0)});let o=e.socialEndorsementSummary;if(null!==(t=e.socialEndorsementSummary)&&void 0!==t&&t.subSocialEndorsementSummaries){const t=e.socialEndorsementSummary.subSocialEndorsementSummaries.map(e=>{const t=(0,s.c)(e.type);return t&&"unknown"!==t?{type:t,totalCount:e.totalCount}:null}).filter(e=>null!==e);o={...e.socialEndorsementSummary,subSocialEndorsementSummaries:t}}const r=!e.cmsId&&e.id?e.id.replace(`_${e.market}`,""):e.id;return{comments:{skip:0,top:0,moreCount:0,list:[]},...e,socialEndorsementSummary:o,id:r,reactionStatus:e.reactionStatus?e.reactionStatus.toLowerCase():"on",commentStatus:e.commentStatus?e.commentStatus.toLowerCase():"on",pollStatus:e.pollStatus?e.pollStatus.toLowerCase():"on",totalCommentCount:e.commentSummary?e.commentSummary.totalCount:0,reactionCounts:n}}static convertUser(e){if(e){let t;t=e.isSocialUser?s.v.userStateType.existingUser:e.id&&!e.id.startsWith("m-")?s.v.userStateType.newUser:s.v.userStateType.anonymous;let i=e.nameStatus&&"Unknown"!==e.nameStatus?e.nameStatus:s.v.userNameStatusType.normal;return t!=s.v.userStateType.newUser||null!=e.primaryName&&""!==e.primaryName.trim()||(i=s.v.userNameStatusType.notAllow),"vid-ksdbkre0pxrdbnxqmr5xbyu056sdgdim5cna8urvbu45yi3x7jqs"==e.id&&(e.coverImageUrl=`${(0,n.rA)().StaticsUrl}/latest/community/img/premium-profile-promo-card/LA-cover-banner-image.png`),{...e,name:e.primaryName,avatarUrl:e.notUseAvatar||!e.primaryAvatar?void 0:e.primaryAvatar,likesCount:e.reactionSummary?e.reactionSummary.totalCount:0,postsCount:e.commentSummary?e.commentSummary.totalCount:0,followersCount:(e.followSummary&&e.followSummary.subFollowSummaries.find(e=>"FollowBy"==e.type)||{totalCount:0}).totalCount,followingCount:(e.followSummary&&e.followSummary.subFollowSummaries.find(e=>"Follow"==e.type)||{totalCount:0}).totalCount,reactionsCount:e.reactionSummary&&e.reactionSummary.totalCount||0,badge:"Commenter",state:t,avatarStatus:e.avatarStatus||s.v.userAvatarStatusType.normal,nameStatus:i,ageGroup:e.ageGroup||s.v.userAgeGroup.above18,banLevel:e.banLevel,isFollowing:e.isFollowedByMe}}return{state:s.v.userStateType.anonymous}}static convertUpdateUserNameResponse(e){return e?"Active"==e.state?"InReview":"Closed"==e.state&&"Approved"==e.reason?"Approved":"Rejected":"Rejected"}static convertUserList(e){return e?{skip:e.skip,top:e.top,hasMore:e.hasMore,moreCount:e.totalCount-(e.top+e.skip),totalCount:e.totalCount,list:e.items.map(e=>this.convertUser(e.links.length>0&&e.links.find(e=>"User"==e.type).item||null))}:null}static convertComment(e){if(!e)return null;let t=null,i=null;if(e.links){const n=e.links.find(t=>"User"==t.type&&t.item.id==e.createdBy);t=n?f.convertUser(n.item):null;const o=e.links.find(e=>"Content"==e.type);i=o?f.convertContent(o.item):null}const n=e.visibleStatus!=s.v.visibleStatusType.Normal,o=e.visibleStatus==s.v.visibleStatusType.InReview,r=[s.v.visibleStatusType.DeletedByAI,s.v.visibleStatusType.DeletedByHI,s.v.visibleStatusType.DeletedByUser].includes(e.visibleStatus),a={};return s.v.reactionOrder.map(t=>{e.reactionSummary?a[t]=(e.reactionSummary.subReactionSummaries.find(e=>e.type.toLowerCase()==t)||{totalCount:0}).totalCount:a[t]=0}),{...e,ownerId:e.createdBy,text:e.body,createDatetime:e.createdTime,reactionCounts:a,user:t,content:i,isHidden:n,isInReview:o,isDeleted:r,replies:[],replyCount:e.commentSummary?e.commentSummary.totalCount:0}}static convertCommentList(e){return e?{commentStatus:"On",skip:e.skip,top:e.top,hasMore:e.hasMore,hasPrevious:e.hasPrevious,asc:e.asc,orderby:e.orderby,moreCount:e.totalCount-(e.top-1+e.skip-1+2),totalCount:e.totalCount,list:e.items.map(e=>f.convertComment(e))}:null}static convertPost(e){return e&&e.postId?{...e}:null}static convertPostList(e){return e?e.map(e=>f.convertPost(e)):null}static convertReactionsResponseToReactionBreakdownData(e,t){if(!e)return null;const i=e.items;let n;try{n=e.links.find(e=>"Content"==e.type||"Comment"==e.type).item.reactionSummary.subReactionSummaries}catch(e){n=null}const o={reactionCounts:{all:0},items:{all:[]},content:null};if(s.v.reactionOrder.map(e=>{o.reactionCounts[e]=0,o.items[e]=[]}),n&&n.map(e=>{o.reactionCounts[e.type.toLowerCase()]=e.totalCount,o.reactionCounts.all+=e.totalCount}),i&&i.filter(e=>s.v.reactionOrder.includes(e.subType.toLowerCase())).map(e=>{const t=e.subType.toLowerCase(),i=e.links.find(e=>"User"==e.type)?e.links.find(e=>"User"==e.type).item:{state:s.v.userStateType.anonymous,primaryName:"You"};i.isFollowing=!!e.links.find(e=>"Follow"==e.type),o.items[e.subType.toLowerCase()].push({user:i,rateValue:t}),o.items.all.push({user:i,rateValue:t})}),e.links&&e.links.length>0){const t=e.links.filter(e=>"content"==e.type.toLowerCase());t.length>0&&(o.content=t[0].item)}return o}static convertRatingToRateValue(e){e&&e.items&&(e=e.items[0]);return e&&e.subType?e.subType.toLowerCase():null}static convertUserStrikeActivities(e){var t,i,n,o;return{Warning:null===(t=e.items.map(e=>e.links.find(g)).filter(v).find(e=>e.item.subType==s.v.accountModerationStatus.warning))||void 0===t?void 0:t.item.createdDateTime,FirstStrike:null===(i=e.items.map(e=>e.links.find(g)).filter(v).find(e=>e.item.subType==s.v.accountModerationStatus.firstStrike))||void 0===i?void 0:i.item.createdDateTime,SecondStrike:null===(n=e.items.map(e=>e.links.find(g)).filter(v).find(e=>e.item.subType==s.v.accountModerationStatus.secondStrike))||void 0===n?void 0:n.item.createdDateTime,Ban:null===(o=e.items.map(e=>e.links.find(g)).filter(v).find(e=>e.item.subType==s.v.accountModerationStatus.ban))||void 0===o?void 0:o.item.createdDateTime}}static convertUserActivities(e){if(!e)return null;const t=e.items.map(e=>{var t;const i=null===(t=e.links.find(g))||void 0===t?void 0:t.item;if(i)return"ApproveCommentAppeal"===i.subType?{targetId:i.targetId,createdDateTime:i.createdDateTime}:void 0}).filter(v),i=e.items.map(e=>{var t;const i=null===(t=e.links.find(g))||void 0===t?void 0:t.item;if(i)return"RejectCommentAppeal"===i.subType?{targetId:i.targetId,createdDateTime:i.createdDateTime}:void 0}).filter(v);return e.items.map(e=>{var o;const r=null===(o=e.links.find(g))||void 0===o?void 0:o.item;r&&("Takedown"===r.subType&&t.map(e=>{e.targetId.includes(r.targetId)&&(r.appealResult="approved",r.appealResponseDate=new Date(e.createdDateTime).toLocaleDateString(n.T3.CurrentMarket,{day:"2-digit",month:"long",year:"numeric"}))}),"Takedown"===r.subType&&i.map(e=>{e.targetId.includes(r.targetId)&&(r.appealResult="denied",r.appealResponseDate=new Date(e.createdDateTime).toLocaleDateString(n.T3.CurrentMarket,{day:"2-digit",month:"long",year:"numeric"}))}))}),{skip:e.skip,top:e.top,hasMore:e.hasMore,moreCount:e.totalCount-(e.top-1+e.skip-1+2),list:e.items.map(e=>this.convertUserActivity(e)).filter(v)}}static convertUserActivity(e){if(!e)return null;const t={id:e.id,type:e.type,datetime:e.createdDateTime,isSeen:e.read,notification:e.notification};switch(e.type){case s.v.activityType.follow:{const i=e.links.find(d);return i?{...t,user:this.convertUser(i.item)}:null}case s.v.activityType.badge:{const i=e.links.find(u);return{...t,badgeType:i?i.item.subType:void 0}}case s.v.activityType.reply:{const i=e.links.find(d),n=e.links.find(p),o=e.links.find(y);return i&&o?{...t,user:this.convertUser(i.item),target:{url:null==n?void 0:n.item.url,body:o.item.body,comment:this.convertComment(o.item)}}:null}case s.v.activityType.reaction:{const i=e.links.find(d),n=e.links.find(p),o=e.links.find(y),r=e.links.find(m),s=r&&"Comment"==r.item.targetType?this.convertSubReactionSummariesToReactionCounts(o&&o.item.reactionSummary&&o.item.reactionSummary.subReactionSummaries):this.convertSubReactionSummariesToReactionCounts(n&&n.item.reactionSummary&&n.item.reactionSummary.subReactionSummaries),a=r&&"Comment"==r.item.targetType?o&&o.item.body:n&&n.item.title;return i&&a?{...t,user:this.convertUser(i&&i.item),target:{url:n&&n.item.url,reactionCounts:s,body:a,comment:o&&this.convertComment(o.item)}}:null}case s.v.activityType.moderation:{const i=e.links.find(p),n=e.links.find(y),o=e.links.find(g),r=o?o.item.subType:void 0,a=o&&"Takedown"===o.item.subType&&o.item.reasons[0];return r?{...t,moderationErrorType:r,message:s.v.activityModerationErrorTypeStringKeyMap[r]||"",reason:a&&s.v.moderationTakedownReasonStringKeyMap[a]||"",appealResult:o&&o.item.appealResult,appealResponseDate:o&&o.item.appealResponseDate,target:n&&{url:i&&i.item.url,id:n.item.id,body:n.item.body,comment:n&&this.convertComment(n.item)}}:null}}return t}static convertSubReactionSummariesToReactionCounts(e){if(!e)return null;const t={all:0};return s.v.reactionOrder.map(e=>{t[e]=0}),e.map(e=>{t[e.type.toLowerCase()]=e.totalCount}),t}static mapFeedResponseToSocialBarData(e,t,i,n,o,r,a){const l=(0,c.$N)();if(l&&l.indexOf("reactionstest")>-1){try{n={totalCount:0,subCommentSummaries:[]},(i={totalCount:0,subReactionSummaries:[]}).totalCount=Math.floor(1e4*Math.random()),n.totalCount=Math.floor(1e4*Math.random());["angry","like","love","sad","surprised","thinking","upvote","downvote"].sort(()=>.5-Math.random()).slice(0,Math.floor(3*Math.random())).forEach(e=>i.subReactionSummaries.push({totalCount:Math.floor(10*Math.random()),type:e}))}catch{}if(n.totalCount>0)try{const e=[{id:"82ccfa9b-56ac-41ca-9546-9f3910ec3cec"},{id:"f21a5f91-a6a9-4e80-bb59-3839e296773f"},{id:"c400d1c0-2f0d-469f-986c-8bebe2de1060"},{id:"1be1cb2b-6210-43b4-b962-ce1df9b524d0"},{id:"4e19e02f-f6fc-405d-8f99-1f007ce7f5df"}],t=Math.floor(5*Math.random());o=e.slice(t,t+1)}catch{}}const d=i&&i.subReactionSummaries?i.subReactionSummaries:[],u=s.v.binaryReactionOrder,m={};u.map(e=>{m[e]=(e=>{if(Array.isArray(d)){const t=d.find(t=>t&&t.type&&"string"==typeof t.type&&t.type.toLowerCase()===e);return t?t.totalCount:0}})(e)});const p=!t&&f.getLocalContentReaction(e,a);p&&m[t=p]++;const y=!i,g=!n;return{id:e,reactionStatus:r&&r.reactionStatus?r.reactionStatus.toLowerCase():"on",commentStatus:r&&r.commentStatus?r.commentStatus.toLowerCase():"on",reactionsOptedOut:y,commentsOptedOut:g,reactionCounts:m,totalCommentsCount:n&&n.totalCount,myReaction:t&&t.toLowerCase(),topComments:o}}static getLocalContentReaction(e,t){if(t)return t(e);if((0,o.Lg)().supported){const t=(0,l.$K)();return(0,o.Lg)().getItem((0,l.ac)(t,e))}return null}static setLocalContentReaction(e){if((0,o.Lg)().supported){const t=(0,l.$K)();(0,o.Lg)().setItem((0,l.ac)(t,e),"upvote")}}static deleteLocalContentReaction(e){if((0,o.Lg)().supported){const t=(0,l.$K)();(0,o.Lg)().removeItem((0,l.ac)(t,e))}}static getLocalContentEndorsements(e,t){if(t)return t(e);if((0,o.Lg)().supported){const t=(0,l.$K)(),i=(0,o.Lg)().getItem((0,l.Z7)(t,e));if(i)return i.split(",").filter(e=>e.length>0)}return[]}static setLocalContentEndorsements(e,t){if((0,o.Lg)().supported){const i=(0,l.$K)();if(0===t.length)(0,o.Lg)().removeItem((0,l.Z7)(i,e));else{const n=t.map(e=>e.toLowerCase()).join(",");(0,o.Lg)().setItem((0,l.Z7)(i,e),n)}}}static deleteLocalContentEndorsements(e){if((0,o.Lg)().supported){const t=(0,l.$K)();(0,o.Lg)().removeItem((0,l.Z7)(t,e))}}static convertCommentToTopCommentData(e,t,i){return e&&e.user?{market:i,username:e.user.primaryName,avatarUrl:e.user.notUseAvatar||!e.user.primaryAvatar?void 0:e.user.primaryAvatar,profileUrl:(0,a.tQ)(`${s.v.externalUrls.profilePage}${e.user.id}`,i),commentUrl:(0,a.tQ)(t,i,e.id),commentBody:e.text,contentUrl:`${t}#comments`,replyCount:e.replyCount,reactionCounts:e.reactionCounts,reactionSummary:e&&e.reactionSummary,createDatetime:e.createDatetime,commentId:e.id}:null}static convertPublisherFeed(e){var t,i,n;if(null==e||!e.sections)return;const o=null==e||null===(t=e.sections[0])||void 0===t?void 0:t.cards;if(!o||o.length<1)return;const r=null===(i=o[0])||void 0===i?void 0:i.provider;return{items:null===(n=o[0])||void 0===n?void 0:n.subCards.map(e=>({...e,provider:r}))}}static convertTopCommentedToPublisherCarouselData(e,t){return e.filter(e=>{const i=t[e.cmsId];return i.imageResources&&i.imageResources.length>0||i.thumbnail}).map(e=>{const i=t[e.cmsId];let n;return n=i.imageResources&&i.imageResources.length>0?i.imageResources.map(e=>({width:e.width,height:e.height,url:e.url,attribution:e.attribution,title:e.title,quality:e.quality,focalRegion:e.focalRegion,source:e.source})):[{width:i.thumbnail.image.width,height:i.thumbnail.image.height,url:i.thumbnail.image.url,attribution:i.thumbnail.image.attribution,title:i.thumbnail.image.title,quality:i.thumbnail.image.quality,source:i.thumbnail.image.source}],{id:e.cmsId,type:"article",clickUrl:e.url,title:e.title,category:i.categories[0].product,readTimeMin:i.readTimeMin,reactionSummary:e.reactionSummary,images:n,publishedDateTime:e.createdTime,commentCount:e.commentSummary.totalCount,provider:{id:i.provider.id,name:i.provider.name,logoUrl:i.provider.logo.url,profileId:i.provider.publisherProfileId},subscriptionProductType:r.OS[i.subscriptionProductType],url:e.url,locale:i.locale}})}static convertMarketSettings(e){return{conversationTitles:e.conversationTitles,commentReportingTraits:e.reportingTraits.comment,postsReportingTraits:e.reportingTraits.posts,starRatingStatus:e.starRatingStatus,userNameReportingTraits:e.reportingTraits.userName,userPictureReportingTraits:e.reportingTraits.userPicture,pollStatus:e.pollStatus}}static convertTopics(e){if(!e)return;let t,i;try{t=e.Content?JSON.parse(e.Content):[]}catch(e){t=[]}try{i=e.ArticleTierTags?JSON.parse(e.ArticleTierTags):null}catch(e){i=null}return{title:e.Title,creationIdeaId:e.CreationIdeaId,content:t,imageUrl:e.ImageUrl,market:e.Market,rankPosition:e.RankPosition,score:e.Score,reason:e.Reason,articleTitle:e.ArticleTitle,articleUrl:e.ArticleUrl,articleTierTags:i}}static mapSocialEndorsementSummaryToEndorsements(e,t,i,n,o){const r={informative:{id:"informative",label:(null==n?void 0:n.informativeLabel)||"Informative",count:0,tooltip:(null==n?void 0:n.informativeTooltip)||"",alreadyEndorsedByUser:!1},insightful:{id:"insightful",label:(null==n?void 0:n.insightfulLabel)||"Insightful",count:0,tooltip:(null==n?void 0:n.insightfulTooltip)||"",alreadyEndorsedByUser:!1},relatable:{id:"relatable",label:(null==n?void 0:n.relatableLabel)||"Relatable",count:0,tooltip:(null==n?void 0:n.relatableTooltip)||"",alreadyEndorsedByUser:!1},inspiring:{id:"inspiring",label:(null==n?void 0:n.inspiringLabel)||"Inspiring",count:0,tooltip:(null==n?void 0:n.inspiringTooltip)||"",alreadyEndorsedByUser:!1},entertaining:{id:"entertaining",label:(null==n?void 0:n.entertainingLabel)||"Entertaining",count:0,tooltip:(null==n?void 0:n.entertainingTooltip)||"",alreadyEndorsedByUser:!1},impressive:{id:"impressive",label:(null==n?void 0:n.impressiveLabel)||"Impressive",count:0,tooltip:(null==n?void 0:n.impressiveTooltip)||"",alreadyEndorsedByUser:!1},important:{id:"important",label:(null==n?void 0:n.importantLabel)||"Important",count:0,tooltip:(null==n?void 0:n.importantTooltip)||"",alreadyEndorsedByUser:!1},helpful:{id:"helpful",label:(null==n?void 0:n.helpfulLabel)||"Helpful",count:0,tooltip:(null==n?void 0:n.helpfulTooltip)||"",alreadyEndorsedByUser:!1}};t&&(null!=t&&t.subSocialEndorsementSummaries&&t.subSocialEndorsementSummaries.forEach(e=>{const t=(0,s.c)(e.type);t&&"unknown"!==t&&r[t]&&(r[t].count=e.totalCount)}),i&&i.length>0&&i.forEach(e=>{const t=e.toLowerCase();r[t]&&(r[t].alreadyEndorsedByUser=!0)}));const a=f.getLocalContentEndorsements(e,o);if(a&&a.length>0){const e=new Set(a.map(e=>e.toLowerCase()));Object.keys(r).forEach(t=>{e.has(t)?r[t].alreadyEndorsedByUser||(r[t].alreadyEndorsedByUser=!0,r[t].count++):r[t].alreadyEndorsedByUser&&(r[t].alreadyEndorsedByUser=!1,r[t].count=Math.max(0,r[t].count-1))})}return Object.values(r)}}},88312:function(e,t,i){var n,o,r;i.d(t,{hr:function(){return o},sM:function(){return n}}),function(e){e.like="like",e.love="love",e.surprised="surprised",e.thinking="thinking",e.sad="sad",e.angry="angry",e.share="share"}(n||(n={})),function(e){e.upvote="upvote",e.downvote="downvote"}(o||(o={})),function(e){e.star1="star1",e.star2="star2",e.star3="star3",e.star4="star4",e.star5="star5"}(r||(r={}))},98313:function(e,t,i){i.d(t,{$K:function(){return l},GF:function(){return c},Tw:function(){return y},YA:function(){return p},Z:function(){return m},Z7:function(){return v},ac:function(){return g},dm:function(){return u}});var n=i(89980),o=i(17254),r=i(86948);const s=(0,n.Lg)(),a="community_latest_me_id";function c(e){e?s.setItem(a,e):e||d()}function l(){return s.getItem(a)}function d(){s.getItem(a)&&s.removeItem(a)}(0,r.Fo)()||d();const u="community_comment_pane_visited",m="myReactionIds",p="myReaction",y=e=>`myReactionIds_${e||o.T3.UserId}`,g=(e,t)=>`myReaction_${e||o.T3.UserId}_${t}`,v=(e,t)=>`myEndorsements_${e||o.T3.UserId}_${t}`}}]);