"use strict";(self.homePageWebpackChunks=self.homePageWebpackChunks||[]).push([["experiences_page-refresh-wc_dist_index_js"],{95698:function(e,t,i){i.r(t),i.d(t,{PageRefreshWC:function(){return f},PageRefreshWCStyles:function(){return b},PageRefreshWCTemplate:function(){return w},ToolingInfo:function(){return L}});var n,s,r=i(56911);!function(e){e.UserInitiated="uipr",e.AutoRefresh="auto",e.None="none"}(n||(n={})),function(e){e[e.Top=0]="Top",e[e.Bottom=1]="Bottom"}(s||(s={}));var h=i(60815),a=i(84855),o=i(11372),l=i(54030);class d{constructor(){this.renderTelemetryObject=(0,l.N)("UIPR_render",o.MS.Undefined,o.MJ.Module),this.refreshTelemetryObject=(0,l.N)("UIPR_button",o.MS.Navigate,o.MJ.ActionButton),this.closeTelemetryObject=(0,l.N)("UIPR_close",o.MS.Close,o.MJ.ActionButton)}}var p=i(21481);class f extends p.U{constructor(){super(...arguments),this.disableAutoRefresh=!1,this.autoRefreshTimerElapsed=!1,this.allowBlurRefresh=!1,this.refreshFrequencySeconds=120,this.pageRefreshType=void 0,this.outPageRefresh=this.pageRefresh.bind(this),this.resetRefreshTimeout=()=>{this.config.enableTimeReset&&"visible"===document.visibilityState&&this.refreshTimeOutFlag&&!this.disableAutoRefresh&&(window.clearTimeout(this.refreshTimeOutFlag),this.autoRefreshTimerElapsed=!1,this.startAutoRefresh())},this.showUiprBanner=()=>{window.setTimeout(()=>{this.showBanner&&this.showBanner(this.bannerId,s.Top)},this.getFrequencyMilliseconds(this.config.refreshFrequencySeconds))},this.startAutoRefresh=()=>{this.refreshTimeOutFlag=window.setTimeout(()=>{this.autoRefreshTimerElapsed=!0,this.RefreshIfQualified()},this.getFrequencyMilliseconds(this.config.refreshFrequencySeconds))},this.RefreshIfQualified=()=>{var e,t;null!==(e=location)&&void 0!==e&&e.search&&"true"===new URLSearchParams(location.search).get("noAR")||this.autoRefreshTimerElapsed&&(this.config.allowBlurRefresh||!this.config.allowBlurRefresh&&document.hasFocus())&&"visible"===document.visibilityState&&(window.location=this.updateQueryStringParameter(null===(t=window)||void 0===t||null===(t=t.location)||void 0===t?void 0:t.href,"AR"))},this.updateQueryStringParameter=(e,t)=>{const i=new RegExp("([?&])"+t+"=.*?(&|$)","i"),n=-1!==e.indexOf("?")?"&":"?";if(e.match(i)){const n=e.match(i)[0],s=n.substring(n.length-1,n.length),r=isNaN(parseInt(s))?1:parseInt(s)+1;return e.replace(i,"$1"+t+"="+r+"$2")}return e+n+t+"=1"}}experienceConnected(){this.pageRefreshWCTelemetry=new d,this.bannerId||(this.bannerId="PageRefreshWC"),this.config.allowBlurRefresh||window.addEventListener("focus",this.RefreshIfQualified),document.addEventListener("visibilitychange",this.RefreshIfQualified),this.config.useRouter&&window.addEventListener("nav-switch",this.outPageRefresh),this.pageRefresh(),document.addEventListener("click",this.resetRefreshTimeout),document.addEventListener("scroll",this.resetRefreshTimeout)}disconnectedCallback(){super.disconnectedCallback(),this.config.allowBlurRefresh||window.removeEventListener("focus",this.RefreshIfQualified),this.config.useRouter&&window.removeEventListener("nav-switch",this.outPageRefresh),document.removeEventListener("visibilitychange",this.RefreshIfQualified),document.removeEventListener("click",this.resetRefreshTimeout),document.removeEventListener("scroll",this.resetRefreshTimeout)}shadowDomPopulated(){this.config.disableMaxWidth||this.config.enableFiveColumn?this.config.enableFiveColumn&&!this.config.disableMaxWidth&&this.shadowRoot.host.classList.add("fifth-col"):this.shadowRoot.host.classList.add("limited-width")}getExperienceType(){return a.wcr}pageRefresh(e){const{id:t}=(null==e?void 0:e.detail)||{};t&&(this.disableAutoRefresh=t.includes("myInterests")),this.refreshTimeOutFlag&&(window.clearTimeout(this.refreshTimeOutFlag),this.autoRefreshTimerElapsed=!1),this.config.pageRefreshType===n.UserInitiated?this.showUiprBanner():this.config.pageRefreshType!==n.AutoRefresh||this.disableAutoRefresh||this.startAutoRefresh()}getFrequencyMilliseconds(e){return e?1e3*e:0}getRefreshUrl(){return location.href}dismissBannerClickHandler(){this.hideBanner&&this.hideBanner(this.bannerId)}}(0,r.Cg)([h.sH],f.prototype,"pageRefreshWCTelemetry",void 0),(0,r.Cg)([h.sH],f.prototype,"disableAutoRefresh",void 0);var c=i(96950);const g=c.qy`<svg class="refresh-svg-v2" xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="-1 -1 18 18" fill="white"><path stroke="white" d="M10.1328 0.296875C10.9974 0.53125 11.7891 0.898438 12.5078 1.39844C13.2266 1.89323 13.8438 2.48177 14.3594 3.16406C14.8802 3.84115 15.2839 4.59375 15.5703 5.42188C15.8568 6.24479 16 7.10417 16 8C16 8.73438 15.9036 9.44271 15.7109 10.125C15.5234 10.8073 15.2552 11.4453 14.9062 12.0391C14.5625 12.6328 14.1458 13.1745 13.6562 13.6641C13.1719 14.1484 12.6328 14.5651 12.0391 14.9141C11.4453 15.2578 10.8073 15.526 10.125 15.7188C9.44271 15.9062 8.73438 16 8 16C7.26562 16 6.55729 15.9062 5.875 15.7188C5.19271 15.526 4.55469 15.2578 3.96094 14.9141C3.36719 14.5651 2.82552 14.1484 2.33594 13.6641C1.85156 13.1745 1.4349 12.6328 1.08594 12.0391C0.742188 11.4453 0.473958 10.8099 0.28125 10.1328C0.09375 9.45052 0 8.73958 0 8C0 7.27083 0.0963542 6.5625 0.289062 5.875C0.481771 5.1875 0.755208 4.54167 1.10938 3.9375C1.46875 3.32812 1.90365 2.77604 2.41406 2.28125C2.92448 1.78125 3.5 1.35417 4.14062 1H2V0H6V4H5V1.67969C4.39062 1.97135 3.83854 2.33854 3.34375 2.78125C2.85417 3.21875 2.4349 3.71354 2.08594 4.26562C1.73698 4.8125 1.46875 5.40365 1.28125 6.03906C1.09375 6.67448 1 7.32812 1 8C1 8.64062 1.08333 9.26042 1.25 9.85938C1.41667 10.4531 1.65104 11.0104 1.95312 11.5312C2.26042 12.0469 2.6276 12.5182 3.05469 12.9453C3.48177 13.3724 3.95312 13.7396 4.46875 14.0469C4.98958 14.349 5.54688 14.5833 6.14062 14.75C6.73438 14.9167 7.35417 15 8 15C8.64062 15 9.25781 14.9167 9.85156 14.75C10.4505 14.5833 11.0078 14.349 11.5234 14.0469C12.0443 13.7396 12.5182 13.3724 12.9453 12.9453C13.3724 12.5182 13.737 12.0469 14.0391 11.5312C14.3464 11.0104 14.5833 10.4531 14.75 9.85938C14.9167 9.26562 15 8.64583 15 8C15 7.21875 14.8724 6.46615 14.6172 5.74219C14.3672 5.01823 14.0156 4.35938 13.5625 3.76562C13.1094 3.17188 12.5677 2.65885 11.9375 2.22656C11.3125 1.78906 10.6224 1.46615 9.86719 1.25781L10.1328 0.296875Z" /><path stroke="white" d="M10.1328 0.296875C10.9974 0.53125 11.7891 0.898438 12.5078 1.39844C13.2266 1.89323 13.8438 2.48177 14.3594 3.16406C14.8802 3.84115 15.2839 4.59375 15.5703 5.42188C15.8568 6.24479 16 7.10417 16 8C16 8.73438 15.9036 9.44271 15.7109 10.125C15.5234 10.8073 15.2552 11.4453 14.9062 12.0391C14.5625 12.6328 14.1458 13.1745 13.6562 13.6641C13.1719 14.1484 12.6328 14.5651 12.0391 14.9141C11.4453 15.2578 10.8073 15.526 10.125 15.7188C9.44271 15.9062 8.73438 16 8 16C7.26562 16 6.55729 15.9062 5.875 15.7188C5.19271 15.526 4.55469 15.2578 3.96094 14.9141C3.36719 14.5651 2.82552 14.1484 2.33594 13.6641C1.85156 13.1745 1.4349 12.6328 1.08594 12.0391C0.742188 11.4453 0.473958 10.8099 0.28125 10.1328C0.09375 9.45052 0 8.73958 0 8C0 7.27083 0.0963542 6.5625 0.289062 5.875C0.481771 5.1875 0.755208 4.54167 1.10938 3.9375C1.46875 3.32812 1.90365 2.77604 2.41406 2.28125C2.92448 1.78125 3.5 1.35417 4.14062 1H2V0H6V4H5V1.67969C4.39062 1.97135 3.83854 2.33854 3.34375 2.78125C2.85417 3.21875 2.4349 3.71354 2.08594 4.26562C1.73698 4.8125 1.46875 5.40365 1.28125 6.03906C1.09375 6.67448 1 7.32812 1 8C1 8.64062 1.08333 9.26042 1.25 9.85938C1.41667 10.4531 1.65104 11.0104 1.95312 11.5312C2.26042 12.0469 2.6276 12.5182 3.05469 12.9453C3.48177 13.3724 3.95312 13.7396 4.46875 14.0469C4.98958 14.349 5.54688 14.5833 6.14062 14.75C6.73438 14.9167 7.35417 15 8 15C8.64062 15 9.25781 14.9167 9.85156 14.75C10.4505 14.5833 11.0078 14.349 11.5234 14.0469C12.0443 13.7396 12.5182 13.3724 12.9453 12.9453C13.3724 12.5182 13.737 12.0469 14.0391 11.5312C14.3464 11.0104 14.5833 10.4531 14.75 9.85938C14.9167 9.26562 15 8.64583 15 8C15 7.21875 14.8724 6.46615 14.6172 5.74219C14.3672 5.01823 14.0156 4.35938 13.5625 3.76562C13.1094 3.17188 12.5677 2.65885 11.9375 2.22656C11.3125 1.78906 10.6224 1.46615 9.86719 1.25781L10.1328 0.296875Z" /></svg>`,C=c.qy`<svg class="close-svg" viewBox="0 0 12 12" xmlns="http://www.w3.org/2000/svg"><path d="M6.84961 6L12 11.1504L11.1504 12L6 6.84961L0.849609 12L0 11.1504L5.15039 6L0 0.849609L0.849609 0L6 5.15039L11.1504 0L12 0.849609L6.84961 6Z" /><path d="M6.84961 6L12 11.1504L11.1504 12L6 6.84961L0.849609 12L0 11.1504L5.15039 6L0 0.849609L0.849609 0L6 5.15039L11.1504 0L12 0.849609L6.84961 6Z" /></svg>`,w=c.qy`<div class="page-refresh-banner ${e=>e.config.enableFiveColumn?"fifth-col":""} ${e=>e.config.enableNTPFeedBreakpoint?"ntp-feed":""}" data-t="${e=>{var t;return null===(t=e.pageRefreshWCTelemetry)||void 0===t||null===(t=t.renderTelemetryObject)||void 0===t?void 0:t.getMetadataTag()}}"><a href="${e=>e.getRefreshUrl()}" data-t="${e=>{var t;return null===(t=e.pageRefreshWCTelemetry)||void 0===t||null===(t=t.refreshTelemetryObject)||void 0===t?void 0:t.getMetadataTag()}}"><div class="page-refresh-svg-wrapper"><span aria-label="${e=>e.strings.refreshButtonToolTipText}" title="${e=>e.strings.refreshButtonToolTipText}">${g}</span></div><span class="refresh-banner-text" aria-label="${e=>e.strings.refreshButtonToolTipText}" title="${e=>e.strings.refreshButtonToolTipText}">${e=>e.strings.bannerMessage}<span class="refresh-banner-text-underline" aria-label="${e=>e.strings.bannerRefreshActionText}" title="${e=>e.strings.bannerRefreshActionText}">${e=>e.strings.bannerRefreshActionText}</span></span><span role="button" class="page-refresh-button" aria-label="${e=>e.strings.refreshButtonText}" title="${e=>e.strings.refreshButtonToolTipText}">${e=>e.strings.refreshButtonText}</span></a><fluent-button class="page-refresh-close-button" aria-label="${e=>e.strings.dismissToolTipText}" role="button" title="${e=>e.strings.dismissToolTipText}" @click="${e=>e.dismissBannerClickHandler()}" data-t="${e=>{var t;return null===(t=e.pageRefreshWCTelemetry)||void 0===t||null===(t=t.closeTelemetryObject)||void 0===t?void 0:t.getMetadataTag()}}">${C}</fluent-button></div>`;var u=i(86856),x=i(74849);const v=x.A` .page-refresh-svg-wrapper{padding-right:initial}.refresh-banner-text{margin-left:20px;margin-right:intial}.banner-text-link{margin-left:3px;margin-right:initial}.page-refresh-button{right:40px}`,m=x.A` .page-refresh-svg-wrapper{padding-left:initial}.refresh-banner-text{margin-left:initial;margin-right:20px}.banner-text-link{margin-left:initial;margin-right:3px}.page-refresh-button{left:40px}`,b=x.A` :host{display:flex;justify-content:center;margin:0 auto;z-index:1000;height:43px;background:#1679c3}:host(.limited-width){max-width:1600px}@media (min-width:1325px){:host(.fifth-col){max-width:1600px}}@media (min-width:1800px){:host(.fifth-col){max-width:1922px}}a:visited{color:inherit}button{cursor:pointer}.page-refresh-banner{display:flex;flex-direction:row;align-items:center;justify-content:space-between;width:629px;height:43px;background-color:#1679c3;position:relative}.page-refresh-banner a{display:flex;flex-direction:row;align-items:center;height:100%;text-decoration:none}.page-refresh-banner a:first-child{width:calc(100% - 20px)}.page-refresh-banner fluent-button:last-child{width:15px}.refresh-banner-text{color:#fff;font-weight:700;max-height:16px;font-size:13px;margin-bottom:3px;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.refresh-banner-text-underline{text-decoration:underline;margin-left:3px}.page-refresh-button{background:#fff;color:#187bb9;font-size:13px;overflow:hidden;line-height:23px;white-space:nowrap;font-weight:600;padding:2px 10px;border:none;position:absolute}.page-refresh-button:hover{background-color:#0e5589;color:#98cff2}.page-refresh-close-button{border:none;width:55px;background-color:transparent}.close-svg{width:16px;height:16px;fill:#fff;vertical-align:middle}.close-svg path{stroke:white;stroke-width:0.5}.refresh-svg{width:25px;height:22px;transform:rotate(40deg);fill:#fff;margin-top:2px}.refresh-svg-v2{transform:scale(-1,1) rotate(65deg)}@media (min-width:995px){.page-refresh-banner{width:951px}}@media (min-width:956px){.page-refresh-banner.ntp-feed{width:900px}}@media (min-width:1325px){.page-refresh-banner{width:1272px}}@media (min-width:1268px){.page-refresh-banner.ntp-feed{width:1210px}}@media (min-width:1800px){.page-refresh-banner.fifth-col{width:1594px}}@media (min-width:1580px){.page-refresh-banner.ntp-feed{width:1530px}}`.withBehaviors(new u.t(v,m)),L={experienceConfigSchema:undefined}}}]);