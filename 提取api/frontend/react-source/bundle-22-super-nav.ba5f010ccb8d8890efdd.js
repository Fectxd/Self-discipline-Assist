(self.homePageWebpackChunks=self.homePageWebpackChunks||[]).push([["super-nav"],{12428:function(t){t.exports='<svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M2 4.5c0-.28.22-.5.5-.5h15a.5.5 0 010 1h-15a.5.5 0 01-.5-.5zm0 5c0-.28.22-.5.5-.5h15a.5.5 0 010 1h-15a.5.5 0 01-.5-.5zm.5 4.5a.5.5 0 000 1h15a.5.5 0 000-1h-15z"></path></svg>'},15749:function(t,e,i){"use strict";i.r(e),i.d(e,{SuperNav:function(){return ae},SuperNavDefaultTemplate:function(){return mi},SuperNavStyles:function(){return ni},SuperNavTemplate:function(){return wi},ToolingInfo:function(){return bi}});var n=i(44767),s=i(37180),o=i(56911),r=i(92011),a=i(22870),l=i(60815),d=i(38493),h=i(28611),c=i(95239),u=i(5291),v=i(77246),g=i(70177);class p extends r.L{constructor(){super(...arguments),this.activeId="myFeed",this.forceFixedHeight=!1,this.scrollableOverflowMenu=!1,this.overflowMenuMaxHeight=400,this.isOverflowing=!1,this.localizedStrings={},this.navItems=[],this.homenavItems=[],this.overflowDropDownAbove=!1,this.i=new Set,this.overflowItems=[],this.refDefaultNavChildren=[],this.refHomeNavChildren=[],this.showMenu=!1,this.msnBrandingLogo=!1,this.o=-1,this.h=()=>{var t;this.$&&this.$.removeEventListener("change",this.h),this.$=window.matchMedia("(prefers-color-scheme:dark)"),this.I((null===(t=this.$)||void 0===t?void 0:t.matches)?"#242424":"#f7f7f7"),this.$.addEventListener("change",this.h)},this.F=t=>{this.$emit("change",{selectedNavId:t.id})},this.C=t=>{if(t.target instanceof p)return;const e=t.composedPath();e&&e[0]===this.refNavOverflow||this._()},this.B=t=>{var e;let i=[];this._();for(const e of t){const t=this.navItems.find(t=>{var i;return t.id===(null===(i=e.target.firstElementChild)||void 0===i?void 0:i.id)});t&&(!e.isIntersecting||e.intersectionRatio<.9?(t.isOverflow=!0,this.i.add(t.id),e.target.classList.contains("hidden-visible")||e.target.classList.add("hidden-visible")):(t.isOverflow=!1,this.i.delete(t.id),e.target.classList.contains("hidden-visible")&&e.target.classList.remove("hidden-visible")))}const n=[...this.refHomeNavChildren,...this.refDefaultNavChildren];for(const t of n)if(this.i.has(null===(e=t.firstElementChild)||void 0===e?void 0:e.id)){const e=this.navItems.findIndex(e=>{var i;return e.id===(null===(i=t.firstElementChild)||void 0===i?void 0:i.id)});if(e>=0){i=this.navItems.slice(e,this.navItems.length);break}}this.overflowItems=i,this.isOverflowing=this.overflowItems.length>0},this.H=t=>{const{code:e}=t;"Escape"!==e?!this.showMenu||"ArrowUp"!==e&&"ArrowDown"!==e||(t.preventDefault(),this.R("ArrowDown"===e)):this._()},this.j=(t,e)=>{t!==h.xV.navOverflow&&e&&this._()},this.onNavItemClick=t=>{this.F(t),this._()},this.onNavItemKeyPress=(t,e)=>{const{code:i}=t;"Enter"!==i&&"Space"!==i||(this.onNavItemClick(e),t.preventDefault())},this.toggleOverflowMenu=t=>{!0===this.showMenu?this._():this.J()}}connectedCallback(){super.connectedCallback(),(0,g._Z)(this).then(()=>{var t,e,i,n,s;const o=null===(e=null===(t=this.shadowRoot)||void 0===t?void 0:t.getElementById)||void 0===e?void 0:e.call(t,"overflow-menu-button"),r=null===(n=null===(i=null==o?void 0:o.shadowRoot)||void 0===i?void 0:i.querySelector)||void 0===n?void 0:n.call(i,"button");r&&r.setAttribute("title",(null===(s=this.localizedStrings)||void 0===s?void 0:s.overflowButtonTooltip)||"")})}disconnectedCallback(){super.disconnectedCallback(),this.$&&this.$.removeEventListener("change",this.h)}isItemInHomeAndNotOverflow(t){var e,i;return(null===(e=this.homenavItems)||void 0===e?void 0:e.includes(t.id))&&!(null===(i=this.overflowItems)||void 0===i?void 0:i.includes(t))}navItemsChanged(t,e){this.tt(t,e)}refHomeNavChildrenChanged(t,e){this.refHomeNavChildren.length<=0||this.et(t,e)}refDefaultNavChildrenChanged(t,e){this.refDefaultNavChildren.length<=0||this.et(t,e)}et(t,e){if(e&&(0,v.S)()&&(this.it||(this.it=new IntersectionObserver(this.B,{root:this.refNavContainer,threshold:[.8,1]})),this.it)){for(const e of t)this.it.unobserve(e);for(const t of e)this.it.observe(t)}}refNavOverflowChanged(t,e){e&&this.refNavOverflow&&this.h()}_(){!1!==this.showMenu&&(this.showMenu=!1,this.o=-1,(0,h.YJ)(h.xV.navOverflow,!1),document.removeEventListener("click",this.C),document.removeEventListener("keydown",this.H),(0,h.Cq)(this.j))}tt(t,e){if(e&&e.length&&(e.forEach((t,e)=>{t.id=t.id||`nav-${e}`}),t&&t.length&&this.activeId)){const t=this.refNavContainer.querySelector(`#${this.activeId}`);t&&t.focus()}}R(t){if(!(0,v.S)()||!this.refNavOverflow)return;const e=this.refNavOverflow.querySelectorAll("li a");if(0===e.length)return;let i;i=-1===this.o?0:t?(this.o+1)%e.length:0===this.o?e.length-1:this.o-1,this.o=i,window.setTimeout(()=>{e[i]&&e[i].focus()},0)}J(){var t;const e=36*this.overflowItems.length||0,i=(null===(t=this.refNavContainer)||void 0===t?void 0:t.getBoundingClientRect().top)||0;let n=i-e>=0;const s=e<window.innerHeight-i;if(this.seeMoreNavItem)if(this.scrollableOverflowMenu=!1,n||s)this.forceFixedHeight=!1;else{n=i-400>=0,this.seeMoreNavItem&&this.overflowItems.length>10&&"seeMore"!==this.overflowItems[this.overflowItems.length-1].id&&(this.overflowItems.splice(9,this.overflowItems.length-10),this.overflowItems.push(this.seeMoreNavItem)),this.overflowItems,this.forceFixedHeight=!0}else this.forceFixedHeight=!1,n||s?this.scrollableOverflowMenu=!1:(n=window.innerHeight-i-80<i,this.overflowMenuMaxHeight=n?Math.floor(i-12):Math.floor(window.innerHeight-i-80),this.scrollableOverflowMenu=!0);this.overflowDropDownAbove=n,this.showMenu=!0,(0,h.YJ)(h.xV.navOverflow,!0),window.requestAnimationFrame(()=>{document.addEventListener("click",this.C),document.addEventListener("keydown",this.H),(0,h.vs)(this.j)})}I(t){(0,v.S)()&&this.refNavOverflow&&c.p.setValueFor(this.refNavOverflow,u.q.from((0,a.Hs)(t)))}}(0,o.Cg)([l.sH],p.prototype,"activeId",void 0),(0,o.Cg)([l.sH],p.prototype,"forceFixedHeight",void 0),(0,o.Cg)([l.sH],p.prototype,"scrollableOverflowMenu",void 0),(0,o.Cg)([l.sH],p.prototype,"overflowMenuMaxHeight",void 0),(0,o.Cg)([l.sH],p.prototype,"isOverflowing",void 0),(0,o.Cg)([l.sH],p.prototype,"localizedStrings",void 0),(0,o.Cg)([l.sH],p.prototype,"navItems",void 0),(0,o.Cg)([l.sH],p.prototype,"homenavItems",void 0),(0,o.Cg)([l.sH],p.prototype,"overflowDropDownAbove",void 0),(0,o.Cg)([l.sH],p.prototype,"overflowItems",void 0),(0,o.Cg)([l.sH],p.prototype,"overflowTelemetryTag",void 0),(0,o.Cg)([l.sH],p.prototype,"refNavContainer",void 0),(0,o.Cg)([l.sH],p.prototype,"refDefaultNavChildren",void 0),(0,o.Cg)([l.sH],p.prototype,"refHomeNavChildren",void 0),(0,o.Cg)([l.sH],p.prototype,"refNavOverflow",void 0),(0,o.Cg)([l.sH],p.prototype,"seeMoreNavItem",void 0),(0,o.Cg)([l.sH],p.prototype,"showMenu",void 0),(0,o.Cg)([l.sH],p.prototype,"showFullPageBlur",void 0),(0,o.Cg)([l.sH],p.prototype,"msnBrandingLogo",void 0),(0,o.Cg)([l.sH],p.prototype,"msnBrandingLogoHref",void 0),(0,o.Cg)([l.sH],p.prototype,"msnBrandingLogoTelemetryTag",void 0),(0,o.Cg)([(0,d.CF)({attribute:"no-active-color",mode:"boolean"})],p.prototype,"noActiveColor",void 0);var f=i(74849),m=i(22131),w=i(26920),b=i(57416),$=i(48751),x=i(7896),y=i(41123),k=i(36452),I=i(14996),F=i(37998),C=i(10735),N=i(73477),S=i(50882);const D="#69A1FA",M="#2169EB",_="#69A1FA",L="#2169EB",z="#FFFFFF1A",B="#FFFFFFE6",T="#FFFFFF1A",H="#D1D1D1";var E=i(17254);const P=f.A`
:host{--homeItem-list-background:${z};
    --homeItem-list-border-color: ${T};
    --horizontalnav-active-text: ${D};
    --horizontalnav-highlight-text: ${_};
    --msn-branding-logo-color: #f5f5f5;
    --msn-alt-logo: url(${(0,E.rA)().StaticsUrl}latest/brand/new-msn-logo-color-white.svg);
}
`,A=f.A` :host{display:flex;--msn-alt-logo:url(${(0,E.rA)().StaticsUrl}latest/brand/new-msn-logo-color-black.svg);
        --butterfly-logo: url(${(0,E.rA)().StaticsUrl}latest/icons-wc/icons/MSNButterfly.svg);--msn-branding-logo-color:#262626}.ms-rebrand-logo{display:flex;align-items:center;margin-inline-end:12px}.MSNButterflyLogo{background-color:var(--msn-branding-logo-color);height:20px;width:20px;display:block;mask:var(--butterfly-logo) center no-repeat;-webkit-mask:var(--butterfly-logo) center no-repeat}.ms-rebrand{width:68px;height:24px;background:var(--msn-alt-logo) no-repeat center;margin-bottom:9px;background-size:contain}.logo-text{margin:-3px 0px 0px 0px;color:var(--msn-branding-logo-color)}.navItem::-moz-focus-inner{border:0}.navItem{align-items:center;border:calc(${w.vd} * 1px) solid transparent;
        border-radius: calc(${b.Pb} * 1px);
        border-bottom: 2px solid transparent;
        box-sizing: border-box;
        margin-bottom: 2px;
        color: ${$.l};
        cursor: pointer;
        fill: ${$.l};
        font-family: ${x.O};
        font-size: ${y.K};
        justify-content: center;
        line-height: ${y.Z};outline:none;text-decoration:none;white-space:nowrap}.navItem.highlight{color:var(--horizontalnav-highlight-text,${L});
        fill: ${$.l}}:host(:not([no-active-color])) .navItem.active{color:var(--horizontalnav-active-text,${M});
        fill: ${$.l};font-weight:600}.navItem:hover,.navItem:active{border-bottom-color:transparent;color:${k.mb};
    }
    .navItem:${N.N}{border-bottom-color:${I.WN}}.navItem::-moz-focus-inner{border:0}.navContainer{display:flex;height:auto;margin:0px;margin-inline-end:2px;overflow:hidden;padding-inline:0px}.defaultItemList{height:auto;margin:0px;overflow:hidden;padding-inline:0px}.hidden{display:none !important}.navContainer .hidden-visible,.invisible{visibility:hidden}.homeItemList{background:var(--homeItem-list-background,${B});
        border: 1px solid;
        border-color: var(--homeItem-list-border-color,${H});border-radius:12px;height:34px;margin:0px;margin-inline-end:10px;overflow:visible}.homeItemList.blurbg{background-color:var(--homeItem-list-background,rgba(255,255,255,0.6))}li{display:flex;list-style:none;padding:0 10px}.list{align-items:center;display:inline-flex;padding-inline:0px}.overflowContainer{height:32px;margin:auto 0px;position:relative;width:32px}.overflowContainer fluent-button svg{vertical-align:middle}fluent-menu li{margin:0 0 0 5px;padding:5px 0}.overflowButton{margin:auto 0px;--neutral-fill-stealth-rest:transparent}.overflowFixedHeight{max-height:400px}.overflowMenu{--elevation:11;${F.ET}
        background: ${C.T};
        border-radius: ${b.JU};
        border: calc(${w.XA} * 1px) solid transparent;inset-inline-end:0;margin:0px;max-width:368px;min-width:100px;padding:0px;position:absolute;z-index:100}.overflowMenu.scrollable{overflow-y:scroll;overflow-x:hidden;max-height:400px}.overflowMenu .pipe:after{display:none}.overflowUp{bottom:33px}.pipe::after{align-self:center;border-inline-end:1px solid #cecece;content:"";height:14px;padding-inline-start:18px}`.withBehaviors((0,m.mr)(f.A` .navItem{border:${S.A.ButtonFace};
                color: ${S.A.LinkText};fill:currentColor}:host(:not([no-active-color])) .navItem.active{border-bottom:2px solid ${S.A.LinkText};
                color: ${S.A.LinkText};fill:currentColor;border-radius:0px}.navItem.highlighted{color:${S.A.LinkText};fill:currentColor}.navItem:focus-visible{border-bottom:2px solid var(--focus-stroke-outer);border-radius:0px}`),(0,m.G2)(P));var O=i(96950),U=i(91640),R=i(60402),W=i(39957),j=i(416),V=i(10108),q=i(16352),G=i.n(q);const Y="overflow-menu-button",J=O.qy`<li class=" ${t=>t.isOverflow?"hidden-visible":""}" part="list-item"><a id="${t=>t.id}" class="navItem ${(t,e)=>t.id===e.parent.activeId?"active":""} ${t=>t.highlighted?"highlight":""} ${(t,e)=>e.parent.showFullPageBlur?"blurbg":""}" href="${t=>t.href}" role=${t=>t.href?void 0:"link"} tabindex="0" aria-current="${(t,e)=>t.id===(e.parent.activeId?"page":"false")}" data-t="${t=>t.telemetryMetadata}" data-position-override="${t=>t.positionOverride}" @click="${(t,e)=>e.parent.onNavItemClick(t)}" @keypress="${(t,e)=>e.parent.onNavItemKeyPress(e.event,t)}">${(0,U.z)(t=>t.glyph,O.qy`<span class="horizontal-glyph">${t=>t.glyph&&O.qy`${O.qy.partial(t.glyph)}`}</span>`)} ${t=>t.display}</a></li>`,K=O.qy`<div :className=${t=>t.isOverflowing?"overflowContainer":"overflowContainer invisible"}><fluent-button @click=${(t,e)=>t.toggleOverflowMenu(e.event)} appearance="stealth" aria-expanded="${t=>t.showMenu?"true":null}" aria-haspopup="true" aria-label="${t=>t.localizedStrings.overflowButtonTooltip||null}" class="overflowButton" data-t="${t=>t.overflowTelemetryTag}" icon-only="true" id="${Y}" title="${t=>t.localizedStrings.overflowButtonTooltip||null}">${O.qy.partial(G())}</fluent-button>${(0,U.z)(t=>t.showMenu,O.qy`<fluent-menu :className="overflowMenu ${t=>t.overflowDropDownAbove?"overflowUp":""} ${t=>t.forceFixedHeight?"overflowFixedHeight":""} ${t=>t.scrollableOverflowMenu?"scrollable":""}" style="${t=>t.scrollableOverflowMenu?`max-height: ${t.overflowMenuMaxHeight}px;`:""}" ${(0,R.K)("refNavOverflow")} aria-labelledby="${Y}" id="overflowMenu">${(0,W.ux)(t=>t.overflowItems,J)}</fluent-menu>`)}</div>`,Q=O.qy`<a aria-label="MSN" title="MSN" class="ms-rebrand-logo" data-t="${t=>t.msnBrandingLogoTelemetryTag}" href=${t=>t.msnBrandingLogoHref||""} target="_blank" role="link"><span class="ms-rebrand"></span></a>`,X=O.qy`<template role="navigation">${(0,U.z)(t=>t.msnBrandingLogo,Q)}<span ${(0,R.K)("refNavContainer")} class="navContainer"><ul ${(0,j.Y)({property:"refHomeNavChildren",filter:(0,V.Y)("li")})} class="list homeItemList ${t=>t.showFullPageBlur?"blurbg":""}" part="homeNavList" id="homeNavList">${(0,W.ux)(t=>t.navItems.filter(e=>t.isItemInHomeAndNotOverflow(e)),J)}</ul><ul ${(0,j.Y)({property:"refDefaultNavChildren",selector:"li"})} class="list defaultItemList" part="navList" id="navList">${(0,W.ux)(t=>t.navItems.filter(e=>!t.isItemInHomeAndNotOverflow(e)),J)}</ul></span>${K}</template>`;n.m.define(s.c.registry);const Z=p.compose({name:"cs-super-nav-horizontal",template:X,styles:A,shadowOptions:{delegatesFocus:!0}});var tt=i(12938),et=i(96600);var it=i(55230),nt=i(23429),st=i(84471),ot=i(98216),rt=i(89710);class at extends r.L{constructor(){super(...arguments),this.closeButtonTelemetryTag="",this.closeButtonTooltip="",this.nt=[],this.forceOpenMenu=!1,this.hamburgerMenuButtonTelemetryTag="",this.st=!1,this.isMenuVisible=!1,this.menuButtonTooltip="",this.navItems=[],this.selectedNavId="",this.useMobileStyles=!1,this.verticalNavTelemetryTag="",this.handleDocumentKeydown=t=>{t.defaultPrevented||"Escape"!==t.code||this.closeMenu()},this.onMenuFocusout=t=>{this.menuRef.contains(t.relatedTarget)||this.closeMenu()},this.ot=t=>{const e=t.target&&t.target.getAttribute("class");e&&e.includes("overlay")&&this.closeMenu()},this.onSelectedChange=t=>{if(t.stopPropagation(),!t.target||!this.nt.length)return;if(!(0,st.W)(t.target))return;if(!t.target.selected||!t.target.id)return;const e=t.target.id;if("myInterests"==e&&(ot.YT.addOrUpdateTmplProperty("ChannelStoreLaunched","1"),(0,rt.wl)(E.T3.CurrentMarket)))return window.dispatchEvent(new CustomEvent("launchChannelStore")),void this.closeMenu();const i=this.nt.find(t=>t.id===e);i&&(this.$emit("change",{selectedNavId:i.id}),this.selectedNavId=e,this.closeMenu())},this.handleClick=t=>{if(!(t.target instanceof Element&&(0,st.W)(t.target)&&t.target.selected))return!0;t.preventDefault()},this.handleKeyDown=t=>t.key!==it.Mm||this.handleClick(t)}connectedCallback(){super.connectedCallback(),(0,g._Z)(this).then(()=>{var t,e;if(this.menuButton){const i=null===(e=null===(t=this.menuButton.shadowRoot)||void 0===t?void 0:t.querySelector)||void 0===e?void 0:e.call(t,"button");i&&i.setAttribute("title",this.menuButtonTooltip)}})}disconnectedCallback(){super.disconnectedCallback()}navItemsChanged(t,e){e&&(this.nt=[...e])}closeMenu(){this.isMenuVisible=!1,(0,h.YJ)(h.xV.hamburgerMenu,!1),this.menuOverlay&&this.menuOverlay.removeEventListener("click",this.ot),this.menuButton&&this.menuButton.focus(),document.removeEventListener("keydown",this.handleDocumentKeydown)}openMenu(){this.isMenuVisible=!0,this.st||(this.st=!0,ot.YT.addOrUpdateTmplProperty("HamburgerMenuShown","1")),(0,h.YJ)(h.xV.hamburgerMenu,!0),document.addEventListener("keydown",this.handleDocumentKeydown),nt.L.enqueue(()=>{this.closeButton&&this.closeButton.focus(),this.menuOverlay&&this.menuOverlay.addEventListener("click",this.ot)})}}(0,o.Cg)([l.sH],at.prototype,"closeButtonTelemetryTag",void 0),(0,o.Cg)([(0,d.CF)({attribute:"close-button-tooltip"})],at.prototype,"closeButtonTooltip",void 0),(0,o.Cg)([(0,d.CF)({mode:"boolean"})],at.prototype,"forceOpenMenu",void 0),(0,o.Cg)([l.sH],at.prototype,"hamburgerMenuButtonTelemetryTag",void 0),(0,o.Cg)([l.sH],at.prototype,"isMenuVisible",void 0),(0,o.Cg)([l.sH],at.prototype,"menuButton",void 0),(0,o.Cg)([(0,d.CF)({attribute:"menu-button-tooltip"})],at.prototype,"menuButtonTooltip",void 0),(0,o.Cg)([l.sH],at.prototype,"menuOverlay",void 0),(0,o.Cg)([l.sH],at.prototype,"menuRef",void 0),(0,o.Cg)([l.sH],at.prototype,"navItems",void 0),(0,o.Cg)([l.sH],at.prototype,"selectedNavId",void 0),(0,o.Cg)([l.sH],at.prototype,"treeView",void 0),(0,o.Cg)([(0,d.CF)({attribute:"use-mobile-styles",mode:"boolean"})],at.prototype,"useMobileStyles",void 0),(0,o.Cg)([(0,d.CF)({attribute:"no-active-color",mode:"boolean"})],at.prototype,"noActiveColor",void 0),(0,o.Cg)([l.sH],at.prototype,"verticalNavTelemetryTag",void 0);var lt=i(64187),dt=i(45476),ht=i(48196),ct=i(74838),ut=i(89580);const vt=f.A`
    ${(0,lt.V)("flex")} :host{--elevation:11;margin-inline-end:10px;width:fit-content;--start-logo-light:url(${(0,E.rA)().StaticsUrl}latest/brand/new-msn-logo-color-black.svg);
        --start-logo-dark: url(${(0,E.rA)().StaticsUrl}latest/brand/new-msn-logo-color-white.svg)}:host .display{height:21px;pointer-events:none}.button-glyph{fill:${$.l};height:16px;width:16px}.close-button{align-items:center;background:${C.T};display:flex;justify-content:center;justify-self:end}.close-button:hover{background:${dt.oO}}fluent-button{height:calc(${ht.D} * 1px);
        width: calc(${ht.D} * 1px)}.hidden{display:none}.logo{margin-inline-start:24px;width:80px;height:30px;background-size:contain;background:var(--start-logo-light) no-repeat center}.menu{${F.ET}
        background: ${C.T};display:flex;flex-direction:column;height:100%;min-width:300px;top:0;width:fit-content}.menu-button{--neutral-fill-stealth-rest:transparent;align-items:center;justify-content:center}.menu-content{align-self:flex-start;overflow-y:auto;width:100%}.menu-header{align-items:center;display:grid;grid-template-columns:auto auto;justify-content:stretch;padding:20px}.mobile{justify-content:flex-end}.overlay{align-items:flex-start;background-color:transparent;display:flex;flex-direction:row;height:100%;left:0;position:fixed;right:0;top:0;width:100%;z-index:600}.separator{margin:calc(${ct.vR} * 1px) 24px}.tree-view[hidden]{display:none}.tree-view{align-items:stretch;flex-direction:column;font-size:0;min-width:fit-content}.tree-view:focus-visible{outline:none}fluent-tree-item{background:${C.T}}fluent-tree-item::part(content-region){display:flex;font-size:${ut.Y};
        font-weight: 400;
        line-height: ${ut.v};margin-inline-start:42px;margin-inline-end:20px;white-space:nowrap}fluent-tree-item::part(positioning-region){align-items:center;height:50px}fluent-tree-item[selected]::after{height:25px;top:12px;width:3px}:host([no-active-color]) fluent-tree-item::part(positioning-region){background:${dt.Wl}}:host([no-active-color]) fluent-tree-item[selected]::after{content:none}fluent-tree-item [slot="start"]{display:block;fill:${$.l};
        margin-inline-end: calc(${ct.vR} * 2px + 2px);
        height: 18px;
        pointer-events: none;
    }

`.withBehaviors((0,m.mr)(f.A` .button-glyph{fill:${S.A.ButtonText}}.menu-button:hover .button-glyph,.menu-button:focus .button-glyph,.close-button:hover .button-glyph,.close-button:focus .button-glyph{fill:${S.A.HighlightText};
                }
            `),(0,m.G2)(f.A` .separator{border-top-color:rgba(255,255,255,0.08)}.logo{margin-inline-start:24px;background:var(--start-logo-dark) no-repeat center}`));var gt=i(32625),pt=i(2202),ft=i.n(pt),mt=i(12428),wt=i.n(mt),bt=i(62292);const $t=O.qy`<fluent-tree-item :selected="${(t,e)=>t.id===e.parent.selectedNavId}" data-t="${t=>t.telemetryMetadata}" id=${t=>t.id}><div class="display">${t=>t.display}</div>${(0,U.z)(t=>t.glyph,O.qy`<div :innerHTML=${(0,gt.a)(t=>t.glyph||"",bt.k)} slot="start"></div>`)}</fluent-tree-item>${(0,U.z)(t=>t.showDivider,O.qy`<fluent-divider class="separator" role="presentation"></fluent-divider>`)}
`,xt=O.qy`<div class="menu-header"><slot name="logo"><span class="logo"></span></slot><fluent-button @click="${t=>t.closeMenu()}" ${(0,R.K)("closeButton")} appearance="stealth" aria-label="${t=>t.closeButtonTooltip}" class="close-button" data-t="${t=>t.closeButtonTelemetryTag}" tabindex="0" title="${t=>t.closeButtonTooltip}">${O.qy.partial(ft())}</fluent-button></div>`,yt=O.qy`<div class="menu-header"><span class="mobile-header"><slot name="mobile-header"></slot></span></div><fluent-divider class="separator" role="presentation"></fluent-divider>`,kt=O.qy`<div ${(0,R.K)("menuOverlay")} class="overlay ${t=>t.useMobileStyles?"mobile":""}" part="overlay"><div @focusout="${(t,e)=>t.onMenuFocusout(e.event)}" ${(0,R.K)("menuRef")} class="menu" data-t="${t=>t.verticalNavTelemetryTag}" part="menu">${(0,U.z)(t=>t.useMobileStyles,yt)} ${(0,U.z)(t=>!t.useMobileStyles,xt)}<div class="menu-content" part="menu-content"><fluent-tree-view @keydown="${(t,e)=>t.handleKeyDown(e.event)}" @click="${(t,e)=>t.handleClick(e.event)}" @selected-change="${(t,e)=>t.onSelectedChange(e.event)}" ${(0,R.K)("treeView")} part="tree-view">${(0,W.ux)(t=>t.navItems,$t)}</fluent-tree-view></div></div></div>`,It=O.qy`<template role="navigation"><fluent-button @click="${t=>t.openMenu()}" class="menu-button" ${(0,R.K)("menuButton")} appearance="stealth" aria-label="${t=>t.menuButtonTooltip}" data-t="${t=>t.hamburgerMenuButtonTelemetryTag}" icon-only="true" part="menu-button" title="${t=>t.menuButtonTooltip}">${O.qy.partial(wt())}</fluent-button>${(0,U.z)(t=>t.isMenuVisible||t.forceOpenMenu,kt)}</template>`,Ft=at.compose({name:"cs-super-nav-vertical",template:It,styles:vt,shadowOptions:{delegatesFocus:!0}});tt.m.define(s.c.registry),et.m.define(s.c.registry);var Ct,Nt=i(65614);!function(t){t[t.None=0]="None",t[t.MyFeed=1]="MyFeed",t[t.Office365=2]="Office365"}(Ct||(Ct={}));var St=i(60433),Dt=i(94425),Mt=i(89980),_t=i(19548),Lt=i(12870),zt=i(53384),Bt=i(67387),Tt=i(24035),Ht=i(28006),Et=i(84855);i(78629).C1;var Pt=i(35849);var At=i(27261),Ot=i(17720),Ut=i(41377);const Rt=t=>{const e=t.indexOf("_");if(t||-1!==e)return t.substring(0,e)},Wt=t=>{const e=t.lastIndexOf("_");if(!t&&-1===e)return;const i=t.indexOf("_");return i===e?t.substring(0,i):t.substring(0,e)};var jt=i(15003),Vt=i(45083),qt=i(41423),Gt=i(11372),Yt=i(87518),Jt=i(54030),Kt=i(87405),Qt=i(70487),Xt=i(93468),Zt=i(65022),te=i(52088),ee=i(21481),ie=i(43727),ne=i(27597),se=i(43820),oe=i(59545),re=i(11367);class ae extends ee.U{constructor(){var t;super(...arguments),this.cmsPositionHighlighted=!1,this.currentAppType=E.DF.getInstance().AppType,this.currentUrl=new URL((0,At.$N)()),this.currentPageType=E.DF.getInstance().CurrentRequestTargetScope.pageType,this.currentSearchParams=new URLSearchParams((0,At.iA)()),this.defaultNavItemId="myFeed",this.enableEnterprise=!1,this.enableVerticalNav=!0,this.eventLocalStorage=(0,St.V)(),this.isVPTest=!1,this.isLocalhost=this.currentUrl.hostname.includes("localhost"),this.preservedQueryParams="homePage"===this.currentAppType?["ocid","item","pcsonly","fdhead","pc","segment","scenario","assetId","campaign","batch"]:["ocid","item","pcsonly","fdhead","pc"],this.horizontalNavItems=[],this.navItemData=new Map,this.selectedNavItemId=this.defaultNavItemId,this.selectedNavItemId_vertical=this.defaultNavItemId,this.showEvent=!1,this.showPersonalizeButton=!0,this.showStreaksButton=!0,this.showFeedDropdown=!0,this.telemetryTags={},this.useMSNBranding=!1,this.verticalNavItems=[],this.isFeedSettingsDialogOpen=!1,this.feedSettingAbove=!1,this.isBackgroundImageOn=!1,this.isWidgetsOn=!1,this.showRewards=!1,this.isFromWidgetLockScreen=E.T3.IsHeroNTP,this.isDarkBackgroundImage="dark"===(null===(t=(0,E.rA)())||void 0===t?void 0:t.CanvasTheme),this.showFullPageBlur=!1,this.isSignedInMSAUser=!1,this.enableRubyToggleSuperNav=!1,this.preNavItemOrder=[],this.preHomeNavItemOrder=[],this.navReinitializeProcess=!1,this.focusIndex=0,this.feedMenuItems=["always","peek","headingsonly"],this.feedStrings={always:"fullPage",peek:"partialView",headingsonly:"headings"},this.lastSelectedNavItemId=this.defaultNavItemId,this.isRubyEligibleForHOD=!1,this.getRubyToggleStrings=()=>{var t,e,i,n,s,o;return this.config.enableAIString?{copilotDiscoverTooltip:(null===(n=this.strings)||void 0===n?void 0:n.copilotDiscoverAITooltip)??"is on. Turn off to go back to the previous feed.",copilotDiscover:(null===(s=this.strings)||void 0===s?void 0:s.copilotDiscoverAI)??"AI Discover",copilotDiscoverPreview:(null===(o=this.strings)||void 0===o?void 0:o.copilotDiscoverAIPreview)??"Preview"}:{copilotDiscoverTooltip:(null===(t=this.strings)||void 0===t?void 0:t.copilotDiscoverTooltip)??"is on. Turn off to go back to the previous feed.",copilotDiscover:(null===(e=this.strings)||void 0===e?void 0:e.copilotDiscover)??"{entityName}",copilotDiscoverPreview:(null===(i=this.strings)||void 0===i?void 0:i.copilotDiscoverPreview)??"{entitySuffix}"}},this.onNavManagerChangeRequest=(t,e)=>{const i=this.navItemData.get(t);if(e&&e.currentTarget&&ot.YT){var n;const t=(null==i||null===(n=i.renderInfo_ExternalLink)||void 0===n?void 0:n.externalUrl)||"",s=te.W.get(e.currentTarget);t&&s&&s.contract&&(s.contract.overrideDestinationUrl=(0,Dt.bI)(t),te.W.setAttribute(e.currentTarget,s.contract))}i&&(t!==this.selectedNavItemId||this.useMSNBranding)&&this.executeNavSwitch(t,!0)},this.onPivotManagerSwitch=t=>{var e;let i=null==t||null===(e=t.newSelection)||void 0===e?void 0:e.pivotId;"oneriver.editinterests"===i&&(i="myInterests");const n=t.navIsSticky;this.navItemData.get(i)&&i!==this.selectedNavItemId&&this.executeNavSwitch(i,n??!0,{hash:t.hash})},this.onPersonalizeClick=t=>{var e;if(null!==(e=this.config.horizontalNav)&&void 0!==e&&e.enableNewFeedToggle&&this.closeFeedSettings(),t&&ot.YT.sendActionEvent(t.target),ot.YT.addOrUpdateTmplProperty("ChannelStoreLaunched","1"),this.config&&this.config.useChannelStore)window.dispatchEvent(new CustomEvent("launchChannelStore"));else{this.navItemData&&this.navItemData.get("myInterests")&&this.onNavItemClick({detail:{selectedNavId:"myInterests"}})}},this.openFeedSettings=()=>{this.setFeedSettingsAbove(),this.isFeedSettingsDialogOpen=!0,document.addEventListener("mousedown",this.onOutsideClick),document.addEventListener("scroll",this.handleScrollEvent),this.$emit("feedsettingsopened"),(0,h.YJ)(h.xV.feedSettings,!0)},this.closeFeedSettings=()=>{this.isFeedSettingsDialogOpen=!1,document.removeEventListener("mousedown",this.onOutsideClick),document.removeEventListener("scroll",this.handleScrollEvent),(0,h.YJ)(h.xV.feedSettings,!1),this.$emit("feedsettingsclosed")},this.onFeedSettingClick=t=>{t.preventDefault(),ot.YT.addOrUpdateTmplProperty("feedSettingsClick","1"),this.config.horizontalNav.enableOldFeedToggle||(t&&ot.YT.sendActionEvent(t.target),this.isFeedSettingsDialogOpen?this.closeFeedSettings():(this.openFeedSettings(),window.setTimeout(()=>{this.currentSetting&&(this.focusIndex=this.feedMenuItems.indexOf(this.currentSetting)),this.menuRef.children[this.focusIndex].tabIndex=0,this.menuRef.children[this.focusIndex].focus()},10)))},this.onFlyoutEvent=(t,e)=>{this.isFeedSettingsDialogOpen&&t!==h.xV.feedSettings&&e&&this.closeFeedSettings()},this.handleScrollEvent=()=>{this.setFeedSettingsAbove()},this.setFeedSettingsAbove=()=>{var t,e;const i=null!==(t=this.config.horizontalNav)&&void 0!==t&&t.enableNewFeedToggle?250:130,n=(null===(e=this.refHorizontalNav)||void 0===e?void 0:e.getBoundingClientRect().top)||0,s=n-i>=0,o=i<window.innerHeight-n;this.feedSettingAbove=!o&&s},this.onOutsideClick=t=>{var e,i;if(!this.isFeedSettingsDialogOpen||t.target instanceof ae)return;const n=t.composedPath();null!==(e=this.config.horizontalNav)&&void 0!==e&&e.enableNewFeedToggle&&null!=n&&n.includes(this.dialogRef)||null!=n&&n.includes(this.feedSettingButtonRef)||(null===(i=this.config.horizontalNav)||void 0===i||!i.enableNewFeedToggle)&&null!=n&&n.includes(this.menuRef)||null!=n&&n.includes(this.feedSettingButtonRef)||this.closeFeedSettings()},this.keyDownHandler=t=>{switch(t.key){case it.F9:t.shiftKey||(t.preventDefault(),this.closeFeedSettings());break;case it.kT:t.shiftKey||(t.preventDefault(),this.prevOption(t));break;case it.bb:case it.I5:t.shiftKey||(t.preventDefault(),this.nextOption(t));break;case it.HX:t.shiftKey||(t.preventDefault(),this.prevOption(t))}return!0},this.prevOption=t=>{this.focusIndex&&this.focusIndex>0&&(this.menuRef.children[this.focusIndex-1].tabIndex=0,this.menuRef.children[this.focusIndex].tabIndex=-1,this.menuRef.children[this.focusIndex-1].focus(),this.focusIndex--)},this.nextOption=t=>{this.menuRef&&null!=this.focusIndex&&this.focusIndex<this.feedMenuItems.length-1&&(this.menuRef.children[this.focusIndex+1].tabIndex=0,this.menuRef.children[this.focusIndex].tabIndex=-1,this.menuRef.children[this.focusIndex+1].focus(),this.focusIndex++)},this.rewardsLoaded=t=>{this.showRewards=t},this.redirectFromWorkFeed=()=>{var t,e;return!(null!==(t=this.adminSettings)&&void 0!==t&&t.isEducationalUser||(null===(e=this.adminSettings)||void 0===e?void 0:e.defaultNewsEntry)===Ct.Office365)&&this.shouldRedirectWorkFeed()},this.setLocalStorageForWorkFeed=()=>{try{(0,Mt.Lg)().setObject("wfr",!0),ot.YT.addOrUpdateTmplProperty("wfr","1")}catch(t){return void(0,Xt.vV)(Zt.YJY,"Local storage for super nav failed to write.")}},this.shouldRedirectWorkFeed=()=>{try{const t=(0,Mt.Lg)().getObject("wfr");return null==t}catch(t){return(0,Xt.vV)(Zt.YJY,"Local storage for super nav failed to read."),!1}},this.hasRedirectedWorkFeed=()=>{try{return 1==(0,Mt.Lg)().getObject("wfr")}catch(t){return(0,Xt.vV)(Zt.YJY,"Local storage for super nav failed to read."),!1}},this.handlePopState=t=>{const e=t.state,i=null!=e&&e.id&&this.navItemData&&this.navItemData.get(e.id)?e.id:this.lastSelectedNavItemId;i&&i!==this.selectedNavItemId&&this.executeNavSwitch(i,!1)}}async experienceConnected(){var t,e,i,n,s;this.defaultNavItemId=this.config.defaultNavItemId,this.navManager=Ut.bN.getInstance(this.onNavManagerChangeRequest),this.currentSearchParams.forEach((t,e)=>{-1===this.preservedQueryParams.indexOf(e)&&this.currentUrl.searchParams.delete(e)}),null!==(t=this.config)&&void 0!==t&&t.enableHOD&&(this.isRubyEligibleForHOD=await re.gR.getIsRubyEligible()),(0,v.S)()&&"homePage"===this.currentAppType&&window.addEventListener("popstate",this.handlePopState);let o=this.defaultNavItemId;const r=null===(e=this.navManager)||void 0===e?void 0:e.getForceSelectedNavItemId();let a=!1;if(r&&(this.selectedNavItemId=r,a=!0),Object.entries(this.config.navItemData).forEach(t=>{var e;const i=t[0],n=t[1];if("edgeChromium"!==this.currentAppType&&!a){var s;const t=null===(s=n.renderInfo_ExternalLink)||void 0===s?void 0:s.externalUrl;if(t){var r,l;const e=new URL((0,Dt.bI)(t));var d,h;if(n.renderInfo_ExternalLink.externalUrl=t,e.pathname.length>6&&(null===(r=this.currentUrl.pathname)||void 0===r?void 0:r.toLowerCase().indexOf(null===(l=e.pathname)||void 0===l?void 0:l.toLowerCase()))>=0)(null===(d=e.pathname)||void 0===d?void 0:d.toLowerCase())===(null===(h=this.currentUrl.pathname)||void 0===h?void 0:h.toLowerCase())?(this.selectedNavItemId=i,a=!0):o=i}}null===(e=this.navItemData)||void 0===e||e.set(i,n)}),!a)if(o!==this.selectedNavItemId)this.selectedNavItemId=o;else{const t=this.getFallbackInitialNavItemId();t&&(this.selectedNavItemId=t)}if(this.enableEnterprise=!!this.config.horizontalNav.homenavItemOrder.concat(this.config.horizontalNav.navItemOrder).find(t=>"productivityHub"===t),this.isVPTest=(0,At.$N)().includes("reqsrc=vp"),this.isVPTest&&!this.config.ignoreVPTest&&this.vpTestPrep(),await this.eventPrep(),this.msnBrandingPrep(),this.createNavTelemetryTags(),this.getAdminDataSettings(),await this.initializeHorizontalNav(),this.initializeVerticalNav(),this.pivotManager||(0,Xt.vV)(Zt.X1L,""),null===(i=this.pivotManager)||void 0===i||i.addSwitchListener(this.onPivotManagerSwitch),"windows"===this.currentAppType&&Tt.X.subscribe(Tt.t.CurrentRoute,t=>{var e;const{id:i}=t.state||{};this.navItemData.get(i)&&(null===(e=this.pivotManager)||void 0===e||e.switchPivot({pivotId:i}))}),this.adminSettings){if(!this.enableEnterprise||!E.T3.isAadAccountUser)return;const t=this.adminSettings.isShowCompanyAndIndustry,e=this.adminSettings.isOfficeContentEnabled;(0,ne.vQ)(Ht.ql,i=>{i&&i.settings&&(t!==i.settings.isShowCompanyAndIndustry||e!==i.settings.isOfficeContentEnabled)&&(this.navReinitializeProcess=!0,this.adminSettings=i.settings,window.setTimeout(async()=>{await this.initializeHorizontalNav(),this.initializeVerticalNav()},0))})}if(null!==(n=this.config.horizontalNav)&&void 0!==n&&n.enableFeedDropdown){if(this.pageSettingsConnector=(0,Pt.zP)(Ht.h$),!this.pageSettingsConnector)return void(this.showFeedDropdown=!1);(0,ne.vQ)(Ht.h$,t=>{const e=t.userSelectedFeedDisplaySetting||t.selectedFeedDisplaySetting;"off"!=t.currentBackgroundImageType?this.isBackgroundImageOn=!0:this.isBackgroundImageOn=!1,this.isFromWidgetLockScreen&&"off"===e?this.showFeedDropdown=!1:this.showFeedDropdown=!0,this.isWidgetsOn=t.enableWidgetsRegion||!1,this.currentSetting=e})}null!==(s=this.config.horizontalNav)&&void 0!==s&&s.enableOldFeedToggle||(0,h.vs)(this.onFlyoutEvent),this.config.horizontalNavLogo&&(this.msnBrandingLogoUrl=this.config.logoRedirectionUrl?(0,Dt.bI)(this.config.logoRedirectionUrl):""),this.config.isNewHeaderEnabled&&this.setAttribute("isMobile","true")}disconnectedCallback(){var t,e,i;super.disconnectedCallback(),null===(t=this.navManager)||void 0===t||t.disconnectSuperNav(),null===(e=this.pivotManager)||void 0===e||e.removeSwitchListener(this.onPivotManagerSwitch),null!==(i=this.config.horizontalNav)&&void 0!==i&&i.enableOldFeedToggle||(0,h.Cq)(this.onFlyoutEvent),(0,v.S)()&&window.removeEventListener("popstate",this.handlePopState)}shadowDomPopulated(){var t,e,i,n,s,o,r,a;if((0,v.S)()){var l,d,h,c,u,g,p,f,m,w;if(this.markVisuallyReadyRaf(),(0,Kt.KO)(Qt.u.myFeed,null===(t=this.refHorizontalNav)||void 0===t||null===(t=t.shadowRoot)||void 0===t||null===(e=t.getElementById)||void 0===e?void 0:e.call(t,"myFeed")),this.config.horizontalNav.enablePersonalizeButton)(0,Kt.KO)(Qt.u.myInterests,null===(l=this.shadowRoot)||void 0===l||null===(d=l.getElementById)||void 0===d?void 0:d.call(l,"myInterests"));if(this.enableEnterprise)(0,Kt.KO)(Qt.u.office365,null===(h=this.refHorizontalNav)||void 0===h||null===(h=h.shadowRoot)||void 0===h||null===(c=h.getElementById)||void 0===c?void 0:c.call(h,"productivityHub"));if(this.config.horizontalNav.navItemOrder.find(t=>"gaming"===t))(0,Kt.KO)(Qt.u.gaming,null===(u=this.refHorizontalNav)||void 0===u||null===(u=u.shadowRoot)||void 0===u||null===(g=u.getElementById)||void 0===g?void 0:g.call(u,"gaming"));if(this.config.horizontalNav.navItemOrder.find(t=>"play"===t))(0,Kt.KO)(Qt.u.gaming,null===(p=this.refHorizontalNav)||void 0===p||null===(p=p.shadowRoot)||void 0===p||null===(f=p.getElementById)||void 0===f?void 0:f.call(p,"play"));if(this.config.horizontalNav.navItemOrder.find(t=>"navigationPage"===t))(0,Kt.KO)(Qt.u.navigationPage,null===(m=this.refHorizontalNav)||void 0===m||null===(m=m.shadowRoot)||void 0===m||null===(w=m.getElementById)||void 0===w?void 0:w.call(m,"navigationPage"));this.config.enableRegisterPersonalize&&this.refPersonalizeButton&&(0,Kt.KO)(Qt.u.personalizeButton,this.refPersonalizeButton),(0,Kt.KO)(Qt.u.shoppingNav,null===(i=this.refHorizontalNav)||void 0===i||null===(i=i.shadowRoot)||void 0===i||null===(n=i.getElementById)||void 0===n?void 0:n.call(i,"shopping")),(0,Kt.KO)(Qt.u.watchNav,null===(s=this.refHorizontalNav)||void 0===s||null===(s=s.shadowRoot)||void 0===s||null===(o=s.getElementById)||void 0===o?void 0:o.call(s,"watch")),(0,Kt.KO)(Qt.u.weatherNav,null===(r=this.refHorizontalNav)||void 0===r||null===(r=r.shadowRoot)||void 0===r||null===(a=r.getElementById)||void 0===a?void 0:a.call(r,"weather"))}}selectedNavItemIdChanged(t,e){this.lastSelectedNavItemId=t;const i=Rt(this.selectedNavItemId);this.selectedNavItemId_vertical=t!==e&&i?i:e}getFallbackInitialNavItemId(){switch(this.currentPageType){case"video":return"watch";case"article":case"gallery":case"channel":case"source":case"topic":case"channel::source":case"channel::topic":case"insight":return"news";default:return""}}createNavTelemetryTags(){var t;if(this.telemetryObject=(0,Yt.g)("PivotsNav",{},{type:Gt.MJ.Header}),!this.telemetryObject)return;const e=(0,Yt.l)("InterestsNavOptions",{headline:"Interests Nav Options"},Gt.MS.Show,Gt.EG.Click);this.telemetryTags.horizontalNavOverflowButton=(0,Jt.N)("TopNavEllipsis",Gt.MS.More,Gt.EG.Click,Gt.MJ.ActionButton).getMetadataTag(),this.telemetryTags.personalizeButton=(0,Jt.u)("Personalize",Gt.MS.Navigate,Gt.EG.Click,Gt.MJ.ActionButton,{overrideDestinationUrl:_t._3.appendSearchParam(new URL((0,At.$N)()),"filter","Personalize").toString()}).getMetadataTag(),null!==(t=this.config.horizontalNav)&&void 0!==t&&t.enableFeedDropdown&&(this.telemetryTags.feedDropdown=(0,Jt.N)("FeedDropdown",Gt.MS.Click,Gt.EG.Click,Gt.MJ.ActionButton).getMetadataTag()),this.telemetryTags.verticalNav=(0,Yt.g)("Hamburger",{},{type:Gt.MJ.Header}).getMetadataTag(),this.telemetryTags.verticalNavButton=(0,Yt.l)("Hamburger",{headline:"Hamburger"},Gt.MS.Show,Gt.MJ.ActionButton).getMetadataTag(),this.telemetryTags.verticalNavCloseButton=(0,Yt.l)("CloseHamburger",{headline:"Close"},Gt.MS.Close,Gt.EG.Click,Gt.MJ.ActionButton).getMetadataTag(),this.config.horizontalNavLogo&&(this.telemetryTags.horizontalBrandingLogo=(0,Jt.N)("msBrandingLogo",Gt.MS.Navigate,Gt.EG.Click,Gt.MJ.ActionButton).getMetadataTag()),this.telemetryTags.vericalNavExpandedChange=t=>{const i=t.detail;i&&ot.YT&&(te.W.setAttribute(i,{name:"InterestsNavOptions"},e),ot.YT.sendActionEvent(i,Gt.EG.Click,Gt.MS.Show))}}async eventPrep(){if(this.config.event&&this.config.event.cmsArticleUrl){let n;var t,e,i;if(this.hydratable)if(n=null===(t=this.shadowRoot)||void 0===t||null===(e=t.querySelector)||void 0===e||null===(e=e.call(t,"cs-super-nav-horizontal"))||void 0===e||null===(e=e.shadowRoot)||void 0===e||null===(i=e.getElementById)||void 0===i?void 0:i.call(e,"cms_event"),!n)return;if(this.showEvent=await this.eventLocalStorage.shouldShowEvent("CMS",Et.Isg,["CMS"],void 0,this.config.event.cmsArticleUrl,Zt.o6X,n),this.showEvent){const t=this.eventLocalStorage.getCMSContent("CMS",Et.Isg,["CMS"],Zt.o6X);if(t&&!Ot.vv.get("__navEventEnabled__")){Ot.vv.set("__navEventEnabled__",!0);const e={renderType:"externalLink",renderInfo_ExternalLink:{externalUrl:t.url,openInNewTab:!0}};this.navItemData&&this.config.event&&(this.navItemData.set("cms_event",e),this.cmsPositionOverride=parseInt(t.positionOverride||"-1"),this.cmsPositionHighlighted=!!t.highlighted,this.cmsText=t.display)}}}}updateSelectedNavItem(t){Lt.Rb.LastSelectedPivot=this.selectedNavItemId,this.selectedNavItemId=t,Lt.Rb.SwitchedPivot=t}executeNavSwitch(t,e,i){var n,s,o;this.navItemData||(0,Xt.vV)(Zt.bCS,"No nav data"),this.navItemData.get(t)||((0,Xt.vV)(Zt.bCS,"Nav item not found, switch failed. Nav item id:"+t,"Nav item id: "+t+". User triggered: "+e+". Defaulted to: "+this.defaultNavItemId),t=this.defaultNavItemId,(0,zt.QN)(t));const r=this.navItemData&&this.navItemData.get(t);if(e&&"externalLink"===r.renderType){var a,l;const e=null!==(a=r.renderInfo_ExternalLink)&&void 0!==a&&a.externalUrl?null===(l=r.renderInfo_ExternalLink)||void 0===l?void 0:l.externalUrl:"";let i=this.formatUrl(e,!0,void 0,t);var d;if(i)if(null!==(d=this.config.horizontalNav)&&void 0!==d&&d.enableDailyStreaks&&(i=(0,ie.Y)(decodeURIComponent(i),(0,At.iA)())),this.useExternalRouting)this.updateSelectedNavItem(t),window.dispatchEvent(new CustomEvent(Ut.b3,{detail:{url:i}}));else{var h;const t=i.includes("U526")&&i.includes("chromentpnews");window.open(i,null!==(h=r.renderInfo_ExternalLink)&&void 0!==h&&h.openInNewTab||t?"_blank":"_self")}return}this.updateSelectedNavItem(t),e&&(0,zt.S)(Bt.Cr.Sticky);const c=null===(n=r.renderInfo_Router)||void 0===n||null===(n=n.context)||void 0===n?void 0:n.pageType;"MyInterests"!==c&&"MySaves"!==c&&"History"!==c&&"Setting"!==c&&"Notification"!==c||(i?i.pageType=c:i={pageType:c});const u={configIndexRef:null===(s=this.getRenderInfo(r,t))||void 0===s?void 0:s.experienceConfigRef,context:i,display:this.getLocString(t),pivotId:t,telemetryVertical:this.config.defaultTelemetryVertical,telemetryPageType:"dhp"==E.T3.CurrentRequestTargetScope.pageType?"dhp":"ntp"};(0,zt.G2)(t),null===(o=this.pivotManager)||void 0===o||o.switchPivot(u,!0),this.getContextualHorizontalNavItems();const g=n=>{const{externalUrl:s,pushToBrowserHistory:o}=r.renderInfo_ExternalLink||{};if(s&&o)try{var a;const o=(0,_t.R1)(this.formatUrl(s,e,null===(a=i)||void 0===a?void 0:a.hash));(0,Dt.M)(o),history.pushState(n,t,o)}catch(t){(0,Xt.c_)(t,Zt.ao8,"Failed to push URL to browser history: "+s)}};switch(this.currentAppType){case"homePage":{const i={id:t,renderInfo:r.renderInfo_Router};e&&(0,v.S)()&&g(i),window.dispatchEvent(new CustomEvent("nav-switch",{detail:{...i}}));break}case"windows":{const e={id:t,renderInfo:r.renderInfo_Router};g(e),Tt.X.set(Tt.t.CurrentRoute,e);break}case"edgeChromium":{var p;const i=(0,zt.kP)();this.config.horizontalNav.homenavItemOrder.indexOf(t)>=0&&e&&"following"!==t&&(i&&i!==t&&(0,jt.TI)(4),(0,zt.QN)(t)),i||(0,zt.QN)("myFeed"),null!==(p=this.config)&&void 0!==p&&null!==(p=p.horizontalNav)&&void 0!==p&&p.redirectWorkFeed&&"productivityHub"===t&&(ot.YT.addOrUpdateTmplProperty("VisitsWF","1"),this.hasRedirectedWorkFeed()&&ot.YT.addOrUpdateTmplProperty("wf","1"));break}}}filterNavItems(t){const e=this.navItemData&&this.navItemData.get(t);if(!e)return void(0,Xt.vV)(Zt.MLR,"Missing nav item data for "+t);if(this.getLocString(t)){if(!e.requiresGPU)return!(null!=e&&e.hideNavItem)}else(0,Xt.vV)(Zt.BZI,"Missing loc string for "+t)}formatUrl(t,e,i,n){this.isLocalhost&&(t=t.replace("{hostName}","localhost.msn.com:8080"));const s=t&&new URL((0,Dt.bI)(t));if(!s||!s.searchParams)return"";const o=s.searchParams;if(this.currentUrl.search&&"edgeChromium"!==E.T3.AppType&&this.currentUrl.searchParams.forEach((t,e)=>{"homePage"===E.T3.AppType&&"assetId"===e||(e=e.toLowerCase()),-1===o.getAll(e).indexOf(t)&&s.searchParams.append(e,t)}),i&&(s.hash=i),!e)return decodeURIComponent(s.toString());if(!s.searchParams.has("ocid")){let t="";if("windows"!==this.currentAppType||this.config.useMsnHpOcid){if("windows"===this.currentAppType&&this.config.useMsnHpOcid||"homePage"===this.currentAppType)t="hpmsn";else if("edgeChromium"===this.currentAppType){var r;t="dhp"===(null===E.T3||void 0===E.T3||null===(r=E.T3.CurrentRequestTargetScope)||void 0===r?void 0:r.pageType)?"msedgdhphdr":"msedgntphdr"}}else t="windirect";t&&s.searchParams.set("ocid",t)}return s.searchParams.has("cvid")||s.searchParams.set("cvid",ot.YT.getRequestId()),"shopping"!=n||s.searchParams.has("msnrid")||s.searchParams.set("msnrid",ot.YT.getRequestId()),decodeURIComponent(s.toString())}getAdminDataSettings(){const t=(0,E.rA)();if(!this.enableEnterprise||!t.isAadAccountUser)return;const e={isOfficeContentEnabled:!1,isShowCompanyAndIndustry:!0};if(this.adminSettings=e,t.IsChinaCompliance)return this.adminSettings={isOfficeContentEnabled:!1,isShowCompanyAndIndustry:!0},void(0,zt.hG)();const i=(0,Pt.zP)(Ht.ql),n=i&&i.getCurrentState();this.adminSettings=n&&n.settings||e}getContextualHorizontalNavItems(){var t,e,i;if(!this.selectedNavItemId)return;const n=this.navItemData&&this.navItemData.get("myInterests"),s="myInterests"===this.selectedNavItemId||(null==n||null===(t=n.children)||void 0===t?void 0:t.includes(this.selectedNavItemId)),o=s;s||this.useMSNBranding&&!this.config.homeToMSN?(this.showPersonalizeButton=!1,this.showStreaksButton=!1):(this.showPersonalizeButton=!0,this.showStreaksButton=!0),s||null===(e=this.config.horizontalNav)||void 0===e||!e.enableFeedDropdown?this.showFeedDropdown=!1:this.showFeedDropdown=!0;const r=-1!==this.selectedNavItemId.indexOf("_"),a=r&&this.selectedNavItemId.indexOf("_")!==this.selectedNavItemId.lastIndexOf("_"),l=this.config.showL1NavOnly&&!a||["edgeChromium","windows","homePage"].includes(this.currentAppType)&&(!s||!1===(null===(i=this.config.horizontalNav)||void 0===i?void 0:i.enablePersonalizeButton));let d=this.config.horizontalNav.homenavItemOrder;if(!l&&a){var h;const t=Rt(this.selectedNavItemId),e=Wt(this.selectedNavItemId);let i=null===(h=this.navItemData.get(e))||void 0===h?void 0:h.children;this.config.isNewHeaderEnabled&&(i=this.removeUnselectedParentItems(i)),d=this.config.horizontalNav.homenavItemOrder.concat([t,e],i||[this.selectedNavItemId])}else if(!l&&r){var c;const t=Wt(this.selectedNavItemId),e=null===(c=this.navItemData.get(this.selectedNavItemId))||void 0===c?void 0:c.children,i=s&&this.config.useChannelStore;if(e)d=i?this.config.horizontalNav.homenavItemOrder.concat([this.selectedNavItemId],e):this.config.horizontalNav.homenavItemOrder.concat([t,this.selectedNavItemId],e);else{var u;let e=null===(u=this.navItemData.get(t))||void 0===u?void 0:u.children;this.config.isNewHeaderEnabled&&(e=this.removeUnselectedParentItems(e)),d=i?this.config.horizontalNav.homenavItemOrder.concat(e||[]):this.config.horizontalNav.homenavItemOrder.concat([t],e||[])}}else if(l||this.config.horizontalNav.homenavItemOrder.indexOf(this.selectedNavItemId)>=0)d=this.config.horizontalNav.homenavItemOrder.concat(this.config.horizontalNav.navItemOrder);else{var v;const t=null===(v=this.navItemData.get(this.selectedNavItemId))||void 0===v?void 0:v.children;d=this.config.horizontalNav.homenavItemOrder.concat([this.selectedNavItemId],t||[])}this.updateHorizontalNavItems(d,o)}removeUnselectedParentItems(t){if(t)return t.filter(t=>t===this.selectedNavItemId)}getExperienceType(){return Et.Isg}getLocString(t){var e;let i=this.config.localizedStrings[t];if("myFeed"===t&&this.config.useTempMyFeedString)return i=this.config.localizedStrings.myFeedTemp,i;return(null===(e=this.config.event)||void 0===e?void 0:e.cmsArticleUrl)&&"cms_event"===t?this.cmsText:i}getRenderInfo(t,e){let i;var n;if("router"===t.renderType){if(i=t.renderInfo_Router,!(null!=e&&e.includes("myInterests")||null!==(n=i)&&void 0!==n&&n.experienceConfigRef))return void(0,Xt.vV)(Zt.Ikj,"Nav item missing experience config ref","Nav item: "+e)}else i="xfeed"===t.renderType?t.renderInfo_Router:t.renderInfo_ExternalLink;if(i)return i;(0,Xt.vV)(Zt.Ikj,"Nav item missing render info","Nav item: "+e)}getSavedNavItem(){if(!this.enableEnterprise)return this.defaultNavItemId;let t=(0,zt.kP)();if(!t||"null"===t||"undefined"===t||""===t||"gaming"===t)return this.defaultNavItemId;if(this.enableEnterprise){var e,i;const n={myFeed:0,productivityHub:1};if(null===(e=this.adminSettings)||void 0===e||!e.isOfficeContentEnabled||null!==(i=this.adminSettings)&&void 0!==i&&i.isShowCompanyAndIndustry){const e=function(t,e){const i=(0,zt.kP)();let n;if(t&&i&&(n=t[i]),!e){const t=(0,Pt.zP)(Ht.ql),i=t&&t.getCurrentState();e=i?i.settings:(0,Mt.Lg)().getObject("AdminPortalSettings")}if(!e)return n;const{adminSelectedNavId:s,isOfficeContentEnabled:o,isShowCompanyAndIndustry:r}=e;let a;return t&&s&&(a=t[s]),o&&r?n||a||0:o?1:0}(n,this.navReinitializeProcess?this.adminSettings:void 0);if(e)if(1===e)t="productivityHub";else t="myFeed";else t=t||"myFeed"}else t="productivityHub"}return t||this.defaultNavItemId}async initializeHorizontalNav(){if("edgeChromium"===this.currentAppType){var t;if(this.selectedNavItemId=this.enableEnterprise&&!E.T3.IsHeroNTP?this.getSavedNavItem():this.defaultNavItemId,null!==(t=this.config)&&void 0!==t&&null!==(t=t.horizontalNav)&&void 0!==t&&t.redirectWorkFeed&&"productivityHub"==this.selectedNavItemId&&(ot.YT.addOrUpdateTmplProperty("StartOnWF","1"),this.redirectFromWorkFeed())){var e;if(!this.currentSetting)this.pageSettingsConnector=(0,Pt.zP)(Ht.h$),this.currentSetting=null===(e=this.pageSettingsConnector)||void 0===e||null===(e=e.getCurrentState())||void 0===e?void 0:e.selectedFeedDisplaySetting;this.selectedNavItemId=this.defaultNavItemId,this.setLocalStorageForWorkFeed()}if(this.enableEnterprise&&this.adminSettings)if(this.adminSettings.isOfficeContentEnabled)this.adminSettings.isShowCompanyAndIndustry||(this.preNavItemOrder=this.config.horizontalNav.navItemOrder.slice(),this.preHomeNavItemOrder=this.config.horizontalNav.homenavItemOrder.slice(),this.config.horizontalNav.homenavItemOrder=["productivityHub"],this.config.horizontalNav.navItemOrder=[],this.selectedNavItemId="productivityHub",(0,zt.S)(Bt.Cr.Admin));else{0===this.config.horizontalNav.navItemOrder.length&&(this.config.horizontalNav.navItemOrder=this.preNavItemOrder,this.config.horizontalNav.homenavItemOrder=this.preHomeNavItemOrder);const t=this.config.horizontalNav.homenavItemOrder.indexOf("productivityHub");t>=0&&this.config.horizontalNav.homenavItemOrder.splice(t,1)}}this.pivotManager=(0,qt.w)(),this.executeNavSwitch(this.selectedNavItemId,!1);const i=this.navItemData&&this.navItemData.get("seeMore"),n=this.getLocString("seeMore");var s,o;i&&n&&(this.seeMoreNavItem={display:n,href:(0,Dt.bI)(null!==(s=i.renderInfo_ExternalLink)&&void 0!==s&&s.externalUrl?null===(o=i.renderInfo_ExternalLink)||void 0===o?void 0:o.externalUrl:""),id:"seeMore",telemetryMetadata:i?this.mapNavigationItemTelemetryProps(i,"seeMore"):void 0})}initializeVerticalNav(){var t;!this.config.verticalNav||!this.config.homeToMSN&&this.useMSNBranding?this.enableVerticalNav=!1:(0,v.S)()&&(!this.enableEnterprise||null!==(t=this.adminSettings)&&void 0!==t&&t.isShowCompanyAndIndustry?Promise.all([(0,oe.Qc)(),(0,Vt.GP)()]).then(()=>{this.loadVerticalNavIcons().then(t=>{if(this.config.verticalNav){var e;if(this.verticalNavIcons=t,this.enableEnterprise)if(null===(e=this.adminSettings)||void 0===e||!e.isOfficeContentEnabled){const t=this.config.verticalNav.homenavItemOrder.indexOf("productivityHub");this.config.verticalNav.homenavItemOrder.splice(t,1)}this.updateVerticalNavItems(this.config.verticalNav.homenavItemOrder.concat(this.config.verticalNav.navItemOrder),!0).then(t=>{this.verticalNavItems=t}).catch(t=>(0,Xt.vV)(Zt.yHp,"Error updating vertical nav items",t))}}).catch(t=>(0,Xt.vV)(Zt.yHp,"Error loading vertical nav icons",t))}).catch(t=>(0,Xt.vV)(Zt.yHp,"Error while waiting for page perf markers",t)):this.enableVerticalNav=!1)}async loadVerticalNavIcons(){const{navIcons:t}=await i.e("super-nav-icons").then(i.bind(i,76239));return t}mapNavigationItemTelemetryProps(t,e){var i,n;if(!this.telemetryObject||!t)return"";const s="externalLink"==t.renderType&&(null===(i=t.renderInfo_ExternalLink)||void 0===i?void 0:i.externalUrl),o=s?(0,Dt.bI)(s):_t._3.appendSearchParam(new URL((0,At.$N)()),"filter",e).toString(),{localizedStrings:r}=this.config,a=r&&r[e]||e;return(0,Yt.g)(e||"",{headline:a,type:null===(n=this.telemetryObject.contract)||void 0===n||null===(n=n.content)||void 0===n?void 0:n.type},Gt.MS.Navigate,Gt.EG.Click,{feed:{id:e,layout:"multicol",name:a,type:"category filter"},destinationUrl:o,overrideDestinationUrl:o}).getMetadataTag()}msnBrandingPrep(){if(!this.config.homeToMSN&&!(0,se.Pt)(this.currentSearchParams)||"homePage"===this.currentAppType)return;const t=this.navItemData.get("myFeed"),e=this.navItemData.get("msnHome");t&&(t.renderInfo_ExternalLink=null==e?void 0:e.renderInfo_ExternalLink,t.renderType="externalLink",this.navItemData.set("myFeed",t)),this.showPersonalizeButton=!1,this.showStreaksButton=!1,this.useMSNBranding=!0}onNavItemClick(t,e){var i,n;const s=null==t||null===(i=t.detail)||void 0===i?void 0:i.selectedNavId,o=this.navItemData?this.navItemData.get(s):null;if(!s||!o)return;if(s===this.selectedNavItemId&&"edgeChromium"===this.currentAppType)return void window.dispatchEvent(new CustomEvent(Ut.b3));const r=t.currentTarget;if(r&&ot.YT){var a;const t="#"+s,e=null==r?void 0:r.shadowRoot,i=s&&e?null===(a=e.querySelector)||void 0===a?void 0:a.call(e,t):null;i&&(ot.YT.sendActionEvent(i,Gt.EG.Click,Gt.MS.Navigate),i.setAttribute("data-customhandled","true"))}if("externalLink"===o.renderType)return void this.executeNavSwitch(s,!0);const l=e??!0,d=null===(n=o.renderInfo_Router)||void 0===n||null===(n=n.context)||void 0===n?void 0:n.pageType;var h;"MyInterests"===d||"MySaves"===d||"History"===d||"Setting"===d||"Notification"===d?this.executeNavSwitch(s,l,{pageType:d}):this.executeNavSwitch(s,l,{feedId:null===(h=o.renderInfo_Router)||void 0===h||null===(h=h.context)||void 0===h?void 0:h.feedId})}updateHorizontalNavItems(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(!(t.length>0&&this.horizontalNavItems.length>0&&t[t.length-1]===this.horizontalNavItems[this.horizontalNavItems.length-1].id)){if(!e&&Ot.vv.get("__navEventEnabled__")){let e=5;this.cmsPositionOverride&&-1!==this.cmsPositionOverride&&(e=this.cmsPositionOverride),t.splice(e,0,"cms_event")}this.horizontalNavItems=t.filter(t=>this.filterNavItems(t)).map((t,e)=>{var i,n;const s=this.navItemData&&this.navItemData.get(t),o={display:this.getLocString(t),href:(0,Dt.bI)(null!=s&&null!==(i=s.renderInfo_ExternalLink)&&void 0!==i&&i.externalUrl?null===(n=s.renderInfo_ExternalLink)||void 0===n?void 0:n.externalUrl:""),id:t,showDivider:!1,telemetryMetadata:s?this.mapNavigationItemTelemetryProps(s,t):void 0};return"cms_event"===t&&(o.highlighted=this.cmsPositionHighlighted,o.positionOverride=this.cmsPositionOverride),o})}}async updateVerticalNavItems(t){let e=arguments.length>1&&void 0!==arguments[1]&&arguments[1];const i=t.filter(t=>this.filterNavItems(t)).map(async(t,i)=>{var n,s;const o=this.navItemData&&this.navItemData.get(t),r=this.getLocString(t);let a=!1;e&&(a=null!=this.config.verticalNav&&i===this.config.verticalNav.homenavItemOrder.length-1);return{display:r,glyph:null!=o&&o.verticalNavIconId?this.verticalNavIcons&&this.verticalNavIcons[o.verticalNavIconId]:void 0,href:(0,Dt.bI)(null!=o&&null!==(n=o.renderInfo_ExternalLink)&&void 0!==n&&n.externalUrl?null===(s=o.renderInfo_ExternalLink)||void 0===s?void 0:s.externalUrl:""),id:t,showDivider:a,telemetryMetadata:o?this.mapNavigationItemTelemetryProps(o,t):void 0}});return await Promise.all(i)}vpTestPrep(){this.config.horizontalNav.homenavItemOrder=["myFeed"],this.config.horizontalNav.navItemOrder=[],this.config.verticalNav&&(this.config.verticalNav.homenavItemOrder=["myFeed"],this.config.verticalNav.navItemOrder=[]),this.enableEnterprise&&this.config.horizontalNav.homenavItemOrder.unshift("productivityHub")}async updateFeedVisibility(t,e){var i;if(!(0,v.S)()||!t)return;if(e&&e.target){if(this.isRubyEligibleForHOD&&null!==(i=this.config)&&void 0!==i&&i.enableHOD&&"headingsonly"===t&&this.currentSetting!==t)return window.dispatchEvent(new CustomEvent("showFeedOffDialog",{detail:{updatedFeedDisplaySetting:t}})),void this.closeFeedSettings();this.$emit("feedDropdownChange",t),this.closeFeedSettings()}}getOptionTelemetry(t,e){return(0,Yt.l)(t.toString(),{type:Gt.b5.Feed,headline:"feedDropdown"},Gt.MS.Click,Gt.MJ.ActionButton).getMetadataTag()}}(0,o.Cg)([l.sH],ae.prototype,"enableVerticalNav",void 0),(0,o.Cg)([l.sH],ae.prototype,"horizontalNavItems",void 0),(0,o.Cg)([l.sH],ae.prototype,"refHorizontalNav",void 0),(0,o.Cg)([l.sH],ae.prototype,"refPersonalizeButton",void 0),(0,o.Cg)([l.sH],ae.prototype,"seeMoreNavItem",void 0),(0,o.Cg)([l.sH],ae.prototype,"selectedNavItemId",void 0),(0,o.Cg)([l.sH],ae.prototype,"selectedNavItemId_vertical",void 0),(0,o.Cg)([l.sH],ae.prototype,"showPersonalizeButton",void 0),(0,o.Cg)([l.sH],ae.prototype,"showStreaksButton",void 0),(0,o.Cg)([l.sH],ae.prototype,"showFeedDropdown",void 0),(0,o.Cg)([l.sH],ae.prototype,"verticalNavItems",void 0),(0,o.Cg)([l.sH],ae.prototype,"isFeedSettingsDialogOpen",void 0),(0,o.Cg)([l.sH],ae.prototype,"feedSettingAbove",void 0),(0,o.Cg)([l.sH],ae.prototype,"isBackgroundImageOn",void 0),(0,o.Cg)([l.sH],ae.prototype,"isWidgetsOn",void 0),(0,o.Cg)([l.sH],ae.prototype,"showRewards",void 0),(0,o.Cg)([l.sH],ae.prototype,"isDarkBackgroundImage",void 0),(0,o.Cg)([(0,d.CF)({mode:"boolean"})],ae.prototype,"showFullPageBlur",void 0),(0,o.Cg)([(0,d.CF)({mode:"boolean"})],ae.prototype,"isSignedInMSAUser",void 0),(0,o.Cg)([(0,d.CF)({mode:"boolean"})],ae.prototype,"enableRubyToggleSuperNav",void 0),(0,o.Cg)([l.sH],ae.prototype,"currentSetting",void 0),(0,o.Cg)([l.sH],ae.prototype,"focusIndex",void 0),(0,o.Cg)([l.sH],ae.prototype,"lastSelectedNavItemId",void 0),(0,o.Cg)([l.sH],ae.prototype,"isRubyEligibleForHOD",void 0);var le=i(86856),de=i(27942);const he=(i(59721).P.Nav+3).toString(),ce=`${E.T3.StaticsUrl}latest/icons-wc/icons/ScrollForFeed.svg`,ue=`${E.T3.StaticsUrl}latest/icons-wc/icons/ScrollForFeedDark.svg`,ve=`${E.T3.StaticsUrl}latest/icons-wc/icons/ScrollForFeedBg.svg`,ge=`${E.T3.StaticsUrl}latest/icons-wc/icons/ScrollForFeedDarkBg.svg`,pe=`${E.T3.StaticsUrl}latest/icons-wc/icons/MoreFeed.svg`,fe=`${E.T3.StaticsUrl}latest/icons-wc/icons/MoreFeedDark.svg`,me=`${E.T3.StaticsUrl}latest/icons-wc/icons/MoreFeedBg.svg`,we=`${E.T3.StaticsUrl}latest/icons-wc/icons/MoreFeedDarkBg.svg`,be=`${E.T3.StaticsUrl}latest/icons-wc/icons/LessFeed.svg`,$e=`${E.T3.StaticsUrl}latest/icons-wc/icons/LessFeedDark.svg`,xe=`${E.T3.StaticsUrl}latest/icons-wc/icons/LessFeedBg.svg`,ye=`${E.T3.StaticsUrl}latest/icons-wc/icons/LessFeedDarkBg.svg`,ke=`${E.T3.StaticsUrl}latest/icons-wc/icons/ScrollForFeedWidgets.svg`,Ie=`${E.T3.StaticsUrl}latest/icons-wc/icons/ScrollForFeedDarkWidgets.svg`,Fe=`${E.T3.StaticsUrl}latest/icons-wc/icons/ScrollForFeedBgWidgets.svg`,Ce=`${E.T3.StaticsUrl}latest/icons-wc/icons/ScrollForFeedDarkBgWidgets.svg`,Ne=`${E.T3.StaticsUrl}latest/icons-wc/icons/MoreFeedWidgets.svg`,Se=`${E.T3.StaticsUrl}latest/icons-wc/icons/MoreFeedDarkWidgets.svg`,De=`${E.T3.StaticsUrl}latest/icons-wc/icons/MoreFeedBgWidgets.svg`,Me=`${E.T3.StaticsUrl}latest/icons-wc/icons/MoreFeedDarkBgWidgets.svg`,_e=`${E.T3.StaticsUrl}latest/icons-wc/icons/LessFeedWidgets.svg`,Le=`${E.T3.StaticsUrl}latest/icons-wc/icons/LessFeedDarkWidgets.svg`,ze=`${E.T3.StaticsUrl}latest/icons-wc/icons/LessFeedBgWidgets.svg`,Be=`${E.T3.StaticsUrl}latest/icons-wc/icons/LessFeedDarkBgWidgets.svg`,Te=`${E.T3.StaticsUrl}latest/icons-wc/icons/NewScrollForFeed.svg`,He=`${E.T3.StaticsUrl}latest/icons-wc/icons/NewScrollForFeedDark.svg`,Ee=`${E.T3.StaticsUrl}latest/icons-wc/icons/NewScrollForFeedBg.svg`,Pe=`${E.T3.StaticsUrl}latest/icons-wc/icons/NewScrollForFeedDarkBg.svg`,Ae=`${E.T3.StaticsUrl}latest/icons-wc/icons/NewMoreFeed.svg`,Oe=`${E.T3.StaticsUrl}latest/icons-wc/icons/NewMoreFeedDark.svg`,Ue=`${E.T3.StaticsUrl}latest/icons-wc/icons/NewMoreFeedBg.svg`,Re=`${E.T3.StaticsUrl}latest/icons-wc/icons/NewMoreFeedDarkBg.svg`,We=`${E.T3.StaticsUrl}latest/icons-wc/icons/NewLessFeed.svg`,je=`${E.T3.StaticsUrl}latest/icons-wc/icons/NewLessFeedDark.svg`,Ve=`${E.T3.StaticsUrl}latest/icons-wc/icons/NewLessFeedBg.svg`,qe=`${E.T3.StaticsUrl}latest/icons-wc/icons/NewLessFeedDarkBg.svg`,Ge=`${E.T3.StaticsUrl}latest/icons-wc/icons/FeedSettings.svg`,Ye=`${E.T3.StaticsUrl}latest/icons-wc/icons/FeedSettingsDark.svg`,Je=`${E.T3.StaticsUrl}latest/icons-wc/icons/edit_20_regular.svg`,Ke=`${E.T3.StaticsUrl}latest/icons-wc/icons/edit_20_dark.svg`,Qe=`${E.T3.StaticsUrl}latest/icons-wc/icons/Rewards.svg`,Xe=`${E.T3.StaticsUrl}latest/icons-wc/icons/RewardsDark.svg`,Ze=f.A` .feed-settings{left:0px}.feed-settings-dialog{left:0px}`,ti=f.A` .feed-settings{right:0px}.feed-settings-dialog{right:0px}`,ei=f.A` fluent-menu-item.unselected{outline:rgba(225,225,225,0.2) solid 1px}.feed-settings{background-color:#4A4A4A;box-shadow:rgba(0,0,0,0.24) 0px 8px 16px 0px}.feed-settings-dialog{background-color:#4A4A4A;box-shadow:rgba(0,0,0,0.24) 0px 8px 16px 0px}.feed-settings-menu{background-color:#4A4A4A}.feed-settings-icon{background:url(${Ye}) no-repeat center}.feed-settings-edit-icon{background:url(${Ke}) no-repeat center}.feed-svg.always{background:url(${fe}) no-repeat center}.feed-svg.peek{background:url(${$e}) no-repeat center}.feed-svg.headingsonly{background:url(${ue}) no-repeat center}.feed-svg.always.bg{background:url(${we}) no-repeat center}.feed-svg.peek.bg{background:url(${ye}) no-repeat center}.feed-svg.headingsonly.bg{background:url(${ge}) no-repeat center}.feed-svg.always.new-image{background:url(${Oe}) no-repeat center}.feed-svg.peek.new-image{background:url(${je}) no-repeat center}.feed-svg.headingsonly.new-image{background:url(${He}) no-repeat center}.feed-svg.always.bg.new-image{background:url(${Re}) no-repeat center}.feed-svg.peek.bg.new-image{background:url(${qe}) no-repeat center}.feed-svg.headingsonly.bg.new-image{background:url(${Pe}) no-repeat center}.feed-svg.always.new-image.widgets{background:url(${Se}) no-repeat center}.feed-svg.peek.new-image.widgets{background:url(${Le}) no-repeat center}.feed-svg.headingsonly.new-image.widgets{background:url(${Ie}) no-repeat center}.feed-svg.always.bg.new-image.widgets{background:url(${Me}) no-repeat center}.feed-svg.peek.bg.new-image.widgets{background:url(${Be}) no-repeat center}.feed-svg.headingsonly.bg.new-image.widgets{background:url(${Ce}) no-repeat center}fluent-menu-item{background-color:#292929}fluent-menu-item:hover{background-color:#292929}.dark-bg-img fluent-option.unselected{color:#ffffff}.feed-settings-dialog .personalize-container{background-color:#292929}.rewards-icon{background:url(${Xe}) no-repeat center;
    }
`,ii=f.A` .dark-bg-img{--neutral-foreground-rest:#ffffff;--homeItem-list-background:${z};
        --homeItem-list-border-color: ${T};
        --horizontalnav-active-text: ${D};
        --horizontalnav-highlight-text: ${_}}.dark-bg-img .feed-settings-icon{background:url(${Ye}) no-repeat center}.dark-bg-img fluent-option.unselected{color:#2b2b2b}`,ni=f.A`
    ${ii} :host([ismobile="true"]){display:flex;justify-content:center;flex-wrap:nowrap;overflow-x:auto;scrollbar-width:none;-ms-overflow-style:none}.super-nav-bar{align-items:center;display:flex;width:100%}.super-nav-bar .content{flex-grow:1;min-width:0}.super-nav-bar .end{display:flex;gap:8px;padding-inline-start:16px}${(0,de._D)(null,de.j1.c1)}{.super-nav-bar .end{display:none}}${(0,de.H5)(de.j1.c2)}{.super-nav-bar .end ruby-coachmark{display:none}}:host([ismobile="true"]) .super-nav-bar{align-items:center;display:flex;width:100%}.feed-settings{padding:12px;top:42px;width:270px;max-height:calc(90vh - 80px);background-color:${C.T};
        display: flex;
        border-radius: 4px;
        flex-direction: row;
        position: absolute;
        background-color: rgb(247 247 247 / 1);
        z-index: ${he}}.feed-settings-menu{margin-top:20px;box-shadow:none;padding:11px;top:75px;width:270px;right:0px;max-height:calc(90vh - 80px);background-color:${C.T};
        display: flex;
        border-radius: 4px;
        flex-direction: row;
        position: absolute;
        background-color: rgb(247 247 247 / 1);
        z-index: ${he}}.feed-settings-dialog{box-shadow:rgba(0,0,0,0.14) 0px 8px 16px 0px;height:187px;padding:12px;top:46px;width:270px;max-height:calc(90vh - 80px);background-color:${C.T};
        display: flex;
        border-radius: 4px;
        position: absolute;
        background-color: rgb(247 247 247 / 1);
        z-index: ${he}}.feed-settings-dialog .personalize-container{position:relative;border-radius:4px;padding:11px;width:100%;height:60px;outline:rgba(0,0,0,0.12) solid 1px;background-color:#FFFF}.feed-settings-dialog .personalize-title{margin-bottom:12px;text-overflow:ellipsis;line-height:16px;position:relative;font-size:14px;font-weight:600;overflow:hidden;white-space:break-spaces;text-align:left}.feed-settings-dialog .personalize-button{width:100%}.feed-settings-icon{height:20px;width:20px;background:url(${Ge}) no-repeat center}.feed-settings-edit-icon{height:20px;width:20px;margin-inline-end:4px;background:url(${Je}) no-repeat center}.feed-settings-top{top:-101px}.feed-settings-top.with-link{top:-126px}.feed-settings-dialog-top{top:-202px}.hidden{display:none}:host{width:inherit}.end{width:min-content}.endLinear{width:325px}.settings-link{border-color:${$.l};cursor:pointer;height:32px;min-width:min-content}.settings-link.nav1button{border-radius:100px}.settings-link.nav2button{--neutral-fill-stealth-rest:transparent;width:32px}.settings-link:hover{border-color:${k.mb}}.settings-link svg{display:block}.feedDropdown{--neutral-fill-input-rest:transparent;--neutral-fill-input-hover:transparent;border-radius:100px;border:1px solid ${$.l};
        color: ${$.l};height:32px;padding:0px 3px}.feedDropdown:hover{border-color:${k.mb}}.feedDropdown::part(control){background:transparent}.feedDropdown::part(indicator),.feedDropdown::part(select-indicator){height:12px;line-height:12px;min-height:12px;min-width:12px;width:12px}.feedDropdown::part(listbox){border-radius:4px;overflow-x:hidden}.feedDropdown::part(selected-value){overflow:hidden;text-overflow:ellipsis;white-space:nowrap}fluent-option{border-radius:4px;width:96%}.feedDropdown fluent-option{width:auto}.menu-image > *{width:67px;height:48px;display:inline-flex}.menu-image{display:flex;justify-content:center}.feed-svg.always{background:url(${pe}) no-repeat center}.feed-svg.peek{background:url(${be}) no-repeat center}.feed-svg.headingsonly{background:url(${ce}) no-repeat center}.feed-svg.always.bg{background:url(${me}) no-repeat center}.feed-svg.peek.bg{background:url(${xe}) no-repeat center}.feed-svg.headingsonly.bg{background:url(${ve}) no-repeat center}.feed-svg.always.new-image{background:url(${Ae}) no-repeat center}.feed-svg.peek.new-image{background:url(${We}) no-repeat center}.feed-svg.headingsonly.new-image{background:url(${Te}) no-repeat center}.feed-svg.always.bg.new-image{background:url(${Ue}) no-repeat center}.feed-svg.peek.bg.new-image{background:url(${Ve}) no-repeat center}.feed-svg.headingsonly.bg.new-image{background:url(${Ee}) no-repeat center}.feed-svg.always.new-image.widgets{background:url(${Ne}) no-repeat center}.feed-svg.peek.new-image.widgets{background:url(${_e}) no-repeat center}.feed-svg.headingsonly.new-image.widgets{background:url(${ke}) no-repeat center}.feed-svg.always.bg.new-image.widgets{background:url(${De}) no-repeat center}.feed-svg.peek.bg.new-image.widgets{background:url(${ze}) no-repeat center}.feed-svg.headingsonly.bg.new-image.widgets{background:url(${Fe}) no-repeat center}fluent-menu-item.selected{outline:rgb(0,120,212) solid 2px;position:relative}fluent-menu-item:hover{background:none}fluent-menu-item.unselected{outline:rgba(0,0,0,0.12) solid 1px}fluent-menu-item::part(content){margin-inline-start:0px}fluent-menu-item::part(input-container){display:none}.menu-setting{vertical-align:bottom;width:85px;height:auto;padding:7px;margin:0px;border-radius:8px;justify-content:center;display:inline-block}.menu-setting-image{position:relative}.menu-setting-margin:not(:last-child){margin-inline-end:8px}.menu-title{width:71px;margin-left:2px;margin-top:4px;text-overflow:ellipsis;line-height:16px;position:relative;font-size:12px;font-weight:400;overflow:hidden;white-space:break-spaces;text-align:left}.supernav-rewards-flyout{height:32px}.supernav-rewards-flyout fluent-button dismiss-button{display:none}.rewards-icon{position:relative;top:1px;height:20px;width:20px;display:flex;background:url(${Qe}) no-repeat center}.rewards-container{cursor:pointer;height:32px;width:32px;min-width:32px;background:transparent;justify-content:center}.rewards-container.nav1Button{outline:calc(var(--stroke-width) * 1px) solid;border-radius:1000000px}.rewards-container:hover{outline-color:${k.mb}}.rewards-container svg{display:block}ruby-coachmark{margin-block-start:2px}`.withBehaviors(new le.t(ti,Ze),(0,m.G2)(ei));var si=i(17111),oi=i.n(si),ri=i(11622);const ai=O.qy`<ruby-coachmark ?super-nav-toggle=${!0} :rubyCoachmarkStrings=${t=>t.getRubyToggleStrings()}></ruby-coachmark>`,li=O.qy`<fluent-option class=${(t,e)=>e.parent.currentSetting===t?"selected":"unselected"} ?selected=${(t,e)=>e.parent.currentSetting===t} @click=${(t,e)=>e.parent.updateFeedVisibility(t,e.event)} aria-selected="${(t,e)=>e.parent.currentSetting===t}" id="${t=>t}" data-t = ${(t,e)=>e.parent.getOptionTelemetry(t,e.event)} value="${(t,e)=>e.parent.strings[e.parent.feedStrings[t]]}"><span class="feedOptionTitle">${(t,e)=>e.parent.strings[e.parent.feedStrings[t]]}</span></fluent-option>`,di=O.qy`<fluent-menu-item class="menu-setting menu-setting-margin ${(t,e)=>e.parent.currentSetting===t?"selected":"unselected"}" @click=${(t,e)=>e.parent.updateFeedVisibility(t,e.event)} aria-checked="${(t,e)=>e.parent.currentSetting===t}" aria-selected="${(t,e)=>e.parent.currentSetting===t}" role="menuitemradio" part="menu-item" id="${t=>t}" data-t = ${(t,e)=>e.parent.getOptionTelemetry(t,e.event)} value="${(t,e)=>e.parent.strings[e.parent.feedStrings[e.parent.currentSetting]]}" @keyup=${(t,e)=>!e.event||e.event.key!==it.Mm&&e.event.key!==it.gG?null:e.parent.updateFeedVisibility(t,e.event)}><div class="menu-setting-image"><div class="menu-image"><span class="feed-svg ${t=>t} ${(t,e)=>e.parent.isBackgroundImageOn&&"bg"} ${(t,e)=>{var i;return(null===(i=e.parent.config.horizontalNav)||void 0===i?void 0:i.enableWidgetsRegion)&&"new-image"}} ${(t,e)=>{var i;return(null===(i=e.parent.config.horizontalNav)||void 0===i?void 0:i.enableWidgetsRegion)&&e.parent.isWidgetsOn&&"widgets"}}"></div><div class="menu-title">${(t,e)=>e.parent.strings[e.parent.feedStrings[t]]}</div></div></fluent-menu-item>`,hi=O.qy`<fluent-menu ${(0,R.K)("menuRef")} class="${t=>{var e;return null!==(e=t.config.horizontalNav)&&void 0!==e&&e.enableNewFeedToggle?"feed-settings-menu":"feed-settings"}} ${t=>{var e;return!t.feedSettingAbove||null!==(e=t.config.horizontalNav)&&void 0!==e&&e.enableNewFeedToggle?"":"feed-settings-top"}}" id="feedSettings" @keydown="${(t,e)=>e.event&&t.keyDownHandler(e.event)}" part="menu" role="menu">${(0,W.ux)(t=>t.feedMenuItems,di)}</fluent-menu>`,ci=O.qy`<div ${(0,R.K)("dialogRef")} class="feed-settings-dialog ${t=>t.feedSettingAbove?"feed-settings-dialog-top":""}"><div class="personalize-container"><div class="personalize-title">${t=>t.strings.personalizeTitle}</div><fluent-button @click=${(t,e)=>t.onPersonalizeClick(e.event)} class="personalize-button" appearance="outline" aria-label=${t=>t.strings.accessibility.personalizeButtonTooltip} data-customhandled=${!0} data-t="${t=>t.telemetryTags.personalizeButton}" id="feedSettingsDialog" part="personalize-button" title=${t=>t.strings.editFeedText} slot="end">${t=>t.strings.editFeedText}<span class="feed-settings-edit-icon" slot="start"></span></fluent-button></div>${hi}</div>`,ui=O.qy`
${(0,U.z)(t=>t.enableVerticalNav,O.qy`<cs-super-nav-vertical :closeButtonTelemetryTag=${t=>t.telemetryTags.verticalNavCloseButton} :hamburgerMenuButtonTelemetryTag=${t=>t.telemetryTags.verticalNavButton} :navItems=${t=>t.verticalNavItems} :selectedNavId=${t=>t.selectedNavItemId_vertical} :verticalNavTelemetryTag=${t=>t.telemetryTags.verticalNav} @change=${(t,e)=>t.onNavItemClick(e.event)} @expanded-change=${(t,e)=>t.telemetryTags.vericalNavExpandedChange&&t.telemetryTags.vericalNavExpandedChange(e.event)} slot="start" use-mobile-styles="false" ?no-active-color="${t=>t.config.noActiveNavColor}" menu-button-tooltip="${t=>{var e;return null===(e=t.config.localizedStrings)||void 0===e?void 0:e.accessibility.menuButtonTooltip}}"></cs-super-nav-vertical>`)} `,vi=O.qy`<div class="super-nav-bar content"><u-horizontal-nav-m :navItems=${t=>t.horizontalNavItems} :activeId="${t=>t.selectedNavItemId}" @change=${(t,e)=>t.onNavItemClick(e.event)} ${(0,R.K)("refHorizontalNav")} id="nav" ?no-active-color="${t=>t.config.noActiveNavColor}"></u-horizontal-nav-m></div>`,gi=O.qy`<cs-super-nav-horizontal :activeId="${t=>t.selectedNavItemId}" :homenavItems=${t=>t.config.horizontalNav.homenavItemOrder} :localizedStrings=${t=>{var e;return{overflowButtonTooltip:null===(e=t.config.localizedStrings)||void 0===e?void 0:e.accessibility.overflowButtonTooltip}}} :navItems=${t=>t.horizontalNavItems} :overflowTelemetryTag=${t=>t.telemetryTags.horizontalNavOverflowButton} :parentContainer=${t=>t} :seeMoreNavItem=${t=>t.seeMoreNavItem} :showFullPageBlur=${t=>t.showFullPageBlur} :msnBrandingLogo=${t=>t.config.horizontalNavLogo} :msnBrandingLogoTelemetryTag=${t=>t.telemetryTags.horizontalBrandingLogo} :msnBrandingLogoHref=${t=>t.msnBrandingLogoUrl} @change=${(t,e)=>t.onNavItemClick(e.event)} ${(0,R.K)("refHorizontalNav")} id="nav" slot="content" ?no-active-color="${t=>t.config.noActiveNavColor}"></cs-super-nav-horizontal>`,pi=O.qy`<div class="supernav-rewards-flyout"><fluent-button id="rewardsFlyout" class="rewards-container nav1Button" slot="end"><span class="rewards-icon"></span></fluent-button></div>`,fi=O.qy`<div class="end" slot="end">${(0,U.z)(t=>t.config.RewardsFlyout,O.qy` ${t=>(0,ri.yN)(t.config.RewardsFlyout,{properties:{rewardsLoaded:t.rewardsLoaded,isSignedInMSAUser:t.isSignedInMSAUser}})} `)} ${(0,U.z)(t=>t.config.RewardsFlyout&&!t.showRewards,pi)} ${(0,U.z)(t=>t.config.StreaksBadgeWC&&!t.isFromWidgetLockScreen&&t.showStreaksButton,t=>(0,ri.yN)(t.config.StreaksBadgeWC))} ${(0,U.z)(t=>{var e,i;return(null===(e=t.config.horizontalNav)||void 0===e?void 0:e.enableOldFeedToggle)&&(null===(i=t.config.horizontalNav)||void 0===i?void 0:i.enableFeedDropdown)&&t.showFeedDropdown&&"productivityHub"!==t.selectedNavItemId},O.qy`<fluent-select class="settings-link feedDropdown" @click=${(t,e)=>t.onFeedSettingClick(e.event)} appearance="outline" aria-label=${t=>t.strings.accessibility.feedDropdownTooltip} data-customhandled=${!0} data-t="${t=>t.telemetryTags.feedDropdown}"><span slot="selected-value">${t=>t.currentSetting&&t.strings[t.feedStrings[t.currentSetting]]}</span>${(0,W.ux)(t=>t.feedMenuItems,li)}</fluent-select>`)} ${(0,U.z)(t=>t.enableRubyToggleSuperNav&&t.showFeedDropdown&&"productivityHub"!==t.selectedNavItemId,((0,v.S)()&&(async()=>{const{RubyCoachmarkWC:t}=await i.e("web-components_ruby-coachmark_dist_index_js").then(i.bind(i,24439))})(),ai))} ${(0,U.z)(t=>{var e,i;return!(null!==(e=t.config.horizontalNav)&&void 0!==e&&e.enableOldFeedToggle)&&(null===(i=t.config.horizontalNav)||void 0===i?void 0:i.enableFeedDropdown)&&t.showFeedDropdown&&"productivityHub"!==t.selectedNavItemId},O.qy`<fluent-button ${(0,R.K)("feedSettingButtonRef")} @click=${(t,e)=>t.onFeedSettingClick(e.event)} class="settings-link nav1button" appearance="outline" aria-haspopup="menu" aria-label=${t=>{var e;return null===(e=t.strings)||void 0===e?void 0:e.feedSettingsButtonText}} data-customhandled=${!0} data-t="${t=>t.telemetryTags.feedDropdown}" title=${t=>{var e,i,n;return null!==(e=t.config.horizontalNav)&&void 0!==e&&e.enableNewFeedToggle?null===(n=t.strings)||void 0===n?void 0:n.feedSettingsButtonText:null===(i=t.strings)||void 0===i?void 0:i.feedLayoutButtonText}} slot="end"><span class="feed-settings-icon" slot="start"></span>${t=>{var e,i,n;return null!==(e=t.config.horizontalNav)&&void 0!==e&&e.enableNewFeedToggle?null===(n=t.strings)||void 0===n?void 0:n.feedSettingsButtonText:null===(i=t.strings)||void 0===i?void 0:i.feedLayoutButtonText}}</fluent-button>${(0,U.z)(t=>{var e;return(0,v.S)()&&t.isFeedSettingsDialogOpen&&!(null!==(e=t.config.horizontalNav)&&void 0!==e&&e.enableNewFeedToggle)},hi)} ${(0,U.z)(t=>{var e;return(0,v.S)()&&t.isFeedSettingsDialogOpen&&(null===(e=t.config.horizontalNav)||void 0===e?void 0:e.enableNewFeedToggle)},ci)} `)} ${(0,U.z)(t=>{var e;return(null===(e=t.config.horizontalNav)||void 0===e?void 0:e.enablePersonalizeButton)&&t.showPersonalizeButton&&"productivityHub"!==t.selectedNavItemId},O.qy`<fluent-button @click=${(t,e)=>t.onPersonalizeClick(e.event)} class="settings-link nav1button" ${(0,R.K)("refPersonalizeButton")} appearance="outline" aria-label=${t=>t.strings.accessibility.personalizeButtonTooltip} data-customhandled=${!0} data-t="${t=>t.telemetryTags.personalizeButton}" id="myInterests" part="personalize-button" title=${t=>t.strings.accessibility.personalizeButtonTitle} slot="end">${t=>t.config.useCustomizeFeedButton?t.strings.customizeFeedText:t.strings.personalizeButtonText}<span slot="start">${(0,U.z)(t=>t.config.useCustomizeFeedColor,O.qy`<img src="${E.T3.StaticsUrl}/latest/icons-wc/PersonalizeStarColor.svg" />`,O.qy`${O.qy.partial(oi())}`)}</span></fluent-button>`)}</div>`,mi=O.qy`<div class="${t=>t.isDarkBackgroundImage&&t.isBackgroundImageOn&&"myFeed"===t.selectedNavItemId?"dark-bg-img":""}"><div class="super-nav-bar" data-t="${t=>{var e;return null===(e=t.telemetryObject)||void 0===e?void 0:e.getMetadataTag()}}">${ui}<span class="content">${gi}</span>${fi}</div></div>`,wi=O.qy` ${(0,U.z)(t=>t.config.isNewHeaderEnabled,O.qy`${vi}`)} ${(0,U.z)(t=>!t.config.isNewHeaderEnabled,O.qy`${mi}`)}
`,bi={experienceConfigSchema:undefined};Z.define(Nt.G.registry),Ft.define(Nt.G.registry)},16352:function(t){t.exports='<svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M6.25 10a1.25 1.25 0 11-2.5 0 1.25 1.25 0 012.5 0zm5 0a1.25 1.25 0 11-2.5 0 1.25 1.25 0 012.5 0zM15 11.25a1.25 1.25 0 100-2.5 1.25 1.25 0 000 2.5z"></path></svg>'},17111:function(t){t.exports='<svg width="20" height="20" viewBox="0 0 20 20" xmlns="http://www.w3.org/2000/svg"><path d="M10.9 2.9a1 1 0 00-1.8 0L7.17 6.8l-4.31.63a1 1 0 00-.56 1.7l3.13 3.05-.74 4.3a1 1 0 001.45 1.05l3.43-1.8c.16-.4.4-.76.7-1.07l.1-.09a1 1 0 00-.83.05l-3.87 2.03.74-4.3a1 1 0 00-.29-.89L3 8.43l4.32-.63a1 1 0 00.75-.55L10 3.35l1.93 3.9c.15.3.43.5.75.55l4.32.63-.72.7c.48-.15 1-.17 1.49-.06a1 1 0 00-.63-1.63l-4.31-.63L10.9 2.9zm4.9 7.65l-4.82 4.83a2.2 2.2 0 00-.58 1.02l-.37 1.5a.89.89 0 001.08 1.07l1.5-.37c.38-.1.73-.3 1.01-.58l4.83-4.83a1.87 1.87 0 00-2.64-2.64z"></path></svg>'},43727:function(t,e,i){"use strict";i.d(e,{N:function(){return o},Y:function(){return s}});var n=i(19548);function s(t,e){if(!e||!t)return t;const i=new URLSearchParams(decodeURIComponent(e)).getAll("item");if(!i||!i.length)return t;const n=new URL(t);return i.forEach(t=>{const e=n.search?"&":"?";-1===n.search.indexOf(t)&&(n.search+=`${e}item=${t}`)}),n.toString()}function o(t,e,i){if(!e||null==t||!t.addEventListener||!i)return;const s=function(t){const{id:s}=i();if(!(s&&t.currentTarget instanceof HTMLAnchorElement))return;if(!function(t){const e=t&&(0,n.R1)(t);if(!e)return!1;const i=e.hostname.toLowerCase();if(!i.endsWith("msn.com")&&!i.endsWith("msn.cn"))return!1;const s=e.pathname.split("/").at(-1);if(!s)return!1;return s.startsWith("ar-")||s.startsWith("ss-")}(t.currentTarget.href))return;const o=e(s);if((null==o?void 0:o.length)>0){const e=o.join(","),i=(0,n.R1)(t.currentTarget.href||"");i&&(i.searchParams.set("conexpScrll",e),t.currentTarget.href=i.href)}};t.addEventListener("click",s),t.addEventListener("auxclick",s),t.addEventListener("contextmenu",s)}},60433:function(t,e,i){"use strict";i.d(e,{V:function(){return m}});var n=i(65022),s=i(89151),o=i(93468),r=i(88294);const a="csux_evt",l=new Map([["BackgroundImageWC",864e5],["SuperNav",9e5]]),d=new Map([["BackgroundImageWC",12096e5],["SuperNav",12096e5]]);var h=i(77246),c=i(17720),u=i(17254),v=i(12870),g=i(89980),p=i(7187);class f{constructor(){(0,h.S)()&&(this.localstorage_get(null,n._6x),(0,s.dT)().then(()=>{this.autoCleanup()}))}autoCleanup(){if(!(0,h.S)())return;if(!this.eventData)return;let t;for(t in this.eventData){const e=t;let i;for(i in this.eventData[e]){const t=i,n=this.eventData[e][t],s=(new Date).getTime();n.timestamp_EventStart+d.get(e)<s&&delete this.eventData[e][t]}}this.localstorage_save(null)}dismissCreative(t,e,i,n){if((0,h.S)()){if(!t||!e||!i){const s=`Missing data to save creative dismissal. Event ID: ${t}, Experience ID: ${e}, Creative ID: ${i}`;return void(n?(0,o.vV)(n,s):r.v.logError(s))}for(const n in this.eventData[e][t].expiredCreatives)if(n===i)return;this.eventData[e][t].expiredCreatives.push(i),this.localstorage_save(t,n)}}getCMSContent(t,e,i,n){if(!t||!e||!i){const s=`Missing data to return current cms content. Event ID: ${t}, Experience ID: ${e}, Creative IDs: ${i}`;return n?(0,o.vV)(n,s):r.v.logError(s),null}return this.eventData&&this.eventData[e]&&this.eventData[e][t]&&this.eventData[e][t].cmsData?this.eventData[e][t].cmsData:null}static getInstance(){return c.vv.get("__eventLocalStorage__",()=>new f)}async getCurrentCreativeId(t,e,i,n,s,a){if(!(0,h.S)())return null;if(!t||!e||!i){const n=`Missing data to return current creative. Event ID: ${t}, Experience ID: ${e}, Creative IDs: ${i}`;return a?(0,o.vV)(a,n):r.v.logError(n),null}let l;if(!(this.eventData&&this.eventData[e]&&this.eventData[e][t]))return null;l=this.eventData[e][t].currentCreative;return await this.selectCreative(i,t,e,n,s,l,a)}localstorage_get(t,e){if((0,h.S)())try{this.eventData=(0,g.Lg)().getObject(a)}catch(i){e?(0,o.vV)(e,`Get local storage operation failed for event - ${t}.`):r.v.logError(i)}}localstorage_save(t,e){if((0,h.S)())try{(0,g.Lg)().setObject(a,this.eventData)}catch(i){return void(e?(0,o.vV)(e,`Save local storage operation failed for event - ${t}.`):r.v.logError(i))}}async selectCreative(t,e,i,n,s,a,d,c){if(!t||0===t.length)return null;if(n){const t=new Date,e=new Date(n.start_year,n.start_month-1,n.start_day);e.setDate(e.getDate()-1);const i=new Date(n.end_year,n.end_month-1,n.end_day);if(i.setDate(i.getDate()+1),!(e<=t&&t<=i))return null}const g=(0,p.isNullOrUndefined)(this.eventData&&this.eventData[i]&&this.eventData[i][e]&&this.eventData[i][e].timestamp_EventStart);if(!a&&g&&!s)return t[0];if(s){var f;const n=(new Date).getTime(),l=this.eventData&&this.eventData[i]&&this.eventData[i][e]&&this.eventData[i][e].timestamp_EventLastUpdate?this.eventData[i][e].timestamp_EventLastUpdate:0,g=u.T3.CurrentMarket,b=null===(f=this.eventData[i][e])||void 0===f?void 0:f.market;let $=!1;if(void 0!==b&&($=b!==g,$&&this.dismissCreative(e,i,a,d)),!(0,h.S)()||l+9e5<n||$){const n=()=>fetch(s),a=n=>{var s,o;switch(i){case"BackgroundImageWC":this.eventData[i][e]={cmsData:{attribution:n.headlines[0].subtitle,imageSource:n.headlines[1].title,imageHref:n.headlines[2].title,title:n.headlines[0].title},currentCreative:t[0],expiredCreatives:[],market:g,timestamp_EventLastUpdate:(new Date).getTime(),timestamp_EventStart:(new Date).getTime()},this.localstorage_save(e,d);break;case"SuperNav":case"FeedNavigationHp":this.eventData[i][e]={cmsData:{display:n.headlines[1].title,highlighted:"1"===(null===(s=n.headlines[4])||void 0===s?void 0:s.title),id:n.headlines[0].title,positionOverride:null===(o=n.headlines[3])||void 0===o?void 0:o.title,url:n.headlines[1].subtitle},currentCreative:t[0],expiredCreatives:[],market:g,timestamp_EventLastUpdate:(new Date).getTime(),timestamp_EventStart:(new Date).getTime()},this.localstorage_save(e,d)}};if(!(0,h.S)()||v.Rb.IsPrerender){try{const t=await n(),e=await t.json();a(e)}catch(t){d?(0,o.vV)(d,`Failed to call CMS data - ${i} - ${e}. url ${s}`,t):r.v.logError(t)}return t[0]}if(c){var m,w;const e=c.href,i=c.innerText,n=c.id,s=null===(m=c.dataset)||void 0===m?void 0:m.positionOverride,o=null===(w=c.classList)||void 0===w?void 0:w.contains("highlight");return a({headlines:[{title:n},{title:i,subtitle:e},{},{title:s},{title:o?"1":"0"}]}),t[0]}if(n().then(t=>{t.json().then(t=>{a(t)})}).catch(t=>{d?(0,o.vV)(d,`Failed to call CMS data - ${i} - ${e}. url ${s}`,t):r.v.logError(t)}),(0,p.isNullOrUndefined)(this.eventData&&this.eventData[i]&&this.eventData[i][e]&&this.eventData[i][e].cmsData))return null}}let b=-1;for(let e=0;e<t.length;e++)if(t[e]===a){b=e;break}if(-1===b)return b=0,this.eventData[i][e]={currentCreative:t[b],expiredCreatives:[],market:u.T3.CurrentMarket,timestamp_EventLastUpdate:(new Date).getTime(),timestamp_EventStart:(new Date).getTime()},this.localstorage_save(e,d),t[b];const $=(new Date).getTime();if(this.eventData[i][e].timestamp_EventLastUpdate+l.get(i)<$&&!n&&"SuperNav"!==i){if(b<t.length-1){const n=t[b+1];return this.dismissCreative(e,i,a,d),this.eventData[i][e]={...this.eventData[i][e],currentCreative:n,timestamp_EventLastUpdate:$},this.localstorage_save(e,d),n}return this.dismissCreative(e,i,t[b],d),null}for(let n=0;n<this.eventData[i][e].expiredCreatives.length;n++)if(this.eventData[i][e].expiredCreatives[n]===t[b])return null;return t[b]}async shouldShowEvent(t,e,i,n,s,o,r){const a=(0,p.isNullOrUndefined)(this.eventData),l=this.eventData&&(0,p.isNullOrUndefined)(this.eventData[e]),d=this.eventData&&this.eventData[e]&&(0,p.isNullOrUndefined)(this.eventData[e][t]);if(a||l||d){a?(this.eventData={},this.eventData[e]={},this.eventData[e][t]={}):l&&(this.eventData[e]={},this.eventData[e][t]={});const d=await this.selectCreative(i,t,e,n,s,null,null,r);return!!d&&(this.eventData[e][t].currentCreative=d,this.localstorage_save(t,o),!0)}const h=this.eventData[e][t].currentCreative;return!!await this.selectCreative(i,t,e,n,s,h,o,r)}}const m=()=>{const t="__eventLocalStorage__";let e=c.vv.get(t);return e||(e=new f,c.vv.set(t,e)),e}}}]);